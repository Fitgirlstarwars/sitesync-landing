# SiteSync V3 - Complete Documentation

> AI-Native Building Services Operating System
> Version: 3.0.0 | Generated: December 2025
> Total estimated tokens: ~116,000

This file contains the complete SiteSync documentation concatenated for full context loading.

---



<!-- FILE: CLAUDE.md -->

# SiteSync V3 - Project Context

> AI-Native Building Services Operating System. Buildings own their service history permanently.

## What This Is

SiteSync manages building equipment (elevators, HVAC, electrical) with AI assistance. When contractors change, data stays with the building.

## Key Entities

- **Organization**: Multi-tenant root (a company)
- **Site**: A building/location
- **Elevator**: Equipment asset
- **Work Order**: A job/task
- **Contractor**: Service provider
- **Triforce AI**: Multi-model consensus (Gemini + Claude + GPT-4)

## Tech Stack

- Database: PostgreSQL 16+ with RLS, pgvector
- Backend: FastAPI, Python 3.12+
- Frontend: React 18, TypeScript
- AI: Triforce + Pydantic AI

## Code Patterns

```python
# Modern Python type syntax
def get_elevator(id: UUID) -> Elevator | None: ...
def list_sites() -> list[Site]: ...
```

- Use `X | None` not `Optional[X]`
- Use `list[X]` not `List[X]`
- Async/await for all DB operations
- Domain structure: contracts.py, models.py, service.py, repository.py

## Multi-Tenancy

```sql
SET app.current_org = 'organization-uuid';
-- All queries now filter by organization
```

## Directory Structure

```
sitesync/
├── CLAUDE.md          # This file
├── AI_CONTEXT.md      # Detailed AI context
├── CLAUDE_CODE_GUIDE.md # Complete reference
├── llms.txt           # AI discovery index
├── .llm-manifest.json # Machine-readable index
└── docs/              # Full documentation
```

## Reading Order

1. This file (CLAUDE.md)
2. docs/GLOSSARY.md - Terminology
3. AI_CONTEXT.md - Extended context
4. docs/reference/data-model.md - Schemas
5. CLAUDE_CODE_GUIDE.md - Complete reference

## Common Tasks

### Implement a Feature
1. Check data model: `docs/reference/data-model.md`
2. Follow domain pattern: contracts, models, service, repository
3. Use async/await, add audit events, set RLS context

### AI Diagnosis
1. See Triforce: `docs/explanation/triforce-ai.md`
2. Pipeline: jury → consensus → witness → judge

## Project Status

Design & Early Development phase. Schemas defined, partial implementation.

## Full Documentation

See `AI_CONTEXT.md` for extended context or `CLAUDE_CODE_GUIDE.md` for complete reference.


<!-- FILE: AI_CONTEXT.md -->

# SiteSync V3 - AI Context Document

<!--
PURPOSE: This document provides essential context for AI assistants (Claude, GPT-4, Gemini)
to understand the SiteSync project quickly and accurately. Read this FIRST before
exploring other documentation.

OPTIMIZED FOR: LLM comprehension with clear structure, consistent terminology, and
self-contained context.
-->

## What Is SiteSync?

**SiteSync V3** is an AI-Native Building Services Operating System.

**Core Function**: Manage building equipment (elevators, HVAC, electrical, plumbing, fire systems) with AI assistance.

**Key Differentiator**: Buildings own their service history permanently. When contractors change, data stays with the building.

**Target Users**:
1. Building managers and facility managers
2. Elevator technicians and maintenance workers
3. Service companies and contractors

## The Three Core Principles

### Principle 1: Buildings Own Their Data

Every service record belongs to the building, not the contractor who performed the work. When a building changes service providers, the complete history remains searchable and accessible.

### Principle 2: Workers Own Their Reputation

Technicians build professional profiles from verified work. Expertise scores, first-time fix rates, and contributions are tracked and portable across employers.

### Principle 3: AI Is Invisible

AI assists at every step but never interrupts workflow. No chatbots, no "AI is thinking" spinners, no "Powered by AI" badges. The system simply works intelligently.

## Entity Hierarchy

```
Organization (tenant root - a company using SiteSync)
├── Users (staff members with roles and permissions)
├── Sites (buildings/locations)
│   └── Elevators (equipment assets)
│       ├── Work Orders (jobs/tasks)
│       │   ├── Tasks (subtasks within a job)
│       │   ├── Parts Used (inventory consumed)
│       │   ├── Labor Entries (time tracking)
│       │   └── AI Diagnoses (Triforce results)
│       ├── Maintenance Schedules
│       └── Documents (manuals, certificates)
├── Contractors (technicians/service companies)
│   └── Certifications
└── Inventory Items
    └── Stock Locations (warehouse, van stock)
```

## Key Terminology (Use These Terms Consistently)

| Term | Definition | NOT This |
|------|------------|----------|
| Organization | Multi-tenant root entity (a company) | Account, Tenant, Company |
| Site | A building or location | Property, Facility, Location |
| Elevator | A lift/vertical transport asset | Lift, Asset, Unit |
| Work Order | A job/task to be performed | Job, Ticket, Request, Task |
| Contractor | Person/company performing work | Technician, Worker, Vendor |
| Triforce AI | Multi-model AI consensus system | AI Engine, LLM System |
| Fault Code | Equipment error identifier | Error Code, Alarm Code |

## Technology Stack Summary

| Layer | Technology | Purpose |
|-------|------------|---------|
| Database | PostgreSQL 16+ | Data storage with RLS multi-tenancy |
| Vector Search | pgvector | Embedding storage for AI |
| Backend | FastAPI + Python 3.12+ | REST API |
| Frontend | React 18 + TypeScript | Web dashboard |
| AI Layer | Triforce (Gemini + Claude + GPT-4) | Multi-model consensus |
| Structured AI | Pydantic AI | Type-safe LLM outputs |

## Triforce AI Architecture

Triforce uses multiple AI models in parallel with consensus voting:

```
INPUT (fault code, symptoms, equipment context)
    │
    ▼
┌──────────────────────────────────────┐
│ JURY (3 models evaluate in parallel) │
│ Gemini 2.0 Pro │ Claude Sonnet │ GPT-4│
└──────────────────────────────────────┘
    │
    ▼
┌──────────────────────────────────────┐
│ CONSENSUS ENGINE (weighted voting)   │
└──────────────────────────────────────┘
    │
    ▼
┌──────────────────────────────────────┐
│ WITNESS (validation against KB)      │
└──────────────────────────────────────┘
    │
    ▼
┌──────────────────────────────────────┐
│ JUDGE (final synthesis - Claude Opus)│
└──────────────────────────────────────┘
    │
    ▼
OUTPUT (structured diagnosis with confidence)
```

## Database Multi-Tenancy

SiteSync uses PostgreSQL Row-Level Security (RLS) for tenant isolation:

```sql
-- Every query automatically filters by organization
SET app.current_org = 'organization-uuid';
-- All subsequent queries only return that organization's data
```

All tenant-scoped tables include `organization_id` and RLS policies.

## Key Enums (Quick Reference)

> **Full enum definitions**: `/docs/reference/enums.md`

| Enum | Common Values |
|------|---------------|
| Elevator Status | `operational`, `degraded`, `out_of_service`, `maintenance` |
| Work Order Status | `draft`, `pending`, `scheduled`, `in_progress`, `completed` |
| Work Order Priority | `emergency`, `high`, `medium`, `low`, `scheduled` |
| Work Order Type | `breakdown`, `preventive`, `inspection`, `callback` |

## API Endpoint Patterns

> **Full API reference**: `/docs/reference/api.md`

```
/api/v1/sites                           # Site CRUD
/api/v1/elevators                       # Elevator CRUD
/api/v1/work-orders                     # Work order CRUD
/api/v1/work-orders/{id}/diagnose       # Request AI diagnosis
/api/v1/contractors                     # Contractor management
/api/v1/inventory/van-stock             # Van stock tracking
```

## Code Patterns (Summary)

> **Full code patterns**: `/CLAUDE_CODE_GUIDE.md` and `/docs/reference/implementation.md`

**Key conventions**:
- Python 3.12+ type syntax: `X | None` not `Optional[X]`, `list[X]` not `List[X]`
- Async/await for all database operations
- Repository pattern for data access
- Service layer for business logic with audit logging
- Domain structure: `contracts.py`, `models.py`, `service.py`, `repository.py`

```python
# Example: Modern type syntax
def get_elevator(id: UUID) -> Elevator | None: ...
def list_sites() -> list[Site]: ...
```

## Directory Structure

```
sitesync/
├── CLAUDE.md               # Concise context (~70 lines)
├── AI_CONTEXT.md           # THIS FILE - extended context
├── CLAUDE_CODE_GUIDE.md    # Complete technical reference
├── llms.txt                # AI discovery index
├── llms-full.txt           # Complete documentation dump
├── .llm-manifest.json      # Machine-readable index
└── docs/
    ├── README.md           # Documentation hub
    ├── GLOSSARY.md         # Terminology definitions
    ├── explanation/        # Concept explanations
    ├── reference/          # Technical specifications
    ├── tutorials/          # Step-by-step guides
    ├── how-to/             # Task-oriented guides
    └── faq.md              # Common questions
```

## Common Tasks for AI Assistants

### When Asked to Implement a Feature
1. Check the data model in `docs/reference/data-model.md`
2. Follow the domain pattern: `contracts.py`, `models.py`, `service.py`, `repository.py`
3. Use async/await for all database operations
4. Add audit events for user-facing changes
5. Include RLS context setting for multi-tenant queries

### When Asked About AI Diagnosis
1. Refer to Triforce architecture in `docs/explanation/triforce-ai.md`
2. Use Pydantic AI for structured outputs
3. Follow the jury → consensus → witness → judge pipeline

### When Asked About the Database
1. PostgreSQL 16+ with pgvector for embeddings
2. All tables have `organization_id` for multi-tenancy
3. RLS policies enforce tenant isolation
4. UUIDs for all primary keys

## Project Status

| Aspect | Status |
|--------|--------|
| Phase | Design & Early Development |
| Database | Schema defined, not yet implemented |
| API | Patterns defined, partial implementation |
| Frontend | React structure defined |
| AI | Triforce architecture designed |

## Related Documentation

For deeper understanding, read in this order:
1. `/AI_CONTEXT.md` (this file)
2. `/CLAUDE_CODE_GUIDE.md` (complete reference)
3. `/docs/reference/data-model.md` (database schemas)
4. `/docs/explanation/triforce-ai.md` (AI system)
5. `/docs/reference/api.md` (API endpoints)


<!-- FILE: docs/GLOSSARY.md -->

<!--
---
title: SiteSync Terminology Glossary
description: Consistent terminology definitions for AI assistants and developers
version: 3.0.0
last_updated: 2025-12
status: stable
audience: ai_assistant, developer
purpose: Defines consistent terminology - AI assistants should use these exact terms
related_docs:
  - /AI_CONTEXT.md (quick reference)
  - /docs/reference/data-model.md (entity schemas)
---
-->

# SiteSync Terminology Glossary

## Core Entities

### Organization

**Definition**: The multi-tenant root entity representing a company using SiteSync.

**Database Table**: `organizations`

**Key Fields**:
- `id` (UUID): Unique identifier
- `slug` (string): URL-friendly identifier (e.g., `acme-elevators`)
- `subscription_tier` (enum): `free`, `pro`, `expert`, `enterprise`

**Do NOT call it**: Account, Tenant, Company, Client, Customer

---

### Site

**Definition**: A building or physical location containing equipment.

**Database Table**: `sites`

**Key Fields**:
- `organization_id` (UUID): Parent organization
- `name` (string): Building name
- `address_line1`, `city`, `state`, `postal_code`: Location
- `health_score` (integer): 0-100 building health rating

**Relationships**:
- Belongs to one Organization
- Has many Elevators

**Do NOT call it**: Building, Property, Facility, Location, Premises

---

### Elevator

**Definition**: A vertical transport asset (lift) being managed in SiteSync.

**Database Table**: `elevators`

**Key Fields**:
- `site_id` (UUID): Parent site
- `unit_number` (string): Display identifier (e.g., "Lift 1", "L1")
- `serial_number` (string): Manufacturer serial
- `registration_number` (string): Government registration
- `manufacturer` (string): KONE, Otis, Schindler, etc.
- `status` (enum): See Elevator Status below

**Relationships**:
- Belongs to one Site
- Has many Work Orders
- Has many Documents

**Do NOT call it**: Lift (except in UI for Australian users), Asset, Unit, Equipment

---

### Work Order

**Definition**: A job or task to be performed on equipment.

**Database Table**: `work_orders`

**Key Fields**:
- `work_order_number` (string): Display ID (e.g., "WO-2024-001234")
- `elevator_id` (UUID): Target equipment
- `type` (enum): See Work Order Type below
- `priority` (enum): See Work Order Priority below
- `status` (enum): See Work Order Status below
- `fault_code` (string): Equipment error code if applicable
- `assigned_contractor_id` (UUID): Assigned technician/company

**Relationships**:
- Belongs to one Elevator
- Has many Tasks, Parts Used, Labor Entries
- May have one AI Diagnosis

**Do NOT call it**: Job, Ticket, Request, Task, Service Call, Case

---

### Contractor

**Definition**: A person or company that performs maintenance work.

**Database Table**: `contractors`

**Key Fields**:
- `contractor_type` (string): `employee`, `subcontractor`, `vendor`, `company`
- `contact_name` (string): Primary contact
- `specializations` (array): e.g., `['KONE', 'Otis', 'hydraulic']`
- `rating` (decimal): 0.00-5.00 performance rating
- `first_time_fix_rate` (decimal): Percentage of jobs fixed on first visit

**Relationships**:
- Belongs to one Organization
- Has many assigned Work Orders
- May have Certifications

**Do NOT call it**: Technician (unless referring to individual), Worker, Vendor, Supplier

---

### Inventory Item

**Definition**: A part or material tracked in the inventory system.

**Database Table**: `inventory_items`

**Key Fields**:
- `part_number` (string): Unique part identifier
- `name` (string): Part description
- `manufacturer` (string): Part manufacturer
- `compatible_manufacturers` (array): Compatible equipment brands

**Relationships**:
- Belongs to one Organization
- Has many Stock Locations

**Do NOT call it**: Part (except informally), Material, Component, SKU

---

### Stock Location

**Definition**: A specific place where inventory is stored.

**Database Table**: `stock_locations`

**Key Fields**:
- `location_type` (string): `warehouse`, `van`, `site`, `consignment`
- `quantity_on_hand` (integer): Current quantity
- `contractor_id` (UUID): If van stock, which technician

**Van Stock**: Inventory carried by a technician in their vehicle.

**Do NOT call it**: Warehouse (unless type=warehouse), Storage

---

## AI System Terminology

### Triforce AI

**Definition**: SiteSync's multi-model AI architecture that uses three LLMs in parallel with consensus voting.

**Components**:
- **Jury**: Multiple LLMs evaluating in parallel (Gemini, Claude, GPT-4)
- **Consensus Engine**: Aggregates jury responses via weighted voting
- **Witness Panel**: Validates claims against knowledge base
- **Judge**: Makes final decision (Claude Opus 4.5)
- **Hierarchical Memory**: Episodic, semantic, and procedural memory stores

**Do NOT call it**: AI Engine, LLM System, ChatGPT, The AI

---

### AI Diagnosis

**Definition**: A structured analysis produced by Triforce AI for a fault.

**Output Fields**:
- `fault_code` (string): Identified fault
- `severity` (string): `critical`, `high`, `medium`, `low`
- `primary_cause` (string): Most likely cause
- `recommended_actions` (array): Steps to resolve
- `parts_needed` (array): Required parts
- `confidence` (float): 0.0-1.0 confidence score

**Do NOT call it**: AI Response, Prediction, Analysis

---

## Status Enums

### Elevator Status

| Value | Meaning |
|-------|---------|
| `operational` | Running normally |
| `degraded` | Running with issues |
| `out_of_service` | Not running |
| `maintenance` | Scheduled maintenance |
| `decommissioned` | Permanently out of use |

---

### Work Order Status

| Value | Meaning |
|-------|---------|
| `draft` | Created but not submitted |
| `pending` | Submitted, awaiting assignment |
| `scheduled` | Assigned and scheduled |
| `in_progress` | Work started |
| `on_hold` | Paused |
| `completed` | Work finished |
| `cancelled` | Cancelled |
| `invoiced` | Invoiced/closed |

---

### Work Order Priority

| Value | Meaning |
|-------|---------|
| `emergency` | Immediate response required |
| `high` | Same day |
| `medium` | Within 48 hours |
| `low` | Within week |
| `scheduled` | Planned maintenance |

---

### Work Order Type

| Value | Meaning |
|-------|---------|
| `breakdown` | Equipment failure |
| `preventive` | Scheduled maintenance |
| `inspection` | Safety inspection |
| `installation` | New installation |
| `modernization` | Upgrade project |
| `callback` | Return visit |
| `audit` | Compliance audit |

---

## Technical Terms

### Row-Level Security (RLS)

**Definition**: PostgreSQL feature that automatically filters query results based on the current user's organization. Ensures multi-tenant data isolation at the database level.

**Implementation**: `SET app.current_org = 'uuid'` before queries.

---

### pgvector

**Definition**: PostgreSQL extension for storing and querying vector embeddings. Used for AI semantic search.

---

### Hybrid Search

**Definition**: Search combining keyword matching (BM25/trigram) with semantic vector similarity for better results.

---

### Domain (Architecture)

**Definition**: A bounded context in the codebase containing related functionality.

**Structure**:
```
domains/{name}/
├── contracts.py   # Protocol interfaces
├── models.py      # Pydantic models
├── service.py     # Business logic
├── repository.py  # Data access
└── test_{name}.py # Tests
```

**Examples**: `organizations`, `assets`, `work_orders`, `contractors`, `inventory`, `audit`

---

## Acronyms

| Acronym | Meaning |
|---------|---------|
| RLS | Row-Level Security |
| UUID | Universally Unique Identifier |
| CRUD | Create, Read, Update, Delete |
| API | Application Programming Interface |
| RPC | Remote Procedure Call |
| JWT | JSON Web Token |
| CMMS | Computerized Maintenance Management System |
| FM | Facilities Management |
| BMS | Building Management System |
| MRL | Machine Room-Less (elevator type) |
| VFD | Variable Frequency Drive |

---

## Industry Terms

### Fault Code

**Definition**: A standardized error identifier displayed by elevator controllers. Format varies by manufacturer.

**Examples**:
- KONE: `F505` (door zone fault)
- Otis: `ALM-123`
- Schindler: `E001`

---

### First-Time Fix Rate

**Definition**: Percentage of work orders resolved on the first technician visit without requiring a return trip.

**Calculation**: `(Jobs fixed on first visit / Total jobs) × 100`

**Target**: 90%+ is excellent

---

### Building Health Score

**Definition**: A composite 0-100 score representing overall building condition.

**Factors**:
- Equipment age and condition
- Maintenance history compliance
- Predictive failure risk
- Recent incident count

---

## Usage Guidelines

1. **Always use the defined term** - Do not substitute synonyms
2. **Use singular form for entity names** - "Work Order" not "Work Orders" when referring to the concept
3. **Use exact enum values in code** - `in_progress` not `inProgress` or `IN_PROGRESS`
4. **Capitalize proper nouns** - "Triforce AI", "SiteSync", "PostgreSQL"
5. **Use lowercase for enum values** - `operational`, `emergency`, `breakdown`


<!-- FILE: CLAUDE_CODE_GUIDE.md -->

<!--
---
title: SiteSync V3 Complete System Reference
description: Complete technical reference for AI assistants working with SiteSync
version: 3.0.0
last_updated: 2025-12
status: design_phase
audience: ai_assistant
prerequisites: none
related_docs:
  - /AI_CONTEXT.md (quick context overview)
  - /docs/GLOSSARY.md (terminology definitions)
  - /llms.txt (documentation index)
---
-->

# SiteSync V3 - Complete System Reference Guide

## For AI Assistants: Read This First

**What is SiteSync?** An AI-native platform for managing building services (elevators, HVAC, electrical). Buildings own their service history permanently.

**Quick Context:** For a shorter overview, read `/AI_CONTEXT.md` first.

**Terminology:** For consistent term definitions, see `/docs/GLOSSARY.md`.

**Key Concept:** "Organization" means a tenant company, "Site" means a building, "Elevator" means an asset, "Work Order" means a job.

---

> **Purpose**: Complete reference for Claude Code to understand and work with the SiteSync V3 AI-Native Building Services Platform
> **Version**: 3.0.0 | December 2025
> **Status**: Design Phase

---

## Table of Contents

1. [Executive Summary](#1-executive-summary)
2. [Core Philosophy](#2-core-philosophy)
3. [Architecture Overview](#3-architecture-overview)
4. [Technology Stack](#4-technology-stack)
5. [Data Model](#5-data-model)
6. [Domain Structure](#6-domain-structure)
7. [Triforce AI System](#7-triforce-ai-system)
8. [Key Features](#8-key-features)
9. [API Design](#9-api-design)
10. [Security & Multi-Tenancy](#10-security--multi-tenancy)
11. [Market Strategy](#11-market-strategy)
12. [Implementation Roadmap](#12-implementation-roadmap)
13. [Code Patterns](#13-code-patterns)
14. [Quick Reference](#14-quick-reference)

---

## 1. Executive Summary

### What Is SiteSync V3?

**SiteSync V3** is an **AI-Native Multi-Trade Building Services Operating System** - a comprehensive platform for managing ALL building trades (elevators, escalators, HVAC, electrical, plumbing, fire, security, painting, removalists) with **AI assistance at every step**.

### Core Thesis

> Traditional vertical SaaS companies (ServiceTitan, Fiix) are strategically paralyzed by legacy business models. SiteSync exploits this through **counter-positioning**: AI-native architecture delivering **10x value at 1/10th the cost**.

### Key Metrics Target

| Metric | Target | Industry Avg |
|--------|--------|--------------|
| Price | $29/month | $299/month |
| First-time fix rate | 90%+ | 70% |
| Task completion time | -85% | baseline |
| User training time | <1 hour | 2-5 days |
| Gross margin | 98% | 60-70% |
| ARR per FTE | $1.13M | $200K |

### Architecture Decision

**Import-Based Bridge (Option C)** - Best balance of risk/speed/flexibility:

```
V3 CMMS (Clean Build)
├── PostgreSQL + pgvector (replaces SQLite + FAISS)
├── Native hybrid search (single SQL query)
└── domains/ (all NEW except diagnosis wrapper)

V2 (Library - imported)
├── adapters/gemini/ (LLM calls)
└── domains/diagnosis/ (fault analysis agents)

Extraction Service (SEPARATE)
├── Standalone Cloud Function or CLI
├── Gemini 2.0 structured extraction
└── Writes directly to V3 PostgreSQL
```

**Code Split**: 65% new code / 35% V2 reuse

---

## 2. Core Philosophy

### The Invisible AI Principle

> "The best technology is the one you don't think about. When users say 'this tool is amazing', never 'this AI is amazing', you've succeeded."

**Core Rule**: Human is ALWAYS in control, but AI is SEAMLESS and INVISIBLE.

### What Invisible AI Means

| Wrong (Visible AI) | Right (Invisible AI) |
|--------------------|----------------------|
| "Our AI chatbot will help you!" | Form auto-fills before you type |
| "Powered by GPT-4" badge | System suggests exactly what you need |
| "Let AI analyze your data" | Report appears, already written |
| "AI is thinking..." spinner | Instant results (pre-computed) |
| User knows they're using AI | User thinks the tool is brilliant |

### The "Confirm, Don't Create" Pattern

AI NEVER takes action without human confirmation - but confirmation is frictionless:

| AI Confidence | UX Pattern | User Action |
|---------------|------------|-------------|
| **High (95%+)** | "Likely sensor. Order it?" | 1 tap to confirm |
| **Medium (70-95%)** | "Could be A, B, or C" | Tap to choose, then confirm |
| **Low (<70%)** | "What do you see?" | Photo/voice input (no typing) |

### The "How Did It Know?" Moments

These create word-of-mouth marketing:

1. **Jobsite Recognition**: Open app → already knows which building, which job
2. **Photo Intelligence**: Point camera → reads nameplate → downloads manual
3. **Self-Writing Reports**: Finish job → report ready in 30 seconds
4. **Auto-Offline Mode**: Walk into shaft → high-contrast, offline, flashlight
5. **Smart Parts Suggest**: Diagnose fault → AI suggests part → one tap to order
6. **Smart Scheduling**: Wake up → day already optimized, saves 45 min
7. **Colleague Finder**: Stuck on fault → expert nearby, already briefed
8. **Predictive Alerts**: "Motor will fail in 3 weeks. Schedule now?"

### Anti-Patterns (NEVER Do)

- "Powered by AI" badges
- Chatbot interfaces
- "AI is thinking..." spinners
- Confidence scores shown to users
- AI explanations nobody asked for
- Separate "AI Mode" settings

### Three Layers of AI Learning

```
1. PER-USER PERSONALIZATION
   - Preferred report style
   - Communication preferences
   - Common routes and schedules
   - Past decisions and corrections

2. PER-ASSET KNOWLEDGE
   - Equipment quirks ("This KONE always throws false F505 on humid days")
   - Successful procedures
   - Failure patterns (probability/likelihood)
   - Parts history

3. PER-TRADE SPECIALIZED AI
   - LIFTS: Door faults, drive failures, safety circuits
   - HVAC: Compressor issues, refrigerant cycles, airflow
   - ELECTRICAL: Circuit tracing, load balancing
   - PLUMBING: Pressure, flow, drainage
   - FIRE: Detection, suppression, compliance
```

---

## 3. Architecture Overview

### High-Level System Architecture

```
┌─────────────────────────────────────────────────────────────┐
│                        INTERFACES                           │
├─────────────────────────────────────────────────────────────┤
│  React 18 + TypeScript + TanStack Query + Tailwind CSS      │
│  FastAPI 0.115+ (async, OpenAPI 3.1)                        │
│  Mobile: React Native / PWA (Phase 3)                       │
└─────────────────────────────────────────────────────────────┘
                              │
┌─────────────────────────────────────────────────────────────┐
│                         DOMAINS                             │
├─────────────────────────────────────────────────────────────┤
│  V2 (imported): extraction, search, diagnosis, knowledge    │
│  V3 (new): organizations, assets, work_orders, contractors  │
│            inventory, audit                                 │
└─────────────────────────────────────────────────────────────┘
                              │
┌─────────────────────────────────────────────────────────────┐
│                         ADAPTERS                            │
├─────────────────────────────────────────────────────────────┤
│  V2: Gemini, Ollama, SQLite, FAISS, Neo4j                   │
│  V3: PostgreSQL (asyncpg), Redis (caching), S3 (documents)  │
└─────────────────────────────────────────────────────────────┘
                              │
┌─────────────────────────────────────────────────────────────┐
│                      INFRASTRUCTURE                         │
├─────────────────────────────────────────────────────────────┤
│  Cloud Run (API) │ Cloud SQL (PostgreSQL) │ Memorystore     │
│  Cloud Storage (PDFs) │ Secret Manager │ Cloud Armor        │
└─────────────────────────────────────────────────────────────┘
```

### Directory Structure

```
~/Desktop/
├── sitesync-claudeV2/           # PRODUCTION (becomes library)
│   ├── sitesync/
│   │   ├── adapters/             # Gemini, SQLite, FAISS, Neo4j
│   │   ├── domains/              # extraction, search, diagnosis
│   │   ├── interfaces/           # Keep running for existing users
│   │   └── config/
│   ├── data/
│   │   ├── processed/platinum/   # 2,307 pre-extracted PDFs
│   │   └── graph/                # 1,043 nodes, 432 edges
│   └── pyproject.toml
│
└── sitesync-v3/                 # DEVELOPMENT (new system)
    ├── sitesync_v3/
    │   ├── core/                 # Triforce v3, shared utilities
    │   ├── domains/
    │   │   ├── organizations/    # Multi-tenant root
    │   │   ├── assets/           # Elevator registry
    │   │   ├── work_orders/      # Job lifecycle
    │   │   ├── contractors/      # Workforce management
    │   │   ├── inventory/        # Parts tracking
    │   │   └── audit/            # Compliance trail
    │   ├── adapters/
    │   │   └── postgres/         # PostgreSQL adapter
    │   └── interfaces/
    │       ├── api/              # FastAPI with new routes
    │       └── web/              # React dashboard
    ├── data → ../sitesync-claudeV2/data  # SYMLINK
    ├── pyproject.toml
    └── alembic/                  # Database migrations
```

### What V3 Does NOT Include

| Component | Reason |
|-----------|--------|
| `domains/extraction/` | Separate microservice |
| `adapters/faiss/` | Replaced by pgvector |
| `adapters/sqlite/` | Replaced by PostgreSQL |
| `domains/search/hybrid_search.py` | Single SQL query now |

---

## 4. Technology Stack

### Database: PostgreSQL 16+

| Feature | Purpose |
|---------|---------|
| Row-Level Security (RLS) | Multi-tenant isolation |
| pgvector | Embedding storage (replaces FAISS) |
| pg_trgm | Fuzzy text search |
| JSONB | Flexible metadata |
| Partitioning | Scale audit_events table |

### Database Migration Path

| V2 Component | V3 Replacement | Reason |
|--------------|----------------|--------|
| SQLite | PostgreSQL | Multi-tenant, concurrent writes |
| FAISS (file) | pgvector | Managed, transactional |
| Neo4j | PostgreSQL + JSONB | Simplify ops, graph via CTEs |

### Python Dependencies (pyproject.toml)

```toml
[project]
name = "sitesync-v3"
version = "3.0.0"
requires-python = ">=3.12"
dependencies = [
    "sitesync @ file://../sitesync-claudeV2",  # Import V2 as library
    "fastapi>=0.115.0",
    "sqlalchemy[asyncio]>=2.0.35",
    "asyncpg>=0.30.0",
    "pydantic>=2.10.0",
    "pydantic-ai>=0.0.9",
    "alembic>=1.14.0",
    "opentelemetry-api>=1.28.0",
    "opentelemetry-sdk>=1.28.0",
]

[project.optional-dependencies]
dev = [
    "pytest>=8.3.0",
    "pytest-asyncio>=0.24.0",
    "pytest-cov>=6.0.0",
    "mypy>=1.13.0",
    "ruff>=0.8.0",
]
```

### Frontend Stack

- **React 18** with TypeScript
- **TanStack Query** for server state
- **Tailwind CSS** for styling
- **PWA** for offline-first mobile

---

## 5. Data Model

### Entity Relationship Overview

```
Organization (tenant root)
    │
    ├── Sites (buildings/locations)
    │       │
    │       └── Elevators (assets)
    │               │
    │               ├── Work Orders
    │               │       ├── Tasks
    │               │       ├── Parts Used
    │               │       ├── Labor Entries
    │               │       └── AI Diagnoses
    │               │
    │               ├── Maintenance Schedules
    │               └── Documents (linked to V2 extractions)
    │
    ├── Contractors
    │       └── Certifications
    │
    ├── Inventory Items
    │       └── Stock Transactions
    │
    └── Users
            └── Roles/Permissions
```

### Core SQL Schema

```sql
-- ORGANIZATIONS (Multi-tenant Root)
CREATE TABLE organizations (
    id UUID PRIMARY KEY DEFAULT gen_random_uuid(),
    name VARCHAR(255) NOT NULL,
    slug VARCHAR(100) UNIQUE NOT NULL,  -- {slug}.arprofm.com
    subscription_tier VARCHAR(50) DEFAULT 'free',
    settings JSONB DEFAULT '{}',
    created_at TIMESTAMPTZ DEFAULT NOW(),
    updated_at TIMESTAMPTZ DEFAULT NOW()
);

-- SITES (Buildings/Locations)
CREATE TABLE sites (
    id UUID PRIMARY KEY DEFAULT gen_random_uuid(),
    organization_id UUID NOT NULL REFERENCES organizations(id) ON DELETE CASCADE,
    name VARCHAR(255) NOT NULL,
    address_line1 VARCHAR(255),
    city VARCHAR(100),
    state VARCHAR(100),
    postal_code VARCHAR(20),
    country VARCHAR(100) DEFAULT 'Australia',
    timezone VARCHAR(50) DEFAULT 'Australia/Sydney',
    contact_name VARCHAR(255),
    contact_phone VARCHAR(50),
    contact_email VARCHAR(255),
    metadata JSONB DEFAULT '{}',
    created_at TIMESTAMPTZ DEFAULT NOW(),
    updated_at TIMESTAMPTZ DEFAULT NOW()
);

-- ELEVATORS (Assets)
CREATE TYPE elevator_status AS ENUM (
    'operational', 'degraded', 'out_of_service', 'maintenance', 'decommissioned'
);

CREATE TABLE elevators (
    id UUID PRIMARY KEY DEFAULT gen_random_uuid(),
    organization_id UUID NOT NULL REFERENCES organizations(id) ON DELETE CASCADE,
    site_id UUID NOT NULL REFERENCES sites(id) ON DELETE CASCADE,
    unit_number VARCHAR(50) NOT NULL,
    serial_number VARCHAR(100),
    registration_number VARCHAR(100),
    manufacturer VARCHAR(100),
    model VARCHAR(100),
    controller_type VARCHAR(100),
    drive_type VARCHAR(100),
    capacity_kg INTEGER,
    speed_mps DECIMAL(4,2),
    floors_served INTEGER,
    installation_date DATE,
    status elevator_status DEFAULT 'operational',
    last_inspection_date DATE,
    next_inspection_due DATE,
    v2_document_ids INTEGER[],  -- Links to V2 manuals
    specifications JSONB DEFAULT '{}',
    created_at TIMESTAMPTZ DEFAULT NOW(),
    updated_at TIMESTAMPTZ DEFAULT NOW(),
    UNIQUE(organization_id, site_id, unit_number)
);

-- CONTRACTORS
CREATE TABLE contractors (
    id UUID PRIMARY KEY DEFAULT gen_random_uuid(),
    organization_id UUID NOT NULL REFERENCES organizations(id) ON DELETE CASCADE,
    company_name VARCHAR(255),
    contact_name VARCHAR(255) NOT NULL,
    email VARCHAR(255),
    phone VARCHAR(50),
    license_number VARCHAR(100),
    contractor_type VARCHAR(50),  -- 'employee', 'subcontractor', 'vendor'
    specializations TEXT[],  -- ['KONE', 'OTIS', 'hydraulic']
    hourly_rate DECIMAL(10,2),
    is_active BOOLEAN DEFAULT true,
    rating DECIMAL(3,2),
    total_jobs_completed INTEGER DEFAULT 0,
    metadata JSONB DEFAULT '{}',
    created_at TIMESTAMPTZ DEFAULT NOW(),
    updated_at TIMESTAMPTZ DEFAULT NOW()
);

-- WORK ORDERS
CREATE TYPE work_order_status AS ENUM (
    'draft', 'pending', 'scheduled', 'in_progress',
    'on_hold', 'completed', 'cancelled', 'invoiced'
);

CREATE TYPE work_order_priority AS ENUM (
    'emergency', 'high', 'medium', 'low', 'scheduled'
);

CREATE TYPE work_order_type AS ENUM (
    'breakdown', 'preventive', 'inspection', 'installation',
    'modernization', 'callback', 'audit'
);

CREATE TABLE work_orders (
    id UUID PRIMARY KEY DEFAULT gen_random_uuid(),
    organization_id UUID NOT NULL REFERENCES organizations(id) ON DELETE CASCADE,
    elevator_id UUID NOT NULL REFERENCES elevators(id),
    work_order_number VARCHAR(50) NOT NULL,
    type work_order_type NOT NULL,
    priority work_order_priority DEFAULT 'medium',
    status work_order_status DEFAULT 'draft',
    title VARCHAR(255) NOT NULL,
    description TEXT,
    fault_code VARCHAR(50),
    reported_symptoms TEXT[],
    reported_at TIMESTAMPTZ DEFAULT NOW(),
    scheduled_start TIMESTAMPTZ,
    scheduled_end TIMESTAMPTZ,
    actual_start TIMESTAMPTZ,
    actual_end TIMESTAMPTZ,
    assigned_contractor_id UUID REFERENCES contractors(id),
    ai_diagnosis_id UUID,
    ai_suggested_parts TEXT[],
    ai_confidence DECIMAL(3,2),
    resolution_notes TEXT,
    root_cause TEXT,
    custom_fields JSONB DEFAULT '{}',
    created_by UUID NOT NULL,
    created_at TIMESTAMPTZ DEFAULT NOW(),
    updated_at TIMESTAMPTZ DEFAULT NOW(),
    UNIQUE(organization_id, work_order_number)
);

-- AUDIT EVENTS (Immutable)
CREATE TYPE audit_event_type AS ENUM (
    'work_order_created', 'work_order_updated', 'work_order_completed',
    'elevator_status_changed', 'inspection_completed',
    'part_used', 'labor_logged', 'diagnosis_requested',
    'document_uploaded', 'user_action'
);

CREATE TABLE audit_events (
    id UUID PRIMARY KEY DEFAULT gen_random_uuid(),
    organization_id UUID NOT NULL REFERENCES organizations(id),
    event_type audit_event_type NOT NULL,
    entity_type VARCHAR(50) NOT NULL,
    entity_id UUID NOT NULL,
    actor_id UUID NOT NULL,
    actor_type VARCHAR(50) DEFAULT 'user',
    event_data JSONB NOT NULL,
    previous_state JSONB,
    new_state JSONB,
    hash VARCHAR(64) NOT NULL,  -- SHA-256 chain
    created_at TIMESTAMPTZ DEFAULT NOW()
) PARTITION BY RANGE (created_at);

-- ROW-LEVEL SECURITY
ALTER TABLE sites ENABLE ROW LEVEL SECURITY;
ALTER TABLE elevators ENABLE ROW LEVEL SECURITY;
ALTER TABLE contractors ENABLE ROW LEVEL SECURITY;
ALTER TABLE work_orders ENABLE ROW LEVEL SECURITY;

CREATE POLICY org_isolation_sites ON sites
    USING (organization_id = current_setting('app.current_org')::uuid);

CREATE POLICY org_isolation_elevators ON elevators
    USING (organization_id = current_setting('app.current_org')::uuid);
```

### Pydantic Models

```python
# sitesync_v3/domains/assets/models.py
from datetime import date, datetime
from decimal import Decimal
from enum import Enum
from uuid import UUID
from pydantic import BaseModel, Field

class ElevatorStatus(str, Enum):
    OPERATIONAL = "operational"
    DEGRADED = "degraded"
    OUT_OF_SERVICE = "out_of_service"
    MAINTENANCE = "maintenance"
    DECOMMISSIONED = "decommissioned"

class Elevator(BaseModel):
    id: UUID
    organization_id: UUID
    site_id: UUID
    unit_number: str
    serial_number: str | None = None
    registration_number: str | None = None
    manufacturer: str | None = None
    model: str | None = None
    controller_type: str | None = None
    drive_type: str | None = None
    capacity_kg: int | None = None
    speed_mps: Decimal | None = None
    floors_served: int | None = None
    installation_date: date | None = None
    status: ElevatorStatus = ElevatorStatus.OPERATIONAL
    last_inspection_date: date | None = None
    next_inspection_due: date | None = None
    v2_document_ids: list[int] = Field(default_factory=list)
    specifications: dict = Field(default_factory=dict)
    created_at: datetime
    updated_at: datetime
    model_config = {"frozen": True}

class WorkOrderStatus(str, Enum):
    DRAFT = "draft"
    PENDING = "pending"
    SCHEDULED = "scheduled"
    IN_PROGRESS = "in_progress"
    ON_HOLD = "on_hold"
    COMPLETED = "completed"
    CANCELLED = "cancelled"
    INVOICED = "invoiced"

class WorkOrderPriority(str, Enum):
    EMERGENCY = "emergency"
    HIGH = "high"
    MEDIUM = "medium"
    LOW = "low"
    SCHEDULED = "scheduled"

class WorkOrderType(str, Enum):
    BREAKDOWN = "breakdown"
    PREVENTIVE = "preventive"
    INSPECTION = "inspection"
    INSTALLATION = "installation"
    MODERNIZATION = "modernization"
    CALLBACK = "callback"
    AUDIT = "audit"

class WorkOrder(BaseModel):
    id: UUID
    organization_id: UUID
    elevator_id: UUID
    work_order_number: str
    type: WorkOrderType
    priority: WorkOrderPriority = WorkOrderPriority.MEDIUM
    status: WorkOrderStatus = WorkOrderStatus.DRAFT
    title: str
    description: str | None = None
    fault_code: str | None = None
    reported_symptoms: list[str] = Field(default_factory=list)
    reported_at: datetime
    scheduled_start: datetime | None = None
    scheduled_end: datetime | None = None
    actual_start: datetime | None = None
    actual_end: datetime | None = None
    assigned_contractor_id: UUID | None = None
    ai_diagnosis_id: UUID | None = None
    ai_suggested_parts: list[str] = Field(default_factory=list)
    ai_confidence: Decimal | None = None
    resolution_notes: str | None = None
    root_cause: str | None = None
    custom_fields: dict = Field(default_factory=dict)
    created_by: UUID
    created_at: datetime
    updated_at: datetime
    model_config = {"frozen": True}
```

---

## 6. Domain Structure

### Domain Pattern

Each V3 domain follows this structure:

```
sitesync_v3/domains/{domain}/
├── __init__.py       # Public exports
├── contracts.py      # Protocol interfaces
├── models.py         # Pydantic models
├── service.py        # Business logic
├── repository.py     # Data access
└── test_{domain}.py  # Tests
```

### Domain Contracts (Protocols)

```python
# Organizations Domain
class OrganizationRepository(Protocol):
    async def get(self, org_id: UUID) -> Organization | None: ...
    async def get_by_slug(self, slug: str) -> Organization | None: ...
    async def create(self, data: OrganizationCreate) -> Organization: ...
    async def update(self, org_id: UUID, data: dict) -> Organization: ...
    async def delete(self, org_id: UUID) -> None: ...

class OrganizationService(Protocol):
    async def create_organization(self, data: OrganizationCreate) -> Organization: ...
    async def get_organization(self, org_id: UUID) -> Organization: ...
    async def update_settings(self, org_id: UUID, settings: dict) -> Organization: ...

# Assets Domain
class AssetRepository(Protocol):
    async def get_elevator(self, elevator_id: UUID) -> Elevator | None: ...
    async def list_elevators(self, site_id: UUID) -> list[Elevator]: ...
    async def create_elevator(self, data: ElevatorCreate) -> Elevator: ...
    async def update_elevator_status(self, elevator_id: UUID, status: str) -> Elevator: ...
    async def get_site(self, site_id: UUID) -> Site | None: ...
    async def list_sites(self, org_id: UUID) -> list[Site]: ...
    async def create_site(self, data: SiteCreate) -> Site: ...

class AssetService(Protocol):
    async def register_elevator(self, data: ElevatorCreate) -> Elevator: ...
    async def link_documents(self, elevator_id: UUID, document_ids: list[int]) -> None: ...
    async def get_elevator_with_history(self, elevator_id: UUID) -> dict: ...
    async def get_ai_recommendations(self, elevator_id: UUID) -> dict: ...

# Work Orders Domain
class WorkOrderRepository(Protocol):
    async def get(self, work_order_id: UUID) -> WorkOrder | None: ...
    async def list_by_elevator(self, elevator_id: UUID) -> list[WorkOrder]: ...
    async def list_by_contractor(self, contractor_id: UUID) -> list[WorkOrder]: ...
    async def list_by_status(self, org_id: UUID, status: str) -> list[WorkOrder]: ...
    async def create(self, data: WorkOrderCreate) -> WorkOrder: ...
    async def update(self, work_order_id: UUID, data: WorkOrderUpdate) -> WorkOrder: ...

class WorkOrderService(Protocol):
    async def create_work_order(self, data: WorkOrderCreate) -> WorkOrder: ...
    async def assign_contractor(self, work_order_id: UUID, contractor_id: UUID) -> WorkOrder: ...
    async def start_work(self, work_order_id: UUID) -> WorkOrder: ...
    async def complete_work(self, work_order_id: UUID, resolution: str) -> WorkOrder: ...
    async def request_ai_diagnosis(self, work_order_id: UUID) -> dict: ...
    async def get_suggested_parts(self, work_order_id: UUID) -> list[str]: ...

# Audit Domain
class AuditRepository(Protocol):
    async def create(self, event: AuditEventCreate) -> AuditEvent: ...
    async def list_by_entity(self, entity_type: str, entity_id: UUID) -> list[AuditEvent]: ...
    async def list_by_date_range(self, org_id: UUID, start: datetime, end: datetime) -> list[AuditEvent]: ...
    async def verify_chain(self, org_id: UUID) -> bool: ...

class AuditService(Protocol):
    async def log_event(
        self, event_type: str, entity_type: str, entity_id: UUID,
        actor_id: UUID, data: dict
    ) -> AuditEvent: ...
    async def get_entity_history(self, entity_type: str, entity_id: UUID) -> list[AuditEvent]: ...
    async def export_audit_report(self, org_id: UUID, start: datetime, end: datetime) -> bytes: ...
```

---

## 7. Triforce AI System

### Architecture

```
┌─────────────────────────────────────────────────────────────────────┐
│                         TRIFORCE V3                                 │
├─────────────────────────────────────────────────────────────────────┤
│                                                                     │
│  ┌───────────┐   ┌───────────┐   ┌───────────┐                     │
│  │  Gemini   │   │  Claude   │   │   GPT-4   │  ← JURY             │
│  │  2.0 Pro  │   │  Sonnet   │   │   Turbo   │    (Parallel)       │
│  └─────┬─────┘   └─────┬─────┘   └─────┬─────┘                     │
│        │               │               │                            │
│        └───────────────┼───────────────┘                            │
│                        ▼                                            │
│              ┌─────────────────┐                                    │
│              │    CONSENSUS    │  ← Weighted by confidence          │
│              │     VOTING      │    (Majority/Quorum/Unanimous)     │
│              └────────┬────────┘                                    │
│                       ▼                                             │
│  ┌─────────────────────────────────────────────────────────────┐   │
│  │                    WITNESS (Validation)                      │   │
│  │  ┌──────────────┐  ┌──────────────┐  ┌──────────────┐       │   │
│  │  │ Graph RAG    │  │ Hybrid Search│  │ Tool Results │       │   │
│  │  │ (Neo4j)      │  │ (V2)         │  │ Verification │       │   │
│  │  └──────────────┘  └──────────────┘  └──────────────┘       │   │
│  └──────────────────────────┬──────────────────────────────────┘   │
│                             ▼                                       │
│              ┌─────────────────────────┐                            │
│              │         JUDGE           │  ← Claude Opus 4.5        │
│              │  (Final Synthesis)      │    with Skills            │
│              └─────────────────────────┘                            │
│                             │                                       │
│                             ▼                                       │
│  ┌─────────────────────────────────────────────────────────────┐   │
│  │                 HIERARCHICAL MEMORY                          │   │
│  │  ┌───────────┐  ┌───────────┐  ┌────────────┐               │   │
│  │  │ Episodic  │  │ Semantic  │  │ Procedural │               │   │
│  │  │ (Tasks)   │  │ (Facts)   │  │ (Skills)   │               │   │
│  │  └───────────┘  └───────────┘  └────────────┘               │   │
│  └─────────────────────────────────────────────────────────────┘   │
│                                                                     │
└─────────────────────────────────────────────────────────────────────┘
```

### Consensus Voting

```python
class ConsensusVoting:
    """Aggregate jury responses with weighted voting."""

    async def vote(
        self,
        responses: list[JuryResponse],
        weights: dict[str, float] | None = None
    ) -> ConsensusResult:
        """
        Voting strategies:
        - Majority: Most common answer wins
        - Weighted: Factor in model confidence
        - Unanimous: Require agreement
        - Quorum: N of M must agree
        """
        pass
```

### Hierarchical Memory

```python
class HierarchicalMemory:
    """Three-tier memory system."""

    # Episodic: Task-specific context
    episodic: EpisodicMemory  # "Last time with KONE F505..."

    # Semantic: Factual knowledge
    semantic: SemanticMemory  # "F505 means door zone fault"

    # Procedural: Skills and workflows
    procedural: ProceduralMemory  # "How to diagnose door faults"

    async def recall(self, query: str, memory_types: list[str]) -> MemoryContext:
        """Retrieve relevant memories for current task."""
        pass

    async def consolidate(self, task_result: TaskResult) -> None:
        """Move short-term to long-term memory during idle."""
        pass
```

### Skills Manager

```python
class SkillsManager:
    """Load and inject specialized skills."""

    skills_dir: Path = Path("skills/")

    async def load_skill(self, skill_name: str) -> Skill:
        """Load skill definition from YAML/Markdown."""
        pass

    async def inject_skills(self, task: Task, auto_select: bool = True) -> list[Skill]:
        """Select and inject relevant skills for task."""
        pass
```

### Pydantic AI for Structured Outputs

```python
from pydantic import BaseModel
from pydantic_ai import Agent

class DiagnosisResult(BaseModel):
    fault_code: str
    severity: str
    causes: list[str]
    recommended_actions: list[str]
    parts_needed: list[str]
    confidence: float

diagnosis_agent = Agent(
    'gemini-2.0-flash',
    result_type=DiagnosisResult,
    system_prompt="You are an elevator fault diagnosis expert..."
)

result = await diagnosis_agent.run("Door won't close, error F505")
# result.data is DiagnosisResult with structured fields
```

---

## 8. Key Features

### 8.1 Parts Marketplace & Van Stock

**Van Stock Management:**
- Track inventory each technician carries in their vehicle
- Low stock alerts with auto-reorder
- Share parts between techs (same company)
- "Sarah is 2km away with that sensor"

**Parts Marketplace (Network Effect):**
```
┌─────────────────────────────────────────┐
│  MARKETPLACE: Door Sensor               │
│                                         │
│  $35 New - Sydney (Save $12 vs retail)  │
│  $20 Used - Melbourne (Tested working)  │
│                                         │
│  SUPPLIERS:                             │
│  KONE Direct: $47 • Next day            │
│  Motion: $52 • Same day                 │
└─────────────────────────────────────────┘
```

**Flywheel**: More sellers → Better selection → More buyers → More sellers

**Revenue Model**: 2-5% transaction fees + premium features

### 8.2 Multi-Trade Platform Structure

```
Building Manager Dashboard
│
├── LIFTS & ESCALATORS
│   ├── All lifts with Lift AI (specialized knowledge)
│   ├── Fault reporting with guided AI assistance
│   └── Links to: Parts → Fault Codes → Images
│
├── HVAC
│   ├── All HVAC units with HVAC AI
│   ├── Maintenance schedules, filter changes
│   └── Temperature/comfort complaints
│
├── ELECTRICAL
│   ├── Switchboards, circuits, lighting
│   ├── Power quality, load monitoring
│   └── Emergency lighting tests
│
├── PLUMBING
│   ├── Hot water, pumps, drainage
│   ├── Water quality, backflow testing
│   └── Emergency repairs
│
├── FIRE SYSTEMS
│   ├── Detection, suppression, exits
│   ├── Compliance testing schedules
│   └── Incident reports
│
├── SECURITY
│   ├── Access control, CCTV, intercoms
│   └── Incident reports
│
├── PAINTING & FIT-OUT
│   ├── Scheduled refreshes
│   └── Quote management
│
└── REMOVALISTS & LOGISTICS
    ├── Move-in/move-out scheduling
    └── Lift booking for moves
```

### 8.3 Emergency Response Categories

```
EMERGENCY CATEGORY 1 (Immediate - people safety):
├── People stuck in lift
├── Fire/smoke detected
├── Flooding/water damage active
└── Security breach in progress

EMERGENCY CATEGORY 2 (Urgent - building impact):
├── Lift out of service (single lift building)
├── HVAC failure (extreme weather)
├── Power failure
└── Fire system fault

EMERGENCY CATEGORY 3 (Standard):
├── Lift intermittent fault
├── Comfort complaints
├── Minor damage reports
└── Vandalism
```

### 8.4 Breakthrough Innovations (12 Categories)

1. **AI Magic**: AI Vision, Ambient Intelligence, Predictive Summoning
2. **Hardware/IoT**: Smart Stickers (<$5), Acoustic Monitors, Diagnostic Dongle
3. **Collaboration**: Remote Expert AR, Anonymous Knowledge Network
4. **Automation**: Self-Healing Systems, Predictive Parts Ordering
5. **Data & Analytics**: Building Health Score (0-100), Anonymous Benchmarking
6. **Integration**: Universal BMS Connector, API Marketplace
7. **Payment**: Instant Technician Payouts, Equipment-as-a-Service
8. **Training**: AI-Generated Videos, VR Safety Simulations, Micro-Credentials
9. **Communication**: Tech-to-Human Translation, Sentiment Escalation
10. **Accessibility**: Voice-First, Visual Guides, 100+ Languages
11. **Sustainability**: Carbon Footprint Dashboard, ESG Reporting
12. **Security**: Zero-Knowledge Architecture, Blockchain Audit Trail

### 8.5 Building Health Score

**Concept**: Single score (0-100) representing building health

**Calculated from:**
- Equipment age and condition
- Maintenance history and compliance
- Predictive failure risk
- Energy efficiency
- Tenant satisfaction

**Features:**
- Trend over time
- Benchmark against similar buildings
- Predictive: "Score will drop to 65 in 6 months without action"

---

## 9. API Design

### FastAPI Structure

```python
# sitesync_v3/interfaces/api/main.py
from fastapi import FastAPI, Depends
from contextlib import asynccontextmanager

@asynccontextmanager
async def lifespan(app: FastAPI):
    # Startup: Initialize database pool, cache connections
    await init_db_pool()
    await init_redis()
    yield
    # Shutdown: Close connections
    await close_db_pool()
    await close_redis()

app = FastAPI(
    title="SiteSync V3 API",
    version="3.0.0",
    lifespan=lifespan,
)

# Include routers
app.include_router(organizations_router, prefix="/api/v1/organizations", tags=["organizations"])
app.include_router(sites_router, prefix="/api/v1/sites", tags=["sites"])
app.include_router(elevators_router, prefix="/api/v1/elevators", tags=["elevators"])
app.include_router(work_orders_router, prefix="/api/v1/work-orders", tags=["work-orders"])
app.include_router(contractors_router, prefix="/api/v1/contractors", tags=["contractors"])
app.include_router(inventory_router, prefix="/api/v1/inventory", tags=["inventory"])
app.include_router(diagnosis_router, prefix="/api/v1/diagnosis", tags=["diagnosis"])
```

### Key Endpoints

```
# Organizations
GET    /api/v1/organizations/{org_id}
PATCH  /api/v1/organizations/{org_id}

# Sites
GET    /api/v1/sites
POST   /api/v1/sites
GET    /api/v1/sites/{site_id}
PATCH  /api/v1/sites/{site_id}
DELETE /api/v1/sites/{site_id}

# Elevators
GET    /api/v1/elevators
POST   /api/v1/elevators
GET    /api/v1/elevators/{elevator_id}
PATCH  /api/v1/elevators/{elevator_id}
GET    /api/v1/elevators/{elevator_id}/history

# Work Orders
GET    /api/v1/work-orders
POST   /api/v1/work-orders
GET    /api/v1/work-orders/{work_order_id}
PATCH  /api/v1/work-orders/{work_order_id}
POST   /api/v1/work-orders/{work_order_id}/assign
POST   /api/v1/work-orders/{work_order_id}/start
POST   /api/v1/work-orders/{work_order_id}/complete

# AI Diagnosis
POST   /api/v1/diagnosis/request
GET    /api/v1/diagnosis/{diagnosis_id}
POST   /api/v1/diagnosis/{diagnosis_id}/feedback

# Van Stock
GET    /api/v1/inventory/van-stock
POST   /api/v1/inventory/van-stock
PATCH  /api/v1/inventory/van-stock/{item_id}
GET    /api/v1/inventory/nearby/{part_number}

# Marketplace
GET    /api/v1/marketplace/listings
POST   /api/v1/marketplace/listings
POST   /api/v1/marketplace/search
POST   /api/v1/marketplace/buy
```

---

## 10. Security & Multi-Tenancy

### Row-Level Security (RLS)

All tables enable RLS with organization-scoped policies:

```sql
-- Enable RLS
ALTER TABLE sites ENABLE ROW LEVEL SECURITY;
ALTER TABLE elevators ENABLE ROW LEVEL SECURITY;
ALTER TABLE work_orders ENABLE ROW LEVEL SECURITY;

-- Policy: Users only see their organization's data
CREATE POLICY org_isolation ON sites
    USING (organization_id = current_setting('app.current_org')::uuid);

-- Set organization context on each request
SET app.current_org = 'uuid-of-current-org';
```

### JWT Authentication Pattern

```python
from fastapi import Depends, HTTPException, Security
from fastapi.security import HTTPBearer, HTTPAuthorizationCredentials
import jwt

security = HTTPBearer()

async def get_current_user(
    credentials: HTTPAuthorizationCredentials = Security(security)
) -> User:
    token = credentials.credentials
    try:
        payload = jwt.decode(token, SECRET_KEY, algorithms=["HS256"])
        return User(**payload)
    except jwt.InvalidTokenError:
        raise HTTPException(status_code=401, detail="Invalid token")

async def set_org_context(
    user: User = Depends(get_current_user),
    db: AsyncSession = Depends(get_db)
):
    await db.execute(f"SET app.current_org = '{user.organization_id}'")
    return user
```

### Audit Trail with Hash Chain

```python
import hashlib
import json

async def create_audit_event(
    session: AsyncSession,
    event_type: str,
    entity_type: str,
    entity_id: UUID,
    actor_id: UUID,
    data: dict,
    previous_hash: str | None = None
) -> AuditEvent:
    # Compute hash including previous hash for chain integrity
    hash_input = json.dumps({
        "event_type": event_type,
        "entity_id": str(entity_id),
        "actor_id": str(actor_id),
        "data": data,
        "previous_hash": previous_hash or ""
    }, sort_keys=True)

    event_hash = hashlib.sha256(hash_input.encode()).hexdigest()

    event = AuditEvent(
        event_type=event_type,
        entity_type=entity_type,
        entity_id=entity_id,
        actor_id=actor_id,
        event_data=data,
        hash=event_hash
    )
    session.add(event)
    await session.commit()
    return event
```

---

## 11. Market Strategy

### 4-Phase Growth Plan

| Phase | Timeline | ARR Target | Focus |
|-------|----------|------------|-------|
| **1: Foundation** | Months 1-12 | $0-$1M | Australia/NZ, 1000 users, elevator-only |
| **2: Validation** | Months 13-36 | $1M-$10M | North America, marketplace launch |
| **3: Domination** | Years 4-7 | $10M-$100M | Global, multi-trade, IPO prep |
| **4: Global** | Years 8-10 | $100M+ | Industry standard, 1M+ users |

### Pricing Strategy

**Disruptive Pricing (10x undercut):**
| Tier | Price | Features |
|------|-------|----------|
| Free | $0 | 10 lookups/month |
| Pro | $29/month | Unlimited lookups, basic features |
| Expert | $79/month | AI diagnosis, custom procedures |
| Enterprise | $500+/month | Team features, analytics |

**Enterprise Volume:**
- 1-10 techs: $29/month each
- 11-50 techs: $24/month each (17% discount)
- 51+ techs: $19/month each (34% discount)

### Competitive Counter-Positioning

| ServiceTitan (Incumbent) | SiteSync (Counter) |
|--------------------------|---------------------|
| $299-899/month | $29/month |
| Weeks to setup | 5 minutes |
| Dedicated hardware | Any device |
| 21 trades (shallow) | 1 trade (deep) → expand |
| Seat-based pricing | Usage-based option |

### Distribution Channels

1. **Trade Associations**: EEAA (Australia), NAEC (North America), LEIA (Europe)
2. **Manufacturer Partners**: KONE, Otis, Schindler white-label deals (20% revenue share)
3. **SEO/Content**: Own every "elevator fault code" search
4. **Trade Schools**: Free for students (lifetime loyalty)
5. **Viral Loop**: Invite 3 colleagues → unlock 50 lookups/month

### Moat Construction

1. **Data Moat**: 100K+ fault diagnoses, temporal patterns (impossible to replicate)
2. **Network Effects**: Parts marketplace, knowledge sharing
3. **Regulatory Moat**: AS 1735, ASME A17.1, ISO 9001 certifications
4. **Ecosystem Moat**: 50+ third-party integrations
5. **Brand Moat**: "SiteSync" synonymous with elevator intelligence

---

## 12. Implementation Roadmap

### Phase 1: Foundation (Months 1-6)

**Must-Have Features:**
1. AI Vision (point camera, get diagnosis)
2. Voice-First Interface (zero typing)
3. Self-Healing Systems (detect → dispatch → resolve)
4. Building Health Score
5. Instant Technician Payouts

**Technical:**
- PostgreSQL + pgvector setup
- FastAPI core routes
- React dashboard MVP
- V2 import bridge
- Basic RLS implementation

### Phase 2: Scale (Months 7-12)

**Focus:**
1. Smart Stickers (ultra-cheap sensors)
2. Anonymous Knowledge Network
3. API Marketplace
4. Green Recommendations
5. Universal BMS Connector

**Technical:**
- Parts marketplace backend
- Van stock management
- Mobile PWA
- Extended integrations

### Phase 3: Advanced (Months 13-24)

**Focus:**
1. VR Training
2. Drone Inspector
3. Equipment-as-a-Service
4. Zero-Knowledge Architecture
5. Blockchain Audit Trail

**Technical:**
- Multi-trade expansion (HVAC, electrical)
- Enterprise features
- Advanced AI (predictive maintenance)
- Global deployment

---

## 13. Code Patterns

### Python 3.12+ Type Syntax

```python
# Use PEP 695 type parameter syntax
class Repository[T]:
    async def get(self, id: UUID) -> T | None: ...
    async def list(self) -> list[T]: ...
    async def create(self, data: T) -> T: ...

# Use X | None instead of Optional[X]
def process(data: str | None = None) -> dict: ...

# Use list[X] instead of List[X]
def get_items() -> list[Item]: ...
```

### Async Repository Pattern

```python
class PostgresElevatorRepository:
    def __init__(self, session: AsyncSession):
        self.session = session

    async def get(self, elevator_id: UUID) -> Elevator | None:
        result = await self.session.execute(
            select(ElevatorModel).where(ElevatorModel.id == elevator_id)
        )
        row = result.scalar_one_or_none()
        return Elevator.model_validate(row) if row else None

    async def list_by_site(self, site_id: UUID) -> list[Elevator]:
        result = await self.session.execute(
            select(ElevatorModel).where(ElevatorModel.site_id == site_id)
        )
        return [Elevator.model_validate(row) for row in result.scalars()]

    async def create(self, data: ElevatorCreate) -> Elevator:
        elevator = ElevatorModel(**data.model_dump())
        self.session.add(elevator)
        await self.session.commit()
        await self.session.refresh(elevator)
        return Elevator.model_validate(elevator)
```

### Service Layer Pattern

```python
class WorkOrderService:
    def __init__(
        self,
        repository: WorkOrderRepository,
        audit_service: AuditService,
        diagnosis_client: DiagnosisClient,
    ):
        self.repository = repository
        self.audit = audit_service
        self.diagnosis = diagnosis_client

    async def create_work_order(
        self, data: WorkOrderCreate, actor_id: UUID
    ) -> WorkOrder:
        # Generate work order number
        data.work_order_number = await self._generate_wo_number(data.organization_id)

        # Create work order
        work_order = await self.repository.create(data)

        # Log audit event
        await self.audit.log_event(
            event_type="work_order_created",
            entity_type="work_order",
            entity_id=work_order.id,
            actor_id=actor_id,
            data=work_order.model_dump(),
        )

        return work_order

    async def request_ai_diagnosis(self, work_order_id: UUID) -> DiagnosisResult:
        work_order = await self.repository.get(work_order_id)
        if not work_order:
            raise NotFoundError("Work order not found")

        # Call V2 diagnosis via import bridge
        result = await self.diagnosis.diagnose(
            fault_code=work_order.fault_code,
            symptoms=work_order.reported_symptoms,
            equipment_type=work_order.elevator.manufacturer,
        )

        # Update work order with AI results
        await self.repository.update(work_order_id, {
            "ai_diagnosis_id": result.id,
            "ai_suggested_parts": result.parts_needed,
            "ai_confidence": result.confidence,
        })

        return result
```

### FastAPI Router Pattern

```python
from fastapi import APIRouter, Depends, HTTPException, status
from uuid import UUID

router = APIRouter()

@router.get("/{work_order_id}", response_model=WorkOrderResponse)
async def get_work_order(
    work_order_id: UUID,
    user: User = Depends(set_org_context),
    service: WorkOrderService = Depends(get_work_order_service),
):
    work_order = await service.get_work_order(work_order_id)
    if not work_order:
        raise HTTPException(status_code=404, detail="Work order not found")
    return work_order

@router.post("/", response_model=WorkOrderResponse, status_code=status.HTTP_201_CREATED)
async def create_work_order(
    data: WorkOrderCreate,
    user: User = Depends(set_org_context),
    service: WorkOrderService = Depends(get_work_order_service),
):
    data.organization_id = user.organization_id
    data.created_by = user.id
    return await service.create_work_order(data, actor_id=user.id)

@router.post("/{work_order_id}/diagnose", response_model=DiagnosisResponse)
async def request_diagnosis(
    work_order_id: UUID,
    user: User = Depends(set_org_context),
    service: WorkOrderService = Depends(get_work_order_service),
):
    return await service.request_ai_diagnosis(work_order_id)
```

---

## 14. Quick Reference

### Key Enums

```python
# Elevator Status
'operational' | 'degraded' | 'out_of_service' | 'maintenance' | 'decommissioned'

# Work Order Status
'draft' | 'pending' | 'scheduled' | 'in_progress' | 'on_hold' | 'completed' | 'cancelled' | 'invoiced'

# Work Order Priority
'emergency' | 'high' | 'medium' | 'low' | 'scheduled'

# Work Order Type
'breakdown' | 'preventive' | 'inspection' | 'installation' | 'modernization' | 'callback' | 'audit'

# Audit Event Type
'work_order_created' | 'work_order_updated' | 'work_order_completed' | 'elevator_status_changed' | 'inspection_completed' | 'part_used' | 'labor_logged' | 'diagnosis_requested' | 'document_uploaded' | 'user_action'
```

### Important UUIDs Pattern

All entities use UUID primary keys generated by `gen_random_uuid()`.

### Tenant Isolation Pattern

```python
# Always set organization context before queries
await db.execute(f"SET app.current_org = '{org_id}'")

# RLS policies automatically filter all queries
```

### V2 Import Bridge Pattern

```python
# Import V2 components for reuse
from sitesync.adapters.gemini import GeminiAdapter
from sitesync.domains.diagnosis import DiagnosisAgent

# Use V2 diagnosis in V3 service
class V3DiagnosisService:
    def __init__(self):
        self.v2_agent = DiagnosisAgent(adapter=GeminiAdapter())

    async def diagnose(self, fault_code: str, symptoms: list[str]) -> DiagnosisResult:
        v2_result = await self.v2_agent.run(fault_code, symptoms)
        return DiagnosisResult.from_v2(v2_result)
```

### Success Metrics

| Metric | Target |
|--------|--------|
| Task completion time | -85% |
| First-time fix rate | 90%+ |
| Technician productivity | +30% jobs/day |
| NPS | >70 |
| Churn rate | <5% annual |
| Carbon reduction | 20% per building |

### File Locations

```
V2 Source:     ~/Desktop/sitesync-claudeV2/
V3 Source:     ~/Desktop/sitesync-v3/
Design Docs:   ~/Desktop/SiteSync_V3_Design/
Guide:         ~/Desktop/sitesync/SITESYNC_V3_CLAUDE_CODE_GUIDE.md
```

---

## End of Guide

**Last Updated**: December 2025
**Maintained By**: SiteSync Development Team
**For Claude Code**: This document is optimized for AI assistant context. Update as the system evolves.


<!-- FILE: docs/reference/data-model.md -->

<!--
---
title: SiteSync V3 Data Model
description: Complete database schemas, entity relationships, and Pydantic models
version: 3.0.0
last_updated: 2025-12
status: stable
implementation_status: design
audience: developer, ai_assistant
prerequisites:
  - Basic SQL knowledge
  - Understanding of PostgreSQL features
related_docs:
  - /docs/GLOSSARY.md (entity terminology)
  - /docs/reference/enums.md (status values)
  - /docs/reference/api.md (API endpoints using these models)
---
-->

# SiteSync V3 - Data Model

## Database Schemas & Relationships

> This document provides the complete data model for SiteSync V3, including SQL schemas, Pydantic models, and multi-tenancy implementation.

## Key Terminology

Before reading this document, understand these terms (see `/docs/GLOSSARY.md` for full definitions):
- **Organization**: Multi-tenant root entity (a company using SiteSync)
- **Site**: A building or location
- **Elevator**: A lift asset being managed
- **Work Order**: A job/task to be performed
- **Contractor**: Person/company performing work

---

## Entity Relationship Overview

```
ENTITY RELATIONSHIP DIAGRAM
══════════════════════════════════════════════════════════════════

Organization (tenant root)
    │
    ├── Users
    │       └── Roles/Permissions
    │
    ├── Sites (buildings/locations)
    │       │
    │       └── Elevators (assets)
    │               │
    │               ├── Work Orders
    │               │       ├── Tasks
    │               │       ├── Parts Used
    │               │       ├── Labor Entries
    │               │       └── AI Diagnoses
    │               │
    │               ├── Maintenance Schedules
    │               ├── Equipment History
    │               └── Documents (linked to V2 extractions)
    │
    ├── Contractors
    │       ├── Certifications
    │       └── Technician Profiles
    │
    ├── Inventory Items
    │       ├── Stock Locations
    │       └── Stock Transactions
    │
    └── Audit Events (immutable log)

══════════════════════════════════════════════════════════════════
```

---

## Core Tables

### Organizations

The tenant root - all data belongs to an organization.

```sql
-- ORGANIZATIONS (Multi-tenant Root)
CREATE TABLE organizations (
    id UUID PRIMARY KEY DEFAULT gen_random_uuid(),
    name VARCHAR(255) NOT NULL,
    slug VARCHAR(100) UNIQUE NOT NULL,  -- {slug}.sitesync.com
    subscription_tier VARCHAR(50) DEFAULT 'free',
    -- 'free', 'pro', 'expert', 'enterprise'

    -- Contact information
    contact_email VARCHAR(255),
    contact_phone VARCHAR(50),
    billing_email VARCHAR(255),

    -- Configuration
    settings JSONB DEFAULT '{}',
    -- {
    --   "timezone": "Australia/Sydney",
    --   "date_format": "DD/MM/YYYY",
    --   "currency": "AUD",
    --   "default_priority": "medium",
    --   "ai_enabled": true
    -- }

    -- Subscription
    subscription_started_at TIMESTAMPTZ,
    subscription_ends_at TIMESTAMPTZ,
    trial_ends_at TIMESTAMPTZ,

    -- Metadata
    created_at TIMESTAMPTZ DEFAULT NOW(),
    updated_at TIMESTAMPTZ DEFAULT NOW(),

    -- Soft delete
    deleted_at TIMESTAMPTZ
);

CREATE INDEX idx_organizations_slug ON organizations(slug);
CREATE INDEX idx_organizations_deleted ON organizations(deleted_at) WHERE deleted_at IS NULL;
```

### Users

```sql
-- USERS
CREATE TABLE users (
    id UUID PRIMARY KEY DEFAULT gen_random_uuid(),
    organization_id UUID NOT NULL REFERENCES organizations(id) ON DELETE CASCADE,

    -- Authentication
    email VARCHAR(255) NOT NULL,
    password_hash VARCHAR(255) NOT NULL,
    email_verified BOOLEAN DEFAULT false,

    -- Profile
    first_name VARCHAR(100),
    last_name VARCHAR(100),
    phone VARCHAR(50),
    avatar_url VARCHAR(500),

    -- Role & permissions
    role VARCHAR(50) DEFAULT 'user',
    -- 'owner', 'admin', 'manager', 'user', 'technician', 'readonly'
    permissions JSONB DEFAULT '[]',
    -- ["work_orders:create", "work_orders:edit", ...]

    -- Status
    is_active BOOLEAN DEFAULT true,
    last_login_at TIMESTAMPTZ,

    -- Metadata
    preferences JSONB DEFAULT '{}',
    created_at TIMESTAMPTZ DEFAULT NOW(),
    updated_at TIMESTAMPTZ DEFAULT NOW(),

    UNIQUE(organization_id, email)
);

CREATE INDEX idx_users_org ON users(organization_id);
CREATE INDEX idx_users_email ON users(email);
CREATE INDEX idx_users_active ON users(is_active) WHERE is_active = true;
```

### Sites

```sql
-- SITES (Buildings/Locations)
CREATE TABLE sites (
    id UUID PRIMARY KEY DEFAULT gen_random_uuid(),
    organization_id UUID NOT NULL REFERENCES organizations(id) ON DELETE CASCADE,

    -- Basic info
    name VARCHAR(255) NOT NULL,
    code VARCHAR(50),  -- Short code like "COL-123"

    -- Address
    address_line1 VARCHAR(255),
    address_line2 VARCHAR(255),
    city VARCHAR(100),
    state VARCHAR(100),
    postal_code VARCHAR(20),
    country VARCHAR(100) DEFAULT 'Australia',

    -- Geolocation
    latitude DECIMAL(10, 8),
    longitude DECIMAL(11, 8),

    -- Timezone
    timezone VARCHAR(50) DEFAULT 'Australia/Sydney',

    -- Contact
    primary_contact_name VARCHAR(255),
    primary_contact_phone VARCHAR(50),
    primary_contact_email VARCHAR(255),
    emergency_contact_name VARCHAR(255),
    emergency_contact_phone VARCHAR(50),

    -- Access
    access_instructions TEXT,
    access_codes JSONB DEFAULT '{}',  -- Encrypted in application

    -- Building info
    building_type VARCHAR(100),  -- 'commercial', 'residential', 'mixed', 'industrial'
    floors_count INTEGER,
    year_built INTEGER,
    total_area_sqm DECIMAL(12, 2),

    -- Health score (computed)
    health_score INTEGER,  -- 0-100
    health_score_updated_at TIMESTAMPTZ,

    -- Metadata
    metadata JSONB DEFAULT '{}',
    created_at TIMESTAMPTZ DEFAULT NOW(),
    updated_at TIMESTAMPTZ DEFAULT NOW(),
    deleted_at TIMESTAMPTZ
);

CREATE INDEX idx_sites_org ON sites(organization_id);
CREATE INDEX idx_sites_code ON sites(organization_id, code);
CREATE INDEX idx_sites_location ON sites USING GIST (
    point(longitude, latitude)
) WHERE latitude IS NOT NULL;
```

### Elevators (Assets)

```sql
-- ELEVATOR STATUS ENUM
CREATE TYPE elevator_status AS ENUM (
    'operational',      -- Running normally
    'degraded',         -- Running with issues
    'out_of_service',   -- Not running
    'maintenance',      -- Scheduled maintenance
    'decommissioned'    -- No longer in use
);

-- ELEVATORS (Assets)
CREATE TABLE elevators (
    id UUID PRIMARY KEY DEFAULT gen_random_uuid(),
    organization_id UUID NOT NULL REFERENCES organizations(id) ON DELETE CASCADE,
    site_id UUID NOT NULL REFERENCES sites(id) ON DELETE CASCADE,

    -- Identification
    unit_number VARCHAR(50) NOT NULL,  -- "Lift 1", "L1", etc.
    serial_number VARCHAR(100),
    registration_number VARCHAR(100),  -- Government registration
    asset_tag VARCHAR(100),  -- Internal asset tag

    -- Equipment details
    manufacturer VARCHAR(100),  -- KONE, Otis, Schindler, etc.
    model VARCHAR(100),
    controller_type VARCHAR(100),
    drive_type VARCHAR(100),  -- 'gearless', 'geared', 'hydraulic', 'MRL'
    machine_type VARCHAR(100),

    -- Specifications
    capacity_kg INTEGER,
    capacity_persons INTEGER,
    speed_mps DECIMAL(4, 2),  -- Meters per second
    floors_served INTEGER,
    stops INTEGER,
    travel_height_m DECIMAL(6, 2),
    door_type VARCHAR(50),  -- 'center_opening', 'side_opening', 'freight'
    door_width_mm INTEGER,
    car_dimensions JSONB,  -- {"width": 1100, "depth": 1400, "height": 2200}

    -- Dates
    installation_date DATE,
    modernization_date DATE,
    last_major_service DATE,

    -- Status
    status elevator_status DEFAULT 'operational',
    status_changed_at TIMESTAMPTZ DEFAULT NOW(),
    status_reason TEXT,

    -- Compliance
    last_inspection_date DATE,
    last_inspection_result VARCHAR(50),  -- 'passed', 'failed', 'conditional'
    next_inspection_due DATE,
    inspection_certificate_number VARCHAR(100),

    -- Health (computed)
    health_score INTEGER,  -- 0-100
    health_score_updated_at TIMESTAMPTZ,

    -- AI/Knowledge links
    v2_document_ids INTEGER[],  -- Links to V2 extracted manuals
    known_quirks TEXT[],  -- AI-learned equipment-specific notes

    -- Specifications (flexible)
    specifications JSONB DEFAULT '{}',
    -- {
    --   "rope_count": 6,
    --   "rope_diameter_mm": 10,
    --   "buffer_type": "spring",
    --   "governor_type": "centrifugal",
    --   ...
    -- }

    -- Metadata
    metadata JSONB DEFAULT '{}',
    created_at TIMESTAMPTZ DEFAULT NOW(),
    updated_at TIMESTAMPTZ DEFAULT NOW(),
    deleted_at TIMESTAMPTZ,

    UNIQUE(organization_id, site_id, unit_number)
);

CREATE INDEX idx_elevators_org ON elevators(organization_id);
CREATE INDEX idx_elevators_site ON elevators(site_id);
CREATE INDEX idx_elevators_manufacturer ON elevators(manufacturer);
CREATE INDEX idx_elevators_status ON elevators(status);
CREATE INDEX idx_elevators_inspection ON elevators(next_inspection_due);
```

### Contractors

```sql
-- CONTRACTORS
CREATE TABLE contractors (
    id UUID PRIMARY KEY DEFAULT gen_random_uuid(),
    organization_id UUID NOT NULL REFERENCES organizations(id) ON DELETE CASCADE,

    -- Type
    contractor_type VARCHAR(50) NOT NULL,
    -- 'employee', 'subcontractor', 'vendor', 'company'

    -- Company info (if company)
    company_name VARCHAR(255),
    company_abn VARCHAR(20),  -- Australian Business Number
    company_license VARCHAR(100),

    -- Individual info
    contact_name VARCHAR(255) NOT NULL,
    email VARCHAR(255),
    phone VARCHAR(50),

    -- Address
    address_line1 VARCHAR(255),
    city VARCHAR(100),
    state VARCHAR(100),
    postal_code VARCHAR(20),

    -- Professional
    license_number VARCHAR(100),
    license_expiry DATE,
    insurance_policy VARCHAR(100),
    insurance_expiry DATE,

    -- Specializations
    specializations TEXT[],  -- ['KONE', 'Otis', 'hydraulic', 'modernization']
    trade_types TEXT[],  -- ['lifts', 'escalators', 'HVAC']

    -- Rates
    hourly_rate DECIMAL(10, 2),
    callout_fee DECIMAL(10, 2),
    emergency_rate_multiplier DECIMAL(3, 2) DEFAULT 1.5,

    -- Status
    is_active BOOLEAN DEFAULT true,
    is_preferred BOOLEAN DEFAULT false,

    -- Performance (computed)
    rating DECIMAL(3, 2),  -- 0.00-5.00
    total_jobs_completed INTEGER DEFAULT 0,
    first_time_fix_rate DECIMAL(5, 2),  -- Percentage
    average_response_time_minutes INTEGER,

    -- SiteSync profile link
    technician_profile_id UUID,  -- Links to profiles table

    -- Metadata
    metadata JSONB DEFAULT '{}',
    created_at TIMESTAMPTZ DEFAULT NOW(),
    updated_at TIMESTAMPTZ DEFAULT NOW(),
    deleted_at TIMESTAMPTZ
);

CREATE INDEX idx_contractors_org ON contractors(organization_id);
CREATE INDEX idx_contractors_active ON contractors(is_active) WHERE is_active = true;
CREATE INDEX idx_contractors_specializations ON contractors USING GIN(specializations);
```

### Work Orders

```sql
-- ENUMS
CREATE TYPE work_order_status AS ENUM (
    'draft',        -- Created but not submitted
    'pending',      -- Submitted, awaiting assignment
    'scheduled',    -- Assigned and scheduled
    'in_progress',  -- Work started
    'on_hold',      -- Paused
    'completed',    -- Work finished
    'cancelled',    -- Cancelled
    'invoiced'      -- Invoiced/closed
);

CREATE TYPE work_order_priority AS ENUM (
    'emergency',    -- Immediate response required
    'high',         -- Same day
    'medium',       -- Within 48 hours
    'low',          -- Within week
    'scheduled'     -- Planned maintenance
);

CREATE TYPE work_order_type AS ENUM (
    'breakdown',      -- Equipment failure
    'preventive',     -- Scheduled maintenance
    'inspection',     -- Safety inspection
    'installation',   -- New installation
    'modernization',  -- Upgrade project
    'callback',       -- Return visit
    'audit'           -- Compliance audit
);

-- WORK ORDERS
CREATE TABLE work_orders (
    id UUID PRIMARY KEY DEFAULT gen_random_uuid(),
    organization_id UUID NOT NULL REFERENCES organizations(id) ON DELETE CASCADE,
    elevator_id UUID NOT NULL REFERENCES elevators(id),
    site_id UUID NOT NULL REFERENCES sites(id),

    -- Identification
    work_order_number VARCHAR(50) NOT NULL,  -- WO-2024-001234

    -- Classification
    type work_order_type NOT NULL,
    priority work_order_priority DEFAULT 'medium',
    status work_order_status DEFAULT 'draft',

    -- Description
    title VARCHAR(255) NOT NULL,
    description TEXT,

    -- Fault information
    fault_code VARCHAR(50),
    reported_symptoms TEXT[],
    affected_floors INTEGER[],

    -- Timing
    reported_at TIMESTAMPTZ DEFAULT NOW(),
    scheduled_start TIMESTAMPTZ,
    scheduled_end TIMESTAMPTZ,
    actual_start TIMESTAMPTZ,
    actual_end TIMESTAMPTZ,
    due_date TIMESTAMPTZ,

    -- Assignment
    assigned_contractor_id UUID REFERENCES contractors(id),
    assigned_at TIMESTAMPTZ,
    assigned_by UUID REFERENCES users(id),

    -- Reporter
    reported_by_name VARCHAR(255),
    reported_by_phone VARCHAR(50),
    reported_by_email VARCHAR(255),
    reporter_user_id UUID REFERENCES users(id),

    -- AI Diagnosis
    ai_diagnosis_id UUID,
    ai_suggested_causes TEXT[],
    ai_suggested_parts TEXT[],
    ai_confidence DECIMAL(3, 2),
    ai_diagnosis_at TIMESTAMPTZ,

    -- Resolution
    resolution_notes TEXT,
    root_cause TEXT,
    resolution_type VARCHAR(50),
    -- 'repaired', 'replaced', 'adjusted', 'cleaned', 'no_fault_found'

    -- Parts & Labor (summary, detail in related tables)
    parts_cost DECIMAL(10, 2) DEFAULT 0,
    labor_cost DECIMAL(10, 2) DEFAULT 0,
    total_cost DECIMAL(10, 2) DEFAULT 0,

    -- Follow-up
    requires_followup BOOLEAN DEFAULT false,
    followup_notes TEXT,
    parent_work_order_id UUID REFERENCES work_orders(id),

    -- Custom fields (per-org configuration)
    custom_fields JSONB DEFAULT '{}',

    -- Metadata
    created_by UUID NOT NULL REFERENCES users(id),
    created_at TIMESTAMPTZ DEFAULT NOW(),
    updated_at TIMESTAMPTZ DEFAULT NOW(),
    completed_at TIMESTAMPTZ,

    UNIQUE(organization_id, work_order_number)
);

CREATE INDEX idx_work_orders_org ON work_orders(organization_id);
CREATE INDEX idx_work_orders_elevator ON work_orders(elevator_id);
CREATE INDEX idx_work_orders_site ON work_orders(site_id);
CREATE INDEX idx_work_orders_status ON work_orders(status);
CREATE INDEX idx_work_orders_priority ON work_orders(priority);
CREATE INDEX idx_work_orders_contractor ON work_orders(assigned_contractor_id);
CREATE INDEX idx_work_orders_dates ON work_orders(scheduled_start, due_date);
CREATE INDEX idx_work_orders_number ON work_orders(work_order_number);
```

### Work Order Tasks

```sql
-- WORK ORDER TASKS
CREATE TABLE work_order_tasks (
    id UUID PRIMARY KEY DEFAULT gen_random_uuid(),
    work_order_id UUID NOT NULL REFERENCES work_orders(id) ON DELETE CASCADE,

    -- Task details
    sequence INTEGER NOT NULL,  -- Order of tasks
    title VARCHAR(255) NOT NULL,
    description TEXT,

    -- Status
    status VARCHAR(50) DEFAULT 'pending',
    -- 'pending', 'in_progress', 'completed', 'skipped'
    completed_at TIMESTAMPTZ,
    completed_by UUID REFERENCES users(id),

    -- Notes
    completion_notes TEXT,

    -- Metadata
    created_at TIMESTAMPTZ DEFAULT NOW(),
    updated_at TIMESTAMPTZ DEFAULT NOW()
);

CREATE INDEX idx_wo_tasks_work_order ON work_order_tasks(work_order_id);
```

### Parts Used

```sql
-- PARTS USED ON WORK ORDERS
CREATE TABLE work_order_parts (
    id UUID PRIMARY KEY DEFAULT gen_random_uuid(),
    work_order_id UUID NOT NULL REFERENCES work_orders(id) ON DELETE CASCADE,
    inventory_item_id UUID REFERENCES inventory_items(id),

    -- Part details (can be manual entry or from inventory)
    part_number VARCHAR(100),
    part_name VARCHAR(255) NOT NULL,
    manufacturer VARCHAR(100),

    -- Quantity & pricing
    quantity INTEGER NOT NULL DEFAULT 1,
    unit_cost DECIMAL(10, 2),
    total_cost DECIMAL(10, 2),

    -- Source
    source VARCHAR(50),  -- 'inventory', 'purchased', 'customer_supplied'

    -- Metadata
    created_at TIMESTAMPTZ DEFAULT NOW(),
    notes TEXT
);

CREATE INDEX idx_wo_parts_work_order ON work_order_parts(work_order_id);
```

### Labor Entries

```sql
-- LABOR ENTRIES
CREATE TABLE work_order_labor (
    id UUID PRIMARY KEY DEFAULT gen_random_uuid(),
    work_order_id UUID NOT NULL REFERENCES work_orders(id) ON DELETE CASCADE,
    contractor_id UUID REFERENCES contractors(id),

    -- Time
    start_time TIMESTAMPTZ NOT NULL,
    end_time TIMESTAMPTZ,
    duration_minutes INTEGER,

    -- Rate
    labor_type VARCHAR(50) DEFAULT 'regular',
    -- 'regular', 'overtime', 'emergency', 'travel'
    hourly_rate DECIMAL(10, 2),
    total_cost DECIMAL(10, 2),

    -- Notes
    description TEXT,

    -- Metadata
    created_at TIMESTAMPTZ DEFAULT NOW()
);

CREATE INDEX idx_wo_labor_work_order ON work_order_labor(work_order_id);
CREATE INDEX idx_wo_labor_contractor ON work_order_labor(contractor_id);
```

---

## Inventory & Marketplace

### Inventory Items

```sql
-- INVENTORY ITEMS (Master catalog)
CREATE TABLE inventory_items (
    id UUID PRIMARY KEY DEFAULT gen_random_uuid(),
    organization_id UUID NOT NULL REFERENCES organizations(id) ON DELETE CASCADE,

    -- Identification
    part_number VARCHAR(100) NOT NULL,
    name VARCHAR(255) NOT NULL,
    description TEXT,

    -- Classification
    category VARCHAR(100),  -- 'door_parts', 'drive_parts', 'safety', etc.
    subcategory VARCHAR(100),

    -- Manufacturer
    manufacturer VARCHAR(100),
    manufacturer_part_number VARCHAR(100),

    -- Compatibility
    compatible_manufacturers TEXT[],  -- ['KONE', 'Otis']
    compatible_models TEXT[],

    -- Pricing
    unit_cost DECIMAL(10, 2),
    sale_price DECIMAL(10, 2),

    -- Stock management
    minimum_stock INTEGER DEFAULT 0,
    reorder_point INTEGER DEFAULT 0,
    reorder_quantity INTEGER DEFAULT 1,

    -- Totals (computed from stock_locations)
    total_on_hand INTEGER DEFAULT 0,
    total_reserved INTEGER DEFAULT 0,
    total_available INTEGER DEFAULT 0,

    -- Metadata
    specifications JSONB DEFAULT '{}',
    created_at TIMESTAMPTZ DEFAULT NOW(),
    updated_at TIMESTAMPTZ DEFAULT NOW(),

    UNIQUE(organization_id, part_number)
);

CREATE INDEX idx_inventory_org ON inventory_items(organization_id);
CREATE INDEX idx_inventory_part_number ON inventory_items(part_number);
CREATE INDEX idx_inventory_category ON inventory_items(category);
CREATE INDEX idx_inventory_manufacturer ON inventory_items(manufacturer);
CREATE INDEX idx_inventory_compatible ON inventory_items USING GIN(compatible_manufacturers);
```

### Stock Locations (Van Stock)

```sql
-- STOCK LOCATIONS
CREATE TABLE stock_locations (
    id UUID PRIMARY KEY DEFAULT gen_random_uuid(),
    organization_id UUID NOT NULL REFERENCES organizations(id) ON DELETE CASCADE,
    inventory_item_id UUID NOT NULL REFERENCES inventory_items(id) ON DELETE CASCADE,

    -- Location
    location_type VARCHAR(50) NOT NULL,
    -- 'warehouse', 'van', 'site', 'consignment'
    location_name VARCHAR(255) NOT NULL,

    -- If van stock, link to contractor
    contractor_id UUID REFERENCES contractors(id),

    -- If site stock, link to site
    site_id UUID REFERENCES sites(id),

    -- Quantity
    quantity_on_hand INTEGER NOT NULL DEFAULT 0,
    quantity_reserved INTEGER DEFAULT 0,
    quantity_available INTEGER GENERATED ALWAYS AS (quantity_on_hand - quantity_reserved) STORED,

    -- Reorder settings for this location
    minimum_stock INTEGER DEFAULT 0,
    reorder_point INTEGER DEFAULT 0,

    -- Metadata
    last_count_date DATE,
    last_count_quantity INTEGER,
    created_at TIMESTAMPTZ DEFAULT NOW(),
    updated_at TIMESTAMPTZ DEFAULT NOW(),

    UNIQUE(organization_id, inventory_item_id, location_type, COALESCE(contractor_id::text, site_id::text, location_name))
);

CREATE INDEX idx_stock_org ON stock_locations(organization_id);
CREATE INDEX idx_stock_item ON stock_locations(inventory_item_id);
CREATE INDEX idx_stock_contractor ON stock_locations(contractor_id);
CREATE INDEX idx_stock_location_type ON stock_locations(location_type);
```

### Marketplace Listings

```sql
-- MARKETPLACE LISTINGS
CREATE TABLE marketplace_listings (
    id UUID PRIMARY KEY DEFAULT gen_random_uuid(),

    -- Seller
    seller_organization_id UUID NOT NULL REFERENCES organizations(id),
    seller_contractor_id UUID REFERENCES contractors(id),

    -- Item
    part_number VARCHAR(100) NOT NULL,
    part_name VARCHAR(255) NOT NULL,
    manufacturer VARCHAR(100),
    condition VARCHAR(50) NOT NULL,  -- 'new', 'refurbished', 'used_tested', 'used_untested'
    description TEXT,

    -- Quantity & pricing
    quantity_available INTEGER NOT NULL,
    unit_price DECIMAL(10, 2) NOT NULL,

    -- Location
    location_city VARCHAR(100),
    location_state VARCHAR(100),
    location_country VARCHAR(100) DEFAULT 'Australia',

    -- Shipping
    shipping_available BOOLEAN DEFAULT true,
    shipping_cost DECIMAL(10, 2),
    local_pickup BOOLEAN DEFAULT true,

    -- Status
    status VARCHAR(50) DEFAULT 'active',
    -- 'active', 'sold', 'reserved', 'expired', 'withdrawn'

    -- Metadata
    images TEXT[],
    created_at TIMESTAMPTZ DEFAULT NOW(),
    updated_at TIMESTAMPTZ DEFAULT NOW(),
    expires_at TIMESTAMPTZ
);

CREATE INDEX idx_marketplace_part ON marketplace_listings(part_number);
CREATE INDEX idx_marketplace_manufacturer ON marketplace_listings(manufacturer);
CREATE INDEX idx_marketplace_status ON marketplace_listings(status) WHERE status = 'active';
CREATE INDEX idx_marketplace_location ON marketplace_listings(location_city, location_state);
```

---

## Technician Profiles

```sql
-- TECHNICIAN PROFILES (Platform-wide, not org-specific)
CREATE TABLE technician_profiles (
    id UUID PRIMARY KEY DEFAULT gen_random_uuid(),

    -- Account
    user_id UUID UNIQUE,  -- Optional link to user account
    email VARCHAR(255) UNIQUE NOT NULL,

    -- Profile
    first_name VARCHAR(100) NOT NULL,
    last_name VARCHAR(100) NOT NULL,
    display_name VARCHAR(255),
    avatar_url VARCHAR(500),
    bio TEXT,

    -- Location
    city VARCHAR(100),
    state VARCHAR(100),
    country VARCHAR(100) DEFAULT 'Australia',

    -- Visibility
    profile_visibility VARCHAR(50) DEFAULT 'public',
    -- 'public', 'employers_only', 'connections_only', 'private'
    open_to_opportunities BOOLEAN DEFAULT false,

    -- Experience
    years_experience INTEGER,
    primary_trade VARCHAR(100),
    specializations TEXT[],

    -- Stats (computed/updated by triggers)
    expertise_score INTEGER DEFAULT 0,  -- 0-100
    total_jobs_completed INTEGER DEFAULT 0,
    first_time_fix_rate DECIMAL(5, 2),
    contributions_count INTEGER DEFAULT 0,
    technicians_helped INTEGER DEFAULT 0,
    endorsements_count INTEGER DEFAULT 0,

    -- Percentile (computed)
    expertise_percentile INTEGER,  -- Top X%

    -- Badges (array of badge IDs)
    badges TEXT[],

    -- Metadata
    created_at TIMESTAMPTZ DEFAULT NOW(),
    updated_at TIMESTAMPTZ DEFAULT NOW(),
    last_active_at TIMESTAMPTZ
);

CREATE INDEX idx_profiles_email ON technician_profiles(email);
CREATE INDEX idx_profiles_expertise ON technician_profiles(expertise_score DESC);
CREATE INDEX idx_profiles_location ON technician_profiles(city, state);
CREATE INDEX idx_profiles_specializations ON technician_profiles USING GIN(specializations);
CREATE INDEX idx_profiles_open ON technician_profiles(open_to_opportunities) WHERE open_to_opportunities = true;
```

### Profile Certifications

```sql
-- PROFILE CERTIFICATIONS
CREATE TABLE profile_certifications (
    id UUID PRIMARY KEY DEFAULT gen_random_uuid(),
    profile_id UUID NOT NULL REFERENCES technician_profiles(id) ON DELETE CASCADE,

    -- Certification
    name VARCHAR(255) NOT NULL,
    issuing_authority VARCHAR(255),
    certificate_number VARCHAR(100),

    -- Dates
    issued_date DATE,
    expiry_date DATE,

    -- Verification
    is_verified BOOLEAN DEFAULT false,
    verified_at TIMESTAMPTZ,
    verification_method VARCHAR(50),

    -- Evidence
    document_url VARCHAR(500),

    -- Metadata
    created_at TIMESTAMPTZ DEFAULT NOW()
);

CREATE INDEX idx_certs_profile ON profile_certifications(profile_id);
CREATE INDEX idx_certs_expiry ON profile_certifications(expiry_date);
```

### Knowledge Contributions

```sql
-- KNOWLEDGE CONTRIBUTIONS
CREATE TABLE knowledge_contributions (
    id UUID PRIMARY KEY DEFAULT gen_random_uuid(),
    profile_id UUID NOT NULL REFERENCES technician_profiles(id),

    -- Content
    title VARCHAR(255) NOT NULL,
    content TEXT NOT NULL,
    contribution_type VARCHAR(50) NOT NULL,
    -- 'solution', 'tip', 'procedure', 'equipment_note', 'safety_note'

    -- Context
    equipment_manufacturer VARCHAR(100),
    equipment_model VARCHAR(100),
    fault_code VARCHAR(50),
    tags TEXT[],

    -- Attribution
    attribution_type VARCHAR(50) DEFAULT 'full',
    -- 'full', 'company', 'anonymous'

    -- Status
    status VARCHAR(50) DEFAULT 'pending',
    -- 'pending', 'approved', 'rejected'
    reviewed_at TIMESTAMPTZ,
    reviewed_by UUID,

    -- Impact (updated by triggers)
    times_used INTEGER DEFAULT 0,
    technicians_helped INTEGER DEFAULT 0,
    estimated_hours_saved DECIMAL(10, 2) DEFAULT 0,

    -- Ratings
    upvotes INTEGER DEFAULT 0,
    downvotes INTEGER DEFAULT 0,

    -- Metadata
    created_at TIMESTAMPTZ DEFAULT NOW(),
    updated_at TIMESTAMPTZ DEFAULT NOW()
);

CREATE INDEX idx_contributions_profile ON knowledge_contributions(profile_id);
CREATE INDEX idx_contributions_equipment ON knowledge_contributions(equipment_manufacturer, equipment_model);
CREATE INDEX idx_contributions_fault ON knowledge_contributions(fault_code);
CREATE INDEX idx_contributions_status ON knowledge_contributions(status);
CREATE INDEX idx_contributions_tags ON knowledge_contributions USING GIN(tags);
```

---

## Audit Trail

```sql
-- AUDIT EVENT TYPES
CREATE TYPE audit_event_type AS ENUM (
    -- Work orders
    'work_order_created',
    'work_order_updated',
    'work_order_assigned',
    'work_order_started',
    'work_order_completed',
    'work_order_cancelled',

    -- Assets
    'elevator_created',
    'elevator_updated',
    'elevator_status_changed',

    -- Inspections
    'inspection_scheduled',
    'inspection_completed',
    'inspection_failed',

    -- Inventory
    'part_used',
    'stock_adjusted',
    'stock_transferred',

    -- Labor
    'labor_logged',

    -- AI
    'diagnosis_requested',
    'diagnosis_completed',

    -- Documents
    'document_uploaded',
    'document_linked',

    -- User actions
    'user_login',
    'user_action',
    'settings_changed'
);

-- AUDIT EVENTS (Immutable, partitioned)
CREATE TABLE audit_events (
    id UUID PRIMARY KEY DEFAULT gen_random_uuid(),
    organization_id UUID NOT NULL REFERENCES organizations(id),

    -- Event classification
    event_type audit_event_type NOT NULL,

    -- What was affected
    entity_type VARCHAR(50) NOT NULL,  -- 'work_order', 'elevator', etc.
    entity_id UUID NOT NULL,

    -- Who did it
    actor_id UUID NOT NULL,
    actor_type VARCHAR(50) DEFAULT 'user',  -- 'user', 'system', 'api'
    actor_email VARCHAR(255),

    -- What happened
    event_data JSONB NOT NULL,
    previous_state JSONB,
    new_state JSONB,

    -- Context
    ip_address INET,
    user_agent TEXT,
    request_id VARCHAR(100),

    -- Chain integrity
    previous_hash VARCHAR(64),
    hash VARCHAR(64) NOT NULL,  -- SHA-256

    -- Timestamp (used for partitioning)
    created_at TIMESTAMPTZ DEFAULT NOW()
) PARTITION BY RANGE (created_at);

-- Create partitions (monthly)
CREATE TABLE audit_events_2024_12 PARTITION OF audit_events
    FOR VALUES FROM ('2024-12-01') TO ('2025-01-01');

CREATE TABLE audit_events_2025_01 PARTITION OF audit_events
    FOR VALUES FROM ('2025-01-01') TO ('2025-02-01');

-- Add more partitions as needed

-- Indexes
CREATE INDEX idx_audit_org ON audit_events(organization_id);
CREATE INDEX idx_audit_entity ON audit_events(entity_type, entity_id);
CREATE INDEX idx_audit_actor ON audit_events(actor_id);
CREATE INDEX idx_audit_type ON audit_events(event_type);
CREATE INDEX idx_audit_created ON audit_events(created_at);
```

---

## Row-Level Security

### RLS Implementation

```sql
-- Enable RLS on all tenant-scoped tables
ALTER TABLE sites ENABLE ROW LEVEL SECURITY;
ALTER TABLE elevators ENABLE ROW LEVEL SECURITY;
ALTER TABLE contractors ENABLE ROW LEVEL SECURITY;
ALTER TABLE work_orders ENABLE ROW LEVEL SECURITY;
ALTER TABLE work_order_tasks ENABLE ROW LEVEL SECURITY;
ALTER TABLE work_order_parts ENABLE ROW LEVEL SECURITY;
ALTER TABLE work_order_labor ENABLE ROW LEVEL SECURITY;
ALTER TABLE inventory_items ENABLE ROW LEVEL SECURITY;
ALTER TABLE stock_locations ENABLE ROW LEVEL SECURITY;
ALTER TABLE users ENABLE ROW LEVEL SECURITY;
ALTER TABLE audit_events ENABLE ROW LEVEL SECURITY;

-- Create policies (organization isolation)
CREATE POLICY org_isolation_sites ON sites
    USING (organization_id = current_setting('app.current_org')::uuid);

CREATE POLICY org_isolation_elevators ON elevators
    USING (organization_id = current_setting('app.current_org')::uuid);

CREATE POLICY org_isolation_contractors ON contractors
    USING (organization_id = current_setting('app.current_org')::uuid);

CREATE POLICY org_isolation_work_orders ON work_orders
    USING (organization_id = current_setting('app.current_org')::uuid);

CREATE POLICY org_isolation_work_order_tasks ON work_order_tasks
    USING (work_order_id IN (
        SELECT id FROM work_orders
        WHERE organization_id = current_setting('app.current_org')::uuid
    ));

CREATE POLICY org_isolation_inventory ON inventory_items
    USING (organization_id = current_setting('app.current_org')::uuid);

CREATE POLICY org_isolation_users ON users
    USING (organization_id = current_setting('app.current_org')::uuid);

CREATE POLICY org_isolation_audit ON audit_events
    USING (organization_id = current_setting('app.current_org')::uuid);

-- Bypass policy for service account (migrations, admin)
CREATE ROLE sitesync_service BYPASSRLS;
```

### Setting Tenant Context

```python
# In application code, always set context before queries

async def set_tenant_context(
    session: AsyncSession,
    organization_id: UUID
) -> None:
    """Set RLS context for multi-tenant isolation."""
    await session.execute(
        text(f"SET app.current_org = '{organization_id}'")
    )

# Usage in FastAPI dependency
async def get_db_with_tenant(
    user: User = Depends(get_current_user),
    session: AsyncSession = Depends(get_session),
):
    await set_tenant_context(session, user.organization_id)
    yield session
```

---

## Pydantic Models

### Core Models

```python
# sitesync_v3/domains/assets/models.py

from datetime import date, datetime
from decimal import Decimal
from enum import Enum
from uuid import UUID
from pydantic import BaseModel, Field, ConfigDict

class ElevatorStatus(str, Enum):
    OPERATIONAL = "operational"
    DEGRADED = "degraded"
    OUT_OF_SERVICE = "out_of_service"
    MAINTENANCE = "maintenance"
    DECOMMISSIONED = "decommissioned"

class Elevator(BaseModel):
    """Elevator domain model."""

    model_config = ConfigDict(frozen=True)

    id: UUID
    organization_id: UUID
    site_id: UUID

    # Identification
    unit_number: str
    serial_number: str | None = None
    registration_number: str | None = None

    # Equipment
    manufacturer: str | None = None
    model: str | None = None
    controller_type: str | None = None
    drive_type: str | None = None

    # Specs
    capacity_kg: int | None = None
    speed_mps: Decimal | None = None
    floors_served: int | None = None

    # Dates
    installation_date: date | None = None

    # Status
    status: ElevatorStatus = ElevatorStatus.OPERATIONAL
    health_score: int | None = None

    # Compliance
    last_inspection_date: date | None = None
    next_inspection_due: date | None = None

    # AI links
    v2_document_ids: list[int] = Field(default_factory=list)
    known_quirks: list[str] = Field(default_factory=list)

    # Flexible
    specifications: dict = Field(default_factory=dict)
    metadata: dict = Field(default_factory=dict)

    # Timestamps
    created_at: datetime
    updated_at: datetime


class ElevatorCreate(BaseModel):
    """Create elevator request."""

    site_id: UUID
    unit_number: str
    serial_number: str | None = None
    registration_number: str | None = None
    manufacturer: str | None = None
    model: str | None = None
    controller_type: str | None = None
    drive_type: str | None = None
    capacity_kg: int | None = None
    speed_mps: Decimal | None = None
    floors_served: int | None = None
    installation_date: date | None = None
    specifications: dict = Field(default_factory=dict)


class ElevatorUpdate(BaseModel):
    """Update elevator request."""

    unit_number: str | None = None
    serial_number: str | None = None
    registration_number: str | None = None
    manufacturer: str | None = None
    model: str | None = None
    controller_type: str | None = None
    drive_type: str | None = None
    capacity_kg: int | None = None
    speed_mps: Decimal | None = None
    floors_served: int | None = None
    status: ElevatorStatus | None = None
    specifications: dict | None = None
```

### Work Order Models

```python
# sitesync_v3/domains/work_orders/models.py

class WorkOrderStatus(str, Enum):
    DRAFT = "draft"
    PENDING = "pending"
    SCHEDULED = "scheduled"
    IN_PROGRESS = "in_progress"
    ON_HOLD = "on_hold"
    COMPLETED = "completed"
    CANCELLED = "cancelled"
    INVOICED = "invoiced"

class WorkOrderPriority(str, Enum):
    EMERGENCY = "emergency"
    HIGH = "high"
    MEDIUM = "medium"
    LOW = "low"
    SCHEDULED = "scheduled"

class WorkOrderType(str, Enum):
    BREAKDOWN = "breakdown"
    PREVENTIVE = "preventive"
    INSPECTION = "inspection"
    INSTALLATION = "installation"
    MODERNIZATION = "modernization"
    CALLBACK = "callback"
    AUDIT = "audit"

class WorkOrder(BaseModel):
    """Work order domain model."""

    model_config = ConfigDict(frozen=True)

    id: UUID
    organization_id: UUID
    elevator_id: UUID
    site_id: UUID

    work_order_number: str
    type: WorkOrderType
    priority: WorkOrderPriority = WorkOrderPriority.MEDIUM
    status: WorkOrderStatus = WorkOrderStatus.DRAFT

    title: str
    description: str | None = None
    fault_code: str | None = None
    reported_symptoms: list[str] = Field(default_factory=list)

    reported_at: datetime
    scheduled_start: datetime | None = None
    scheduled_end: datetime | None = None
    actual_start: datetime | None = None
    actual_end: datetime | None = None

    assigned_contractor_id: UUID | None = None

    # AI
    ai_diagnosis_id: UUID | None = None
    ai_suggested_parts: list[str] = Field(default_factory=list)
    ai_confidence: Decimal | None = None

    # Resolution
    resolution_notes: str | None = None
    root_cause: str | None = None

    # Costs
    parts_cost: Decimal = Decimal("0")
    labor_cost: Decimal = Decimal("0")
    total_cost: Decimal = Decimal("0")

    custom_fields: dict = Field(default_factory=dict)

    created_by: UUID
    created_at: datetime
    updated_at: datetime
    completed_at: datetime | None = None
```

---

## Database Migrations

### Alembic Setup

```python
# alembic/env.py

from logging.config import fileConfig
from sqlalchemy import pool
from sqlalchemy.ext.asyncio import async_engine_from_config
from alembic import context

config = context.config
fileConfig(config.config_file_name)

target_metadata = None  # Import from models

def run_migrations_offline():
    """Run migrations in 'offline' mode."""
    url = config.get_main_option("sqlalchemy.url")
    context.configure(
        url=url,
        target_metadata=target_metadata,
        literal_binds=True,
        dialect_opts={"paramstyle": "named"},
    )
    with context.begin_transaction():
        context.run_migrations()

async def run_migrations_online():
    """Run migrations in 'online' mode."""
    connectable = async_engine_from_config(
        config.get_section(config.config_ini_section),
        prefix="sqlalchemy.",
        poolclass=pool.NullPool,
    )
    async with connectable.connect() as connection:
        await connection.run_sync(do_run_migrations)

def do_run_migrations(connection):
    context.configure(connection=connection, target_metadata=target_metadata)
    with context.begin_transaction():
        context.run_migrations()

if context.is_offline_mode():
    run_migrations_offline()
else:
    import asyncio
    asyncio.run(run_migrations_online())
```

---

## Next Steps

For implementation patterns using these models:
- [Triforce AI](../explanation/triforce-ai.md) - AI system integration
- [API Reference](api.md) - API endpoints
- [Implementation](implementation.md) - Code patterns

---

**[← Back to Architecture](architecture.md)** | **[Next: Triforce AI →](../explanation/triforce-ai.md)**


<!-- FILE: docs/reference/api.md -->

<!--
---
title: SiteSync V3 API Reference
description: REST API documentation with authentication, endpoints, and error handling
version: 3.0.0
last_updated: 2025-12
status: design
implementation_status: partial
audience: developer, ai_assistant
prerequisites:
  - Understanding of REST APIs
  - JWT authentication basics
related_docs:
  - /docs/reference/data-model.md (response schemas)
  - /docs/reference/enums.md (status values)
  - /docs/GLOSSARY.md (terminology)
---
-->

# SiteSync V3 - API Reference

## REST API Documentation

> This document provides the complete API reference for SiteSync V3, including authentication, endpoints, request/response formats, and error handling.

---

## Base URL

```
Production:  https://api.sitesync.com/v1
Staging:     https://api.staging.sitesync.com/v1
Development: http://localhost:8000/v1
```

---

## Authentication

### JWT Token Authentication

All API requests require authentication via JWT bearer token.

```
Authorization: Bearer <access_token>
```

### Authentication Endpoints

#### Login

```http
POST /auth/login
Content-Type: application/json

{
    "email": "user@example.com",
    "password": "secure_password"
}
```

**Response (200 OK):**
```json
{
    "access_token": "eyJhbGciOiJIUzI1NiIs...",
    "refresh_token": "eyJhbGciOiJIUzI1NiIs...",
    "token_type": "bearer",
    "expires_in": 900,
    "user": {
        "id": "550e8400-e29b-41d4-a716-446655440000",
        "email": "user@example.com",
        "first_name": "John",
        "last_name": "Smith",
        "organization_id": "550e8400-e29b-41d4-a716-446655440001",
        "role": "admin"
    }
}
```

#### Refresh Token

```http
POST /auth/refresh
Content-Type: application/json

{
    "refresh_token": "eyJhbGciOiJIUzI1NiIs..."
}
```

**Response (200 OK):**
```json
{
    "access_token": "eyJhbGciOiJIUzI1NiIs...",
    "expires_in": 900
}
```

#### Logout

```http
POST /auth/logout
Authorization: Bearer <access_token>
```

**Response (204 No Content)**

---

## API Conventions

### Request Format

- All request bodies use JSON (`Content-Type: application/json`)
- UUIDs are used for all resource identifiers
- Dates use ISO 8601 format (`YYYY-MM-DD`)
- Timestamps use ISO 8601 with timezone (`YYYY-MM-DDTHH:MM:SSZ`)

### Response Format

All responses follow this structure:

**Success Response:**
```json
{
    "data": { ... },
    "meta": {
        "request_id": "req_abc123",
        "timestamp": "2024-12-15T10:30:00Z"
    }
}
```

**List Response:**
```json
{
    "data": [ ... ],
    "meta": {
        "total": 100,
        "page": 1,
        "per_page": 20,
        "total_pages": 5
    }
}
```

**Error Response:**
```json
{
    "error": {
        "code": "VALIDATION_ERROR",
        "message": "Invalid input data",
        "details": [
            {
                "field": "email",
                "message": "Invalid email format"
            }
        ]
    },
    "meta": {
        "request_id": "req_abc123",
        "timestamp": "2024-12-15T10:30:00Z"
    }
}
```

### HTTP Status Codes

| Code | Meaning |
|------|---------|
| 200 | Success |
| 201 | Created |
| 204 | No Content |
| 400 | Bad Request |
| 401 | Unauthorized |
| 403 | Forbidden |
| 404 | Not Found |
| 409 | Conflict |
| 422 | Validation Error |
| 429 | Rate Limited |
| 500 | Server Error |

### Pagination

List endpoints support pagination:

```
GET /sites?page=1&per_page=20
```

### Filtering

List endpoints support filtering:

```
GET /work-orders?status=in_progress&priority=high
```

### Sorting

List endpoints support sorting:

```
GET /work-orders?sort=-created_at,priority
```

---

## Organizations

### Get Current Organization

```http
GET /organizations/me
Authorization: Bearer <token>
```

**Response:**
```json
{
    "data": {
        "id": "550e8400-e29b-41d4-a716-446655440001",
        "name": "Acme Building Management",
        "slug": "acme-bm",
        "subscription_tier": "pro",
        "settings": {
            "timezone": "Australia/Sydney",
            "currency": "AUD"
        },
        "created_at": "2024-01-15T00:00:00Z"
    }
}
```

### Update Organization Settings

```http
PATCH /organizations/me
Authorization: Bearer <token>
Content-Type: application/json

{
    "name": "Acme Building Management Pty Ltd",
    "settings": {
        "timezone": "Australia/Melbourne"
    }
}
```

---

## Sites

### List Sites

```http
GET /sites
Authorization: Bearer <token>
```

**Query Parameters:**
| Parameter | Type | Description |
|-----------|------|-------------|
| page | integer | Page number (default: 1) |
| per_page | integer | Items per page (default: 20, max: 100) |
| search | string | Search in name, address |
| city | string | Filter by city |

**Response:**
```json
{
    "data": [
        {
            "id": "550e8400-e29b-41d4-a716-446655440010",
            "name": "123 Collins Street",
            "code": "COL-123",
            "address_line1": "123 Collins Street",
            "city": "Melbourne",
            "state": "VIC",
            "postal_code": "3000",
            "health_score": 91,
            "elevator_count": 4,
            "open_work_orders": 1,
            "created_at": "2024-01-15T00:00:00Z"
        }
    ],
    "meta": {
        "total": 45,
        "page": 1,
        "per_page": 20,
        "total_pages": 3
    }
}
```

### Create Site

```http
POST /sites
Authorization: Bearer <token>
Content-Type: application/json

{
    "name": "456 Queen Street",
    "code": "QUE-456",
    "address_line1": "456 Queen Street",
    "city": "Brisbane",
    "state": "QLD",
    "postal_code": "4000",
    "timezone": "Australia/Brisbane",
    "primary_contact_name": "Jane Smith",
    "primary_contact_phone": "+61 7 1234 5678",
    "primary_contact_email": "jane@example.com"
}
```

**Response (201 Created):**
```json
{
    "data": {
        "id": "550e8400-e29b-41d4-a716-446655440011",
        "name": "456 Queen Street",
        ...
    }
}
```

### Get Site

```http
GET /sites/{site_id}
Authorization: Bearer <token>
```

### Update Site

```http
PATCH /sites/{site_id}
Authorization: Bearer <token>
Content-Type: application/json

{
    "primary_contact_name": "John Doe"
}
```

### Delete Site

```http
DELETE /sites/{site_id}
Authorization: Bearer <token>
```

**Response (204 No Content)**

### Get Site Health Score

```http
GET /sites/{site_id}/health
Authorization: Bearer <token>
```

**Response:**
```json
{
    "data": {
        "site_id": "550e8400-e29b-41d4-a716-446655440010",
        "health_score": 91,
        "breakdown": {
            "equipment_condition": 94,
            "maintenance_compliance": 88,
            "incident_frequency": 95,
            "first_time_fix_rate": 92,
            "predictive_risk": 87
        },
        "trend": "+7 from last month",
        "percentile": "Top 15% of similar buildings",
        "recommendations": [
            "Schedule HVAC filter replacement",
            "Lift 2 door operator showing wear"
        ],
        "calculated_at": "2024-12-15T00:00:00Z"
    }
}
```

---

## Elevators

### List Elevators

```http
GET /elevators
Authorization: Bearer <token>
```

**Query Parameters:**
| Parameter | Type | Description |
|-----------|------|-------------|
| site_id | uuid | Filter by site |
| manufacturer | string | Filter by manufacturer |
| status | string | Filter by status |
| search | string | Search in unit number, serial |

### Create Elevator

```http
POST /elevators
Authorization: Bearer <token>
Content-Type: application/json

{
    "site_id": "550e8400-e29b-41d4-a716-446655440010",
    "unit_number": "Lift 1",
    "serial_number": "KM-2015-78234",
    "registration_number": "EL-VIC-12345",
    "manufacturer": "KONE",
    "model": "MonoSpace 500",
    "controller_type": "KCM",
    "drive_type": "EcoDisc",
    "capacity_kg": 1000,
    "speed_mps": 1.6,
    "floors_served": 12,
    "installation_date": "2015-06-15"
}
```

### Get Elevator

```http
GET /elevators/{elevator_id}
Authorization: Bearer <token>
```

**Response:**
```json
{
    "data": {
        "id": "550e8400-e29b-41d4-a716-446655440020",
        "site_id": "550e8400-e29b-41d4-a716-446655440010",
        "unit_number": "Lift 1",
        "serial_number": "KM-2015-78234",
        "manufacturer": "KONE",
        "model": "MonoSpace 500",
        "status": "operational",
        "health_score": 92,
        "last_inspection_date": "2024-09-14",
        "next_inspection_due": "2025-09-14",
        "known_quirks": [
            "Humidity sensitive - F505 may be false alarm on humid days"
        ],
        "specifications": {
            "capacity_kg": 1000,
            "speed_mps": 1.6,
            "floors_served": 12
        },
        "site": {
            "id": "550e8400-e29b-41d4-a716-446655440010",
            "name": "123 Collins Street"
        }
    }
}
```

### Get Elevator History

```http
GET /elevators/{elevator_id}/history
Authorization: Bearer <token>
```

**Query Parameters:**
| Parameter | Type | Description |
|-----------|------|-------------|
| start_date | date | History start date |
| end_date | date | History end date |
| event_type | string | Filter by event type |

**Response:**
```json
{
    "data": [
        {
            "date": "2024-12-15T10:30:00Z",
            "event_type": "work_order_completed",
            "title": "Preventive maintenance",
            "description": "Routine service, all checks passed",
            "contractor": "Summit Elevator Services",
            "technician": "Maria S.",
            "work_order_id": "550e8400-e29b-41d4-a716-446655440030"
        },
        {
            "date": "2024-11-22T14:15:00Z",
            "event_type": "work_order_completed",
            "title": "Callback - Door hesitation",
            "description": "Adjusted door operator timing",
            "contractor": "Summit Elevator Services",
            "technician": "James T.",
            "parts_used": [],
            "resolution_time_minutes": 45
        }
    ],
    "meta": {
        "total": 112,
        "page": 1,
        "per_page": 20
    }
}
```

### Update Elevator Status

```http
PATCH /elevators/{elevator_id}/status
Authorization: Bearer <token>
Content-Type: application/json

{
    "status": "out_of_service",
    "reason": "Door fault - awaiting parts"
}
```

---

## Work Orders

### List Work Orders

```http
GET /work-orders
Authorization: Bearer <token>
```

**Query Parameters:**
| Parameter | Type | Description |
|-----------|------|-------------|
| site_id | uuid | Filter by site |
| elevator_id | uuid | Filter by elevator |
| status | string | Filter by status |
| priority | string | Filter by priority |
| type | string | Filter by type |
| contractor_id | uuid | Filter by assigned contractor |
| from_date | date | From reported date |
| to_date | date | To reported date |

### Create Work Order

```http
POST /work-orders
Authorization: Bearer <token>
Content-Type: application/json

{
    "elevator_id": "550e8400-e29b-41d4-a716-446655440020",
    "type": "breakdown",
    "priority": "high",
    "title": "Door not closing properly",
    "description": "Reported by tenant - door takes multiple attempts to close",
    "fault_code": "F505",
    "reported_symptoms": [
        "Door hesitates before closing",
        "Sometimes requires 2-3 attempts",
        "No unusual sounds"
    ],
    "reported_by_name": "John Tenant",
    "reported_by_phone": "+61 412 345 678"
}
```

**Response (201 Created):**
```json
{
    "data": {
        "id": "550e8400-e29b-41d4-a716-446655440030",
        "work_order_number": "WO-2024-001234",
        "elevator_id": "550e8400-e29b-41d4-a716-446655440020",
        "type": "breakdown",
        "priority": "high",
        "status": "pending",
        "title": "Door not closing properly",
        "ai_suggested_causes": [
            "Door zone sensor fault",
            "Door operator timing",
            "Obstruction in door track"
        ],
        "ai_confidence": 0.85,
        "created_at": "2024-12-15T10:30:00Z"
    }
}
```

### Get Work Order

```http
GET /work-orders/{work_order_id}
Authorization: Bearer <token>
```

### Update Work Order

```http
PATCH /work-orders/{work_order_id}
Authorization: Bearer <token>
Content-Type: application/json

{
    "priority": "medium",
    "description": "Updated: Issue is intermittent"
}
```

### Assign Work Order

```http
POST /work-orders/{work_order_id}/assign
Authorization: Bearer <token>
Content-Type: application/json

{
    "contractor_id": "550e8400-e29b-41d4-a716-446655440040",
    "scheduled_start": "2024-12-16T09:00:00Z",
    "scheduled_end": "2024-12-16T12:00:00Z"
}
```

### Start Work Order

```http
POST /work-orders/{work_order_id}/start
Authorization: Bearer <token>
```

### Complete Work Order

```http
POST /work-orders/{work_order_id}/complete
Authorization: Bearer <token>
Content-Type: application/json

{
    "resolution_notes": "Replaced door zone sensor. Tested operation - now functioning correctly.",
    "root_cause": "Door zone sensor failure due to age",
    "parts_used": [
        {
            "part_number": "KM-DZ-505",
            "part_name": "Door Zone Sensor",
            "quantity": 1,
            "unit_cost": 85.00
        }
    ],
    "labor_entries": [
        {
            "start_time": "2024-12-16T09:15:00Z",
            "end_time": "2024-12-16T10:45:00Z",
            "labor_type": "regular",
            "hourly_rate": 120.00
        }
    ],
    "requires_followup": false
}
```

---

## AI Diagnosis

### Request Diagnosis

```http
POST /diagnosis/request
Authorization: Bearer <token>
Content-Type: application/json

{
    "elevator_id": "550e8400-e29b-41d4-a716-446655440020",
    "fault_code": "F505",
    "symptoms": [
        "Door won't close",
        "Display shows F505",
        "Occurs intermittently"
    ],
    "additional_context": "Issue worse on humid days"
}
```

**Response:**
```json
{
    "data": {
        "id": "550e8400-e29b-41d4-a716-446655440050",
        "fault_code": "F505",
        "severity": "medium",
        "primary_cause": "Door zone sensor fault",
        "secondary_causes": [
            "Door operator timing misconfiguration",
            "Wiring connection loose"
        ],
        "diagnostic_steps": [
            "Check door zone sensor alignment",
            "Test sensor output with multimeter",
            "Inspect wiring connections at terminal block",
            "Check for moisture ingress in sensor housing"
        ],
        "recommended_actions": [
            "Replace door zone sensor (KM-DZ-505)",
            "Apply moisture sealant if housing compromised"
        ],
        "parts_needed": [
            {
                "part_number": "KM-DZ-505",
                "name": "Door Zone Sensor",
                "estimated_cost": 85.00
            }
        ],
        "estimated_repair_time_minutes": 90,
        "confidence": 0.87,
        "similar_cases": 847,
        "safety_notes": [
            "Ensure lift is on inspection mode before accessing shaft",
            "Lock out main power before sensor replacement"
        ],
        "sources": [
            "KONE MonoSpace Service Manual - Section 7.4",
            "Community: 847 similar cases resolved"
        ]
    }
}
```

### Get Diagnosis

```http
GET /diagnosis/{diagnosis_id}
Authorization: Bearer <token>
```

### Submit Diagnosis Feedback

```http
POST /diagnosis/{diagnosis_id}/feedback
Authorization: Bearer <token>
Content-Type: application/json

{
    "was_accurate": true,
    "actual_cause": "Door zone sensor fault - confirmed",
    "additional_notes": "Sensor housing seal was compromised"
}
```

---

## Contractors

### List Contractors

```http
GET /contractors
Authorization: Bearer <token>
```

### Create Contractor

```http
POST /contractors
Authorization: Bearer <token>
Content-Type: application/json

{
    "contractor_type": "subcontractor",
    "company_name": "Summit Elevator Services",
    "contact_name": "Mike Johnson",
    "email": "mike@summifelevator.com",
    "phone": "+61 2 9876 5432",
    "license_number": "EL-NSW-12345",
    "specializations": ["KONE", "Otis", "modernization"],
    "hourly_rate": 120.00
}
```

### Get Contractor Performance

```http
GET /contractors/{contractor_id}/performance
Authorization: Bearer <token>
```

**Response:**
```json
{
    "data": {
        "contractor_id": "550e8400-e29b-41d4-a716-446655440040",
        "period": "last_12_months",
        "total_jobs": 156,
        "first_time_fix_rate": 0.94,
        "average_response_time_minutes": 127,
        "average_resolution_time_minutes": 72,
        "callbacks": 9,
        "callback_rate": 0.058,
        "customer_satisfaction": 4.8,
        "comparison": {
            "vs_average_first_fix": "+8%",
            "vs_average_response": "-23%"
        }
    }
}
```

---

## Inventory

### List Inventory Items

```http
GET /inventory
Authorization: Bearer <token>
```

### Get Van Stock

```http
GET /inventory/van-stock
Authorization: Bearer <token>
```

**Query Parameters:**
| Parameter | Type | Description |
|-----------|------|-------------|
| contractor_id | uuid | Filter by contractor |
| below_minimum | boolean | Show only low stock items |

**Response:**
```json
{
    "data": [
        {
            "id": "550e8400-e29b-41d4-a716-446655440060",
            "part_number": "KM-DZ-505",
            "name": "Door Zone Sensor - KONE",
            "location": "Van - Mike J.",
            "quantity_on_hand": 2,
            "quantity_reserved": 0,
            "minimum_stock": 1,
            "status": "ok"
        },
        {
            "id": "550e8400-e29b-41d4-a716-446655440061",
            "part_number": "OT-ENC-01",
            "name": "Encoder Belt - Otis",
            "location": "Van - Mike J.",
            "quantity_on_hand": 0,
            "quantity_reserved": 0,
            "minimum_stock": 1,
            "status": "below_minimum"
        }
    ]
}
```

### Find Nearby Parts

```http
GET /inventory/nearby/{part_number}
Authorization: Bearer <token>
```

**Query Parameters:**
| Parameter | Type | Description |
|-----------|------|-------------|
| latitude | decimal | Current location |
| longitude | decimal | Current location |
| radius_km | integer | Search radius (default: 50) |

**Response:**
```json
{
    "data": [
        {
            "part_number": "KM-DZ-505",
            "location_type": "van",
            "holder_name": "Sarah M.",
            "holder_phone": "+61 412 345 678",
            "distance_km": 2.3,
            "quantity_available": 1,
            "can_share": true
        },
        {
            "part_number": "KM-DZ-505",
            "location_type": "warehouse",
            "holder_name": "Main Warehouse",
            "distance_km": 15.7,
            "quantity_available": 12,
            "can_share": true
        }
    ]
}
```

---

## Marketplace

### Search Listings

```http
GET /marketplace/listings
Authorization: Bearer <token>
```

**Query Parameters:**
| Parameter | Type | Description |
|-----------|------|-------------|
| part_number | string | Search by part number |
| manufacturer | string | Filter by manufacturer |
| condition | string | Filter by condition |
| max_price | decimal | Maximum price |
| city | string | Filter by city |

### Create Listing

```http
POST /marketplace/listings
Authorization: Bearer <token>
Content-Type: application/json

{
    "part_number": "KM-DZ-505",
    "part_name": "Door Zone Sensor - KONE",
    "manufacturer": "KONE",
    "condition": "new",
    "quantity_available": 2,
    "unit_price": 35.00,
    "description": "Ordered spare, project cancelled. Original packaging.",
    "location_city": "Sydney",
    "location_state": "NSW",
    "shipping_available": true,
    "shipping_cost": 15.00,
    "local_pickup": true
}
```

---

## Technician Profiles

### Get My Profile

```http
GET /profiles/me
Authorization: Bearer <token>
```

### Update My Profile

```http
PATCH /profiles/me
Authorization: Bearer <token>
Content-Type: application/json

{
    "bio": "15 years experience in elevator maintenance",
    "specializations": ["KONE", "Otis", "door systems"],
    "open_to_opportunities": true
}
```

### Search Profiles (Employers)

```http
GET /profiles/search
Authorization: Bearer <token>
```

**Query Parameters:**
| Parameter | Type | Description |
|-----------|------|-------------|
| specialization | string | Filter by specialization |
| city | string | Filter by city |
| min_score | integer | Minimum expertise score |
| open_to_opportunities | boolean | Only show available |

---

## Webhooks

### Configure Webhook

```http
POST /webhooks
Authorization: Bearer <token>
Content-Type: application/json

{
    "url": "https://your-server.com/webhook",
    "events": [
        "work_order.created",
        "work_order.completed",
        "elevator.status_changed"
    ],
    "secret": "your_webhook_secret"
}
```

### Webhook Payload Example

```json
{
    "event": "work_order.completed",
    "timestamp": "2024-12-15T10:30:00Z",
    "data": {
        "work_order_id": "550e8400-e29b-41d4-a716-446655440030",
        "work_order_number": "WO-2024-001234",
        "elevator_id": "550e8400-e29b-41d4-a716-446655440020",
        "status": "completed",
        "resolution_notes": "Replaced door sensor"
    }
}
```

---

## Rate Limiting

| Endpoint Type | Limit |
|---------------|-------|
| Authentication | 10 requests/minute |
| Standard API | 100 requests/minute |
| Search/List | 30 requests/minute |
| AI Diagnosis | 10 requests/minute |

Rate limit headers are included in responses:
```
X-RateLimit-Limit: 100
X-RateLimit-Remaining: 95
X-RateLimit-Reset: 1702636200
```

---

## Error Codes

| Code | Description |
|------|-------------|
| `AUTH_REQUIRED` | Authentication required |
| `AUTH_INVALID` | Invalid credentials |
| `AUTH_EXPIRED` | Token expired |
| `FORBIDDEN` | Insufficient permissions |
| `NOT_FOUND` | Resource not found |
| `VALIDATION_ERROR` | Invalid input data |
| `DUPLICATE` | Resource already exists |
| `RATE_LIMITED` | Too many requests |
| `SERVER_ERROR` | Internal server error |

---

**[← Back to Triforce AI](../explanation/triforce-ai.md)** | **[Next: Features →](features.md)**


<!-- FILE: docs/reference/enums.md -->

<!--
---
title: Enums & Constants Reference
description: All enumeration values and status codes used in SiteSync
version: 3.0.0
last_updated: 2025-12
status: stable
audience: developer, ai_assistant
related_docs:
  - /docs/reference/data-model.md (schema definitions)
  - /docs/reference/api.md (API usage)
---
-->

# Enums & Constants Reference

> All enumeration values used in SiteSync

## Overview

This reference lists all enum values used throughout the SiteSync platform. Use these values when working with the API or database.

---

## Trade Types

Equipment category classification.

```python
trade_types = [
    "lifts_escalators",
    "hvac",
    "electrical",
    "plumbing",
    "fire_systems",
    "security",
    "building_fabric",
    "generators",
    "bms",
    "solar_renewables",
    "pools_gyms",
    "parking",
]
```

| Value | Display Name | Description |
|-------|--------------|-------------|
| `lifts_escalators` | Lifts & Escalators | Vertical transportation |
| `hvac` | HVAC | Heating, ventilation, air conditioning |
| `electrical` | Electrical | Power distribution, lighting |
| `plumbing` | Plumbing | Water systems, drainage |
| `fire_systems` | Fire Systems | Detection, suppression, alarms |
| `security` | Security | Access control, CCTV |
| `building_fabric` | Building Fabric | Structural, roofing, facades |
| `generators` | Generators | Backup power systems |
| `bms` | BMS | Building management systems |
| `solar_renewables` | Solar & Renewables | Solar panels, batteries |
| `pools_gyms` | Pools & Gyms | Recreational facilities |
| `parking` | Parking | Parking systems, gates |

---

## Asset Status

Current operational state of equipment.

```python
asset_status = [
    "operational",
    "degraded",
    "out_of_service",
    "maintenance",
    "decommissioned",
]
```

| Value | Display Name | Meaning |
|-------|--------------|---------|
| `operational` | Operational | Running normally |
| `degraded` | Degraded | Running with known issues |
| `out_of_service` | Out of Service | Not running, needs repair |
| `maintenance` | Under Maintenance | Scheduled maintenance in progress |
| `decommissioned` | Decommissioned | No longer in use |

---

## Work Order Types

Classification of work to be done.

```python
work_order_types = [
    "breakdown",
    "preventive",
    "inspection",
    "installation",
    "callback",
    "modification",
    "consultation",
]
```

| Value | Display Name | Use For |
|-------|--------------|---------|
| `breakdown` | Breakdown | Equipment failure, fault |
| `preventive` | Preventive | Scheduled maintenance |
| `inspection` | Inspection | Safety/compliance inspection |
| `installation` | Installation | New equipment |
| `callback` | Callback | Return visit for prior issue |
| `modification` | Modification | Equipment changes/upgrades |
| `consultation` | Consultation | Assessment, quotes |

---

## Work Order Priority

Urgency and response expectation.

```python
work_order_priority = [
    "emergency",
    "high",
    "medium",
    "low",
    "scheduled",
]
```

| Value | Display Name | Expected Response | SLA |
|-------|--------------|-------------------|-----|
| `emergency` | Emergency | Immediate | 1-4 hours |
| `high` | High | Same day | 24 hours |
| `medium` | Medium | Prompt | 48 hours |
| `low` | Low | When convenient | 1 week |
| `scheduled` | Scheduled | Planned date | As scheduled |

---

## Work Order Status

Lifecycle state of a work order.

```python
work_order_status = [
    "draft",
    "pending",
    "scheduled",
    "in_progress",
    "on_hold",
    "completed",
    "cancelled",
    "invoiced",
]
```

| Value | Display Name | Meaning |
|-------|--------------|---------|
| `draft` | Draft | Created but not submitted |
| `pending` | Pending | Awaiting assignment |
| `scheduled` | Scheduled | Assigned with date/time |
| `in_progress` | In Progress | Technician actively working |
| `on_hold` | On Hold | Paused (parts, access, etc.) |
| `completed` | Completed | Work finished |
| `cancelled` | Cancelled | No longer needed |
| `invoiced` | Invoiced | Billing processed |

### Status Transitions

```
draft → pending → scheduled → in_progress → completed → invoiced
                     ↓              ↓
                  on_hold ←────────┘
                     ↓
                 cancelled
```

---

## Subscription Tiers

Organization subscription levels.

```python
subscription_tiers = [
    "free",
    "pro",
    "expert",
    "enterprise",
]
```

| Value | Display Name | Assets | Users |
|-------|--------------|--------|-------|
| `free` | Free | 5 | 2 |
| `pro` | Pro | 50 | 10 |
| `expert` | Expert | Unlimited | 50 |
| `enterprise` | Enterprise | Unlimited | Unlimited |

---

## User Roles

Permission levels within an organization.

```python
user_roles = [
    "owner",
    "admin",
    "manager",
    "technician",
    "viewer",
]
```

| Value | Display Name | Permissions |
|-------|--------------|-------------|
| `owner` | Owner | Full control, billing |
| `admin` | Admin | Full control, no billing |
| `manager` | Manager | Manage sites, work orders |
| `technician` | Technician | Complete assigned work |
| `viewer` | Viewer | Read-only access |

---

## Contractor Types

Service provider classification.

```python
contractor_types = [
    "company",
    "independent",
    "internal",
]
```

| Value | Display Name | Description |
|-------|--------------|-------------|
| `company` | Service Company | Multi-technician business |
| `independent` | Independent | Solo contractor |
| `internal` | Internal | In-house maintenance staff |

---

## Health Score Ranges

Computed equipment/building health.

| Range | Label | Color | Meaning |
|-------|-------|-------|---------|
| 90-100 | Excellent | Green | Top condition |
| 75-89 | Good | Light green | Minor issues |
| 60-74 | Fair | Yellow | Attention needed |
| 40-59 | Poor | Orange | Significant issues |
| 0-39 | Critical | Red | Urgent intervention |

---

## AI Confidence Levels

Diagnosis confidence thresholds.

| Range | Label | UI Behavior |
|-------|-------|-------------|
| 95-100% | Very confident | Single suggestion |
| 80-94% | Confident | Primary + alternatives |
| 60-79% | Moderate | Multiple options |
| 0-59% | Low | Request more info |

---

## Resolution Types

How a work order was resolved.

```python
resolution_types = [
    "fixed",
    "replaced",
    "adjusted",
    "cleaned",
    "no_fault_found",
    "referred",
    "deferred",
]
```

| Value | Display Name | Meaning |
|-------|--------------|---------|
| `fixed` | Fixed | Repaired the issue |
| `replaced` | Replaced | Component replacement |
| `adjusted` | Adjusted | Settings/alignment change |
| `cleaned` | Cleaned | Cleaning resolved issue |
| `no_fault_found` | No Fault Found | Could not reproduce |
| `referred` | Referred | Escalated to specialist |
| `deferred` | Deferred | Scheduled for later |

---

## Related

- [Data Model](data-model.md) — Full schema reference
- [API Reference](api.md) — Using enums in API calls
- [Quick Reference](quick-reference.md) — Common patterns

---

**[← Back to Reference](../README.md)**


<!-- FILE: docs/reference/architecture.md -->

# SiteSync V3 - Architecture

## Technical System Design

> This document provides the technical architecture overview for engineers working on SiteSync V3. It covers system design, technology choices, infrastructure, and the V2/V3 bridge pattern.

---

## Architecture Decision

### Import-Based Bridge (Option C)

SiteSync V3 uses an **Import-Based Bridge** architecture - the best balance of risk, speed, and flexibility.

```
ARCHITECTURE OVERVIEW
══════════════════════════════════════════════════════════════════

V3 CMMS (Clean Build)
├── PostgreSQL + pgvector (replaces SQLite + FAISS)
├── Native hybrid search (single SQL query)
└── domains/ (all NEW except diagnosis wrapper)

V2 (Library - imported)
├── adapters/gemini/ (LLM calls)
└── domains/diagnosis/ (fault analysis agents)

Extraction Service (SEPARATE)
├── Standalone Cloud Function or CLI
├── Gemini 2.0 structured extraction
└── Writes directly to V3 PostgreSQL

══════════════════════════════════════════════════════════════════

CODE SPLIT: 65% new code / 35% V2 reuse
```

### Why This Architecture

| Approach | Risk | Speed | Flexibility | Decision |
|----------|------|-------|-------------|----------|
| Full rewrite | High | Slow | High | Too risky |
| Direct port | Low | Fast | Low | Too limiting |
| **Import bridge** | **Medium** | **Medium** | **High** | **Selected** |

---

## High-Level System Architecture

```
┌─────────────────────────────────────────────────────────────────┐
│                        INTERFACES                                │
├─────────────────────────────────────────────────────────────────┤
│  React 18 + TypeScript + TanStack Query + Tailwind CSS          │
│  FastAPI 0.115+ (async, OpenAPI 3.1)                            │
│  Mobile: React Native / PWA (Phase 3)                           │
└─────────────────────────────────────────────────────────────────┘
                              │
                              │ HTTPS / WebSocket
                              ▼
┌─────────────────────────────────────────────────────────────────┐
│                      API GATEWAY                                 │
├─────────────────────────────────────────────────────────────────┤
│  Cloud Run (auto-scaling)                                        │
│  Cloud Armor (WAF, DDoS protection)                             │
│  Cloud CDN (static assets)                                       │
└─────────────────────────────────────────────────────────────────┘
                              │
                              ▼
┌─────────────────────────────────────────────────────────────────┐
│                         DOMAINS                                  │
├─────────────────────────────────────────────────────────────────┤
│  V3 (new):                                                       │
│  ├── organizations/    Multi-tenant root                        │
│  ├── assets/           Elevators, sites, equipment              │
│  ├── work_orders/      Job lifecycle                            │
│  ├── contractors/      Workforce management                     │
│  ├── inventory/        Parts & van stock                        │
│  ├── marketplace/      Parts marketplace                        │
│  ├── profiles/         Technician profiles                      │
│  └── audit/            Compliance trail                         │
│                                                                  │
│  V2 (imported):                                                  │
│  ├── diagnosis/        Fault analysis agents (wrapper)          │
│  └── knowledge/        Knowledge base access                    │
└─────────────────────────────────────────────────────────────────┘
                              │
                              ▼
┌─────────────────────────────────────────────────────────────────┐
│                         ADAPTERS                                 │
├─────────────────────────────────────────────────────────────────┤
│  V3 Adapters:                                                    │
│  ├── postgres/         AsyncPG + SQLAlchemy 2.0                 │
│  ├── redis/            Caching layer                            │
│  └── storage/          Cloud Storage (documents)                │
│                                                                  │
│  V2 Adapters (imported):                                         │
│  ├── gemini/           LLM calls                                │
│  └── ollama/           Local LLM (development)                  │
└─────────────────────────────────────────────────────────────────┘
                              │
                              ▼
┌─────────────────────────────────────────────────────────────────┐
│                      INFRASTRUCTURE                              │
├─────────────────────────────────────────────────────────────────┤
│  Cloud SQL (PostgreSQL 16+)    │  Primary database              │
│  Memorystore (Redis)           │  Caching, sessions             │
│  Cloud Storage                 │  PDFs, images, documents       │
│  Secret Manager                │  API keys, credentials         │
│  Cloud Tasks                   │  Background jobs               │
│  Pub/Sub                       │  Event streaming               │
└─────────────────────────────────────────────────────────────────┘
```

---

## Directory Structure

### V3 Project Layout

```
~/Desktop/sitesync-v3/
├── sitesync_v3/
│   ├── __init__.py
│   ├── core/
│   │   ├── __init__.py
│   │   ├── config.py              # Settings & environment
│   │   ├── database.py            # Database connection
│   │   ├── dependencies.py        # FastAPI dependencies
│   │   ├── exceptions.py          # Custom exceptions
│   │   ├── security.py            # Auth utilities
│   │   └── triforce/              # AI system (see docs/explanation/triforce-ai.md)
│   │       ├── __init__.py
│   │       ├── jury.py
│   │       ├── consensus.py
│   │       ├── memory.py
│   │       └── skills.py
│   │
│   ├── domains/
│   │   ├── __init__.py
│   │   ├── organizations/
│   │   │   ├── __init__.py
│   │   │   ├── contracts.py       # Protocol interfaces
│   │   │   ├── models.py          # Pydantic models
│   │   │   ├── service.py         # Business logic
│   │   │   ├── repository.py      # Data access
│   │   │   └── tests/
│   │   │       └── test_organizations.py
│   │   │
│   │   ├── assets/
│   │   │   ├── __init__.py
│   │   │   ├── contracts.py
│   │   │   ├── models.py
│   │   │   ├── service.py
│   │   │   ├── repository.py
│   │   │   └── tests/
│   │   │
│   │   ├── work_orders/
│   │   │   ├── __init__.py
│   │   │   ├── contracts.py
│   │   │   ├── models.py
│   │   │   ├── service.py
│   │   │   ├── repository.py
│   │   │   └── tests/
│   │   │
│   │   ├── contractors/
│   │   │   └── ... (same pattern)
│   │   │
│   │   ├── inventory/
│   │   │   └── ... (same pattern)
│   │   │
│   │   ├── marketplace/
│   │   │   └── ... (same pattern)
│   │   │
│   │   ├── profiles/
│   │   │   └── ... (same pattern)
│   │   │
│   │   ├── audit/
│   │   │   └── ... (same pattern)
│   │   │
│   │   └── diagnosis/             # V2 wrapper
│   │       ├── __init__.py
│   │       ├── v2_bridge.py       # Imports from V2
│   │       └── service.py         # V3-compatible interface
│   │
│   ├── adapters/
│   │   ├── __init__.py
│   │   ├── postgres/
│   │   │   ├── __init__.py
│   │   │   ├── connection.py
│   │   │   ├── models.py          # SQLAlchemy models
│   │   │   └── migrations/        # Alembic migrations
│   │   │
│   │   ├── redis/
│   │   │   ├── __init__.py
│   │   │   └── cache.py
│   │   │
│   │   └── storage/
│   │       ├── __init__.py
│   │       └── gcs.py             # Google Cloud Storage
│   │
│   └── interfaces/
│       ├── __init__.py
│       ├── api/
│       │   ├── __init__.py
│       │   ├── main.py            # FastAPI app
│       │   ├── middleware.py
│       │   ├── routers/
│       │   │   ├── __init__.py
│       │   │   ├── organizations.py
│       │   │   ├── sites.py
│       │   │   ├── elevators.py
│       │   │   ├── work_orders.py
│       │   │   ├── contractors.py
│       │   │   ├── inventory.py
│       │   │   ├── marketplace.py
│       │   │   ├── profiles.py
│       │   │   ├── diagnosis.py
│       │   │   └── health.py
│       │   └── schemas/
│       │       ├── __init__.py
│       │       ├── requests.py
│       │       └── responses.py
│       │
│       └── web/                   # React app (separate build)
│           └── ...
│
├── alembic/
│   ├── alembic.ini
│   ├── env.py
│   └── versions/
│
├── data → ../sitesync-claudeV2/data  # SYMLINK to V2 data
│
├── tests/
│   ├── conftest.py
│   ├── integration/
│   └── e2e/
│
├── scripts/
│   ├── migrate.py
│   ├── seed.py
│   └── extract.py
│
├── pyproject.toml
├── Dockerfile
├── docker-compose.yml
└── README.md
```

### V2 Project (Library)

```
~/Desktop/sitesync-claudeV2/
├── sitesync/
│   ├── adapters/
│   │   ├── gemini/              # LLM adapter (reused)
│   │   ├── ollama/              # Local LLM (reused)
│   │   ├── sqlite/              # NOT used in V3
│   │   └── faiss/               # Replaced by pgvector
│   │
│   ├── domains/
│   │   ├── extraction/          # Separate service
│   │   ├── search/              # Replaced by native SQL
│   │   ├── diagnosis/           # REUSED via import
│   │   └── knowledge/           # REUSED via import
│   │
│   └── interfaces/              # V2 interfaces (still running)
│
├── data/
│   ├── processed/platinum/      # 2,307 pre-extracted PDFs
│   └── graph/                   # 1,043 nodes, 432 edges
│
└── pyproject.toml
```

---

## Technology Stack

### Backend

| Component | Technology | Version | Purpose |
|-----------|------------|---------|---------|
| Language | Python | 3.12+ | Primary backend language |
| Framework | FastAPI | 0.115+ | Async API framework |
| ORM | SQLAlchemy | 2.0+ | Database abstraction |
| Async DB | asyncpg | 0.30+ | PostgreSQL async driver |
| Validation | Pydantic | 2.10+ | Data validation & serialization |
| AI Framework | Pydantic AI | 0.0.9+ | Structured AI outputs |
| Migrations | Alembic | 1.14+ | Database migrations |
| Observability | OpenTelemetry | 1.28+ | Tracing & metrics |

### Database

| Component | Technology | Version | Purpose |
|-----------|------------|---------|---------|
| Primary DB | PostgreSQL | 16+ | Main data store |
| Vector Store | pgvector | 0.5+ | Embedding storage |
| Text Search | pg_trgm | Built-in | Fuzzy text matching |
| Cache | Redis | 7+ | Caching, sessions |

### Frontend

| Component | Technology | Version | Purpose |
|-----------|------------|---------|---------|
| Framework | React | 18+ | UI framework |
| Language | TypeScript | 5+ | Type safety |
| State | TanStack Query | 5+ | Server state management |
| Styling | Tailwind CSS | 3+ | Utility-first CSS |
| Build | Vite | 5+ | Build tooling |

### Infrastructure

| Component | Technology | Purpose |
|-----------|------------|---------|
| Compute | Cloud Run | Container hosting |
| Database | Cloud SQL | Managed PostgreSQL |
| Cache | Memorystore | Managed Redis |
| Storage | Cloud Storage | File storage |
| Secrets | Secret Manager | Credential storage |
| WAF | Cloud Armor | Security |
| CDN | Cloud CDN | Static assets |
| Tasks | Cloud Tasks | Background jobs |
| Events | Pub/Sub | Event streaming |

---

## V2/V3 Bridge Pattern

### Import Strategy

V3 imports specific V2 components as a library:

```python
# sitesync_v3/domains/diagnosis/v2_bridge.py

"""Bridge to V2 diagnosis functionality."""

from sitesync.adapters.gemini import GeminiAdapter
from sitesync.domains.diagnosis import DiagnosisAgent
from sitesync.domains.knowledge import KnowledgeBase

# Create shared adapter instance
_gemini_adapter = None

def get_gemini_adapter() -> GeminiAdapter:
    """Get or create Gemini adapter singleton."""
    global _gemini_adapter
    if _gemini_adapter is None:
        _gemini_adapter = GeminiAdapter()
    return _gemini_adapter

def get_diagnosis_agent() -> DiagnosisAgent:
    """Get diagnosis agent with V2 implementation."""
    return DiagnosisAgent(adapter=get_gemini_adapter())

def get_knowledge_base() -> KnowledgeBase:
    """Get knowledge base with V2 implementation."""
    return KnowledgeBase(adapter=get_gemini_adapter())
```

### V3-Compatible Service

```python
# sitesync_v3/domains/diagnosis/service.py

"""V3 diagnosis service wrapping V2 implementation."""

from uuid import UUID
from .v2_bridge import get_diagnosis_agent, get_knowledge_base
from ..work_orders.models import WorkOrder
from .models import DiagnosisResult, DiagnosisRequest

class DiagnosisService:
    """V3 service layer for AI diagnosis."""

    def __init__(self):
        self._agent = get_diagnosis_agent()
        self._knowledge = get_knowledge_base()

    async def diagnose(
        self,
        request: DiagnosisRequest
    ) -> DiagnosisResult:
        """
        Run AI diagnosis for a fault.

        Uses V2 diagnosis agent internally but returns
        V3-compatible result models.
        """
        # Call V2 diagnosis
        v2_result = await self._agent.diagnose(
            fault_code=request.fault_code,
            symptoms=request.symptoms,
            equipment_type=request.equipment_type,
            equipment_model=request.equipment_model,
        )

        # Convert to V3 model
        return DiagnosisResult(
            id=UUID(),
            fault_code=v2_result.fault_code,
            severity=v2_result.severity,
            causes=v2_result.causes,
            recommended_actions=v2_result.actions,
            parts_needed=v2_result.parts,
            confidence=v2_result.confidence,
            sources=v2_result.sources,
        )

    async def search_knowledge(
        self,
        query: str,
        equipment_type: str | None = None,
    ) -> list[dict]:
        """Search the knowledge base."""
        return await self._knowledge.search(
            query=query,
            filters={"equipment_type": equipment_type} if equipment_type else None,
        )
```

### pyproject.toml Configuration

```toml
# sitesync_v3/pyproject.toml

[project]
name = "sitesync-v3"
version = "3.0.0"
requires-python = ">=3.12"
dependencies = [
    # V2 as local library
    "sitesync @ file://../sitesync-claudeV2",

    # Core framework
    "fastapi>=0.115.0",
    "uvicorn[standard]>=0.32.0",

    # Database
    "sqlalchemy[asyncio]>=2.0.35",
    "asyncpg>=0.30.0",
    "alembic>=1.14.0",

    # Validation & serialization
    "pydantic>=2.10.0",
    "pydantic-settings>=2.6.0",

    # AI
    "pydantic-ai>=0.0.9",

    # Observability
    "opentelemetry-api>=1.28.0",
    "opentelemetry-sdk>=1.28.0",
    "opentelemetry-instrumentation-fastapi>=0.49b0",

    # Utilities
    "httpx>=0.27.0",
    "python-multipart>=0.0.12",
    "python-jose[cryptography]>=3.3.0",
    "passlib[bcrypt]>=1.7.4",
]

[project.optional-dependencies]
dev = [
    "pytest>=8.3.0",
    "pytest-asyncio>=0.24.0",
    "pytest-cov>=6.0.0",
    "mypy>=1.13.0",
    "ruff>=0.8.0",
    "pre-commit>=4.0.0",
]
```

---

## Database Architecture

### PostgreSQL Features Used

| Feature | Purpose |
|---------|---------|
| **Row-Level Security (RLS)** | Multi-tenant data isolation |
| **pgvector** | Embedding storage for semantic search |
| **pg_trgm** | Fuzzy text matching |
| **JSONB** | Flexible metadata storage |
| **Table Partitioning** | Scale audit_events table |
| **CTEs** | Complex queries (graph-like traversal) |

### Connection Management

```python
# sitesync_v3/core/database.py

from contextlib import asynccontextmanager
from sqlalchemy.ext.asyncio import (
    AsyncSession,
    async_sessionmaker,
    create_async_engine,
)
from .config import settings

# Create async engine
engine = create_async_engine(
    settings.database_url,
    pool_size=20,
    max_overflow=10,
    pool_pre_ping=True,
    echo=settings.debug,
)

# Session factory
async_session = async_sessionmaker(
    engine,
    class_=AsyncSession,
    expire_on_commit=False,
)

@asynccontextmanager
async def get_session():
    """Get database session with automatic cleanup."""
    async with async_session() as session:
        try:
            yield session
            await session.commit()
        except Exception:
            await session.rollback()
            raise
        finally:
            await session.close()

async def set_tenant_context(
    session: AsyncSession,
    organization_id: str
) -> None:
    """Set RLS context for multi-tenant isolation."""
    await session.execute(
        f"SET app.current_org = '{organization_id}'"
    )
```

---

## Caching Strategy

### Redis Usage

```python
# sitesync_v3/adapters/redis/cache.py

import redis.asyncio as redis
from typing import Any
import json

class CacheService:
    """Redis caching service."""

    def __init__(self, redis_url: str):
        self.redis = redis.from_url(redis_url)

    async def get(self, key: str) -> Any | None:
        """Get value from cache."""
        value = await self.redis.get(key)
        if value:
            return json.loads(value)
        return None

    async def set(
        self,
        key: str,
        value: Any,
        ttl: int = 3600
    ) -> None:
        """Set value in cache with TTL."""
        await self.redis.setex(
            key,
            ttl,
            json.dumps(value)
        )

    async def invalidate(self, pattern: str) -> None:
        """Invalidate keys matching pattern."""
        keys = await self.redis.keys(pattern)
        if keys:
            await self.redis.delete(*keys)

# Cache key patterns
CACHE_KEYS = {
    "elevator": "elevator:{elevator_id}",
    "site_elevators": "site:{site_id}:elevators",
    "org_stats": "org:{org_id}:stats",
    "diagnosis": "diagnosis:{work_order_id}",
}
```

### Cache Invalidation Strategy

| Event | Invalidation |
|-------|--------------|
| Elevator updated | `elevator:{id}`, `site:{site_id}:elevators` |
| Work order created | `org:{org_id}:stats` |
| Work order completed | `org:{org_id}:stats`, `elevator:{id}` |
| Site modified | `site:{id}:*` |

---

## Infrastructure Architecture

### Cloud Run Configuration

```yaml
# cloudrun.yaml
apiVersion: serving.knative.dev/v1
kind: Service
metadata:
  name: sitesync-api
spec:
  template:
    metadata:
      annotations:
        autoscaling.knative.dev/minScale: "1"
        autoscaling.knative.dev/maxScale: "100"
        run.googleapis.com/cpu-throttling: "false"
    spec:
      containerConcurrency: 80
      timeoutSeconds: 300
      containers:
        - image: gcr.io/PROJECT_ID/sitesync-api
          ports:
            - containerPort: 8080
          env:
            - name: DATABASE_URL
              valueFrom:
                secretKeyRef:
                  name: database-url
                  key: latest
          resources:
            limits:
              cpu: "2"
              memory: "2Gi"
```

### Docker Configuration

```dockerfile
# Dockerfile
FROM python:3.12-slim

WORKDIR /app

# Install system dependencies
RUN apt-get update && apt-get install -y \
    libpq-dev \
    && rm -rf /var/lib/apt/lists/*

# Install Python dependencies
COPY pyproject.toml .
RUN pip install --no-cache-dir -e .

# Copy application
COPY sitesync_v3/ ./sitesync_v3/

# Run with uvicorn
CMD ["uvicorn", "sitesync_v3.interfaces.api.main:app", \
     "--host", "0.0.0.0", "--port", "8080"]
```

---

## Security Architecture

### Authentication Flow

```
┌─────────────────────────────────────────────────────────────────┐
│                    AUTHENTICATION FLOW                          │
├─────────────────────────────────────────────────────────────────┤
│                                                                 │
│  1. User logs in with credentials                               │
│     └── POST /api/v1/auth/login                                 │
│                                                                 │
│  2. Server validates credentials                                │
│     └── Check password hash                                     │
│     └── Verify user active                                      │
│                                                                 │
│  3. Server issues JWT tokens                                    │
│     └── Access token (15 min)                                   │
│     └── Refresh token (7 days)                                  │
│                                                                 │
│  4. Client stores tokens                                        │
│     └── Access token in memory                                  │
│     └── Refresh token in httpOnly cookie                        │
│                                                                 │
│  5. Client makes authenticated requests                         │
│     └── Authorization: Bearer {access_token}                    │
│                                                                 │
│  6. Server validates token & sets tenant context                │
│     └── Verify JWT signature                                    │
│     └── SET app.current_org = '{org_id}'                        │
│     └── RLS policies filter all queries                         │
│                                                                 │
└─────────────────────────────────────────────────────────────────┘
```

### Multi-Tenant Isolation

```sql
-- Every table has organization_id
-- RLS policies ensure users only see their org's data

ALTER TABLE sites ENABLE ROW LEVEL SECURITY;

CREATE POLICY org_isolation ON sites
    USING (organization_id = current_setting('app.current_org')::uuid);

-- This happens automatically on every query
-- No application code can bypass it
```

---

## Deployment Pipeline

```
┌─────────────────────────────────────────────────────────────────┐
│                    DEPLOYMENT PIPELINE                          │
├─────────────────────────────────────────────────────────────────┤
│                                                                 │
│  ┌─────────┐    ┌─────────┐    ┌─────────┐    ┌─────────┐     │
│  │  Code   │───►│  Test   │───►│  Build  │───►│ Deploy  │     │
│  │  Push   │    │  Suite  │    │  Image  │    │  Cloud  │     │
│  └─────────┘    └─────────┘    └─────────┘    └─────────┘     │
│       │              │              │              │           │
│       │              │              │              │           │
│       ▼              ▼              ▼              ▼           │
│   GitHub        pytest         Docker         Cloud Run       │
│   Actions       + mypy         + GCR          + Traffic       │
│                 + ruff                         Splitting       │
│                                                                 │
└─────────────────────────────────────────────────────────────────┘

ENVIRONMENTS:
├── Development: Local Docker Compose
├── Staging: Cloud Run (auto-deploy from main)
└── Production: Cloud Run (manual promotion)
```

---

## What V3 Does NOT Include

These V2 components are explicitly excluded from V3:

| Component | Reason | Replacement |
|-----------|--------|-------------|
| `domains/extraction/` | Separate microservice | Cloud Function |
| `adapters/faiss/` | Replaced | pgvector |
| `adapters/sqlite/` | Replaced | PostgreSQL |
| `domains/search/hybrid_search.py` | Replaced | Native SQL query |

---

## Next Steps

For implementation details, see:
- [Data Model](data-model.md) - Database schemas
- [Triforce AI](../explanation/triforce-ai.md) - AI system architecture
- [Implementation](implementation.md) - Code patterns

---

**[← Back to Platform Ecosystem](../explanation/platform-ecosystem.md)** | **[Next: Data Model →](data-model.md)**


<!-- FILE: docs/reference/implementation.md -->

# SiteSync V3 - Implementation Guide

## Code Patterns & Best Practices

> This document provides the implementation patterns, code conventions, and best practices for developing SiteSync V3.

---

## Python Conventions

### Version & Typing

Use Python 3.12+ features:

```python
# PEP 695 type parameter syntax
class Repository[T]:
    async def get(self, id: UUID) -> T | None: ...
    async def list(self) -> list[T]: ...
    async def create(self, data: T) -> T: ...

# Use X | None instead of Optional[X]
def process(data: str | None = None) -> dict: ...

# Use list[X] instead of List[X]
def get_items() -> list[Item]: ...

# Use dict[K, V] instead of Dict[K, V]
def get_mapping() -> dict[str, int]: ...
```

### Imports

```python
# Standard library
from datetime import datetime, date
from decimal import Decimal
from uuid import UUID
from typing import Protocol
from dataclasses import dataclass
from enum import Enum
import asyncio

# Third party
from pydantic import BaseModel, Field
from sqlalchemy.ext.asyncio import AsyncSession
from fastapi import APIRouter, Depends, HTTPException

# Local
from sitesync_v3.core.database import get_session
from sitesync_v3.domains.assets.models import Elevator
```

---

## Domain Pattern

### Structure

Each domain follows this pattern:

```
domains/{domain}/
├── __init__.py       # Public exports
├── contracts.py      # Protocol interfaces
├── models.py         # Pydantic models
├── service.py        # Business logic
├── repository.py     # Data access
└── tests/
    └── test_{domain}.py
```

### Contracts (Protocols)

Define interfaces as protocols:

```python
# domains/assets/contracts.py

from typing import Protocol
from uuid import UUID
from .models import Elevator, ElevatorCreate, ElevatorUpdate

class ElevatorRepository(Protocol):
    """Repository interface for elevator data access."""

    async def get(self, elevator_id: UUID) -> Elevator | None:
        """Get elevator by ID."""
        ...

    async def list_by_site(self, site_id: UUID) -> list[Elevator]:
        """List all elevators for a site."""
        ...

    async def create(self, data: ElevatorCreate) -> Elevator:
        """Create a new elevator."""
        ...

    async def update(
        self, elevator_id: UUID, data: ElevatorUpdate
    ) -> Elevator:
        """Update an elevator."""
        ...

    async def delete(self, elevator_id: UUID) -> None:
        """Delete an elevator."""
        ...


class ElevatorService(Protocol):
    """Service interface for elevator business logic."""

    async def register_elevator(
        self, data: ElevatorCreate
    ) -> Elevator:
        """Register a new elevator with validation."""
        ...

    async def update_status(
        self, elevator_id: UUID, status: str, reason: str
    ) -> Elevator:
        """Update elevator status with audit logging."""
        ...

    async def get_health_score(
        self, elevator_id: UUID
    ) -> dict:
        """Calculate and return health score."""
        ...
```

### Models (Pydantic)

```python
# domains/assets/models.py

from datetime import date, datetime
from decimal import Decimal
from enum import Enum
from uuid import UUID
from pydantic import BaseModel, Field, ConfigDict

class ElevatorStatus(str, Enum):
    OPERATIONAL = "operational"
    DEGRADED = "degraded"
    OUT_OF_SERVICE = "out_of_service"
    MAINTENANCE = "maintenance"
    DECOMMISSIONED = "decommissioned"

class Elevator(BaseModel):
    """Elevator domain model (immutable)."""

    model_config = ConfigDict(frozen=True)

    id: UUID
    organization_id: UUID
    site_id: UUID
    unit_number: str
    serial_number: str | None = None
    manufacturer: str | None = None
    model: str | None = None
    status: ElevatorStatus = ElevatorStatus.OPERATIONAL
    health_score: int | None = None
    created_at: datetime
    updated_at: datetime

class ElevatorCreate(BaseModel):
    """Request model for creating elevator."""

    site_id: UUID
    unit_number: str
    serial_number: str | None = None
    manufacturer: str | None = None
    model: str | None = None

class ElevatorUpdate(BaseModel):
    """Request model for updating elevator."""

    unit_number: str | None = None
    serial_number: str | None = None
    manufacturer: str | None = None
    model: str | None = None
    status: ElevatorStatus | None = None
```

### Repository (Data Access)

```python
# domains/assets/repository.py

from uuid import UUID
from sqlalchemy import select, update, delete
from sqlalchemy.ext.asyncio import AsyncSession

from .models import Elevator, ElevatorCreate, ElevatorUpdate
from sitesync_v3.adapters.postgres.models import ElevatorModel

class PostgresElevatorRepository:
    """PostgreSQL implementation of elevator repository."""

    def __init__(self, session: AsyncSession):
        self.session = session

    async def get(self, elevator_id: UUID) -> Elevator | None:
        """Get elevator by ID."""
        result = await self.session.execute(
            select(ElevatorModel).where(ElevatorModel.id == elevator_id)
        )
        row = result.scalar_one_or_none()
        return Elevator.model_validate(row) if row else None

    async def list_by_site(self, site_id: UUID) -> list[Elevator]:
        """List all elevators for a site."""
        result = await self.session.execute(
            select(ElevatorModel)
            .where(ElevatorModel.site_id == site_id)
            .order_by(ElevatorModel.unit_number)
        )
        return [Elevator.model_validate(row) for row in result.scalars()]

    async def create(self, data: ElevatorCreate) -> Elevator:
        """Create a new elevator."""
        elevator = ElevatorModel(**data.model_dump())
        self.session.add(elevator)
        await self.session.flush()
        await self.session.refresh(elevator)
        return Elevator.model_validate(elevator)

    async def update(
        self,
        elevator_id: UUID,
        data: ElevatorUpdate,
    ) -> Elevator:
        """Update an elevator."""
        update_data = data.model_dump(exclude_unset=True)
        await self.session.execute(
            update(ElevatorModel)
            .where(ElevatorModel.id == elevator_id)
            .values(**update_data)
        )
        return await self.get(elevator_id)

    async def delete(self, elevator_id: UUID) -> None:
        """Soft delete an elevator."""
        await self.session.execute(
            update(ElevatorModel)
            .where(ElevatorModel.id == elevator_id)
            .values(deleted_at=datetime.now())
        )
```

### Service (Business Logic)

```python
# domains/assets/service.py

from uuid import UUID
from datetime import datetime

from .contracts import ElevatorRepository
from .models import Elevator, ElevatorCreate, ElevatorUpdate, ElevatorStatus
from ..audit.service import AuditService
from sitesync_v3.core.exceptions import NotFoundError, ValidationError

class ElevatorService:
    """Business logic for elevator management."""

    def __init__(
        self,
        repository: ElevatorRepository,
        audit_service: AuditService,
    ):
        self.repository = repository
        self.audit = audit_service

    async def register_elevator(
        self,
        data: ElevatorCreate,
        actor_id: UUID,
    ) -> Elevator:
        """
        Register a new elevator.

        Validates input, creates elevator, and logs audit event.
        """
        # Validation
        if not data.unit_number:
            raise ValidationError("Unit number is required")

        # Create
        elevator = await self.repository.create(data)

        # Audit
        await self.audit.log_event(
            event_type="elevator_created",
            entity_type="elevator",
            entity_id=elevator.id,
            actor_id=actor_id,
            data=elevator.model_dump(),
        )

        return elevator

    async def update_status(
        self,
        elevator_id: UUID,
        status: ElevatorStatus,
        reason: str,
        actor_id: UUID,
    ) -> Elevator:
        """
        Update elevator status with audit logging.
        """
        # Get current state
        current = await self.repository.get(elevator_id)
        if not current:
            raise NotFoundError("Elevator not found")

        previous_status = current.status

        # Update
        elevator = await self.repository.update(
            elevator_id,
            ElevatorUpdate(status=status),
        )

        # Audit
        await self.audit.log_event(
            event_type="elevator_status_changed",
            entity_type="elevator",
            entity_id=elevator_id,
            actor_id=actor_id,
            data={
                "previous_status": previous_status,
                "new_status": status,
                "reason": reason,
            },
            previous_state={"status": previous_status},
            new_state={"status": status},
        )

        return elevator

    async def get_health_score(
        self,
        elevator_id: UUID,
    ) -> dict:
        """
        Calculate elevator health score.
        """
        elevator = await self.repository.get(elevator_id)
        if not elevator:
            raise NotFoundError("Elevator not found")

        # Calculate components (simplified)
        age_score = self._calculate_age_score(elevator)
        maintenance_score = await self._get_maintenance_score(elevator_id)
        incident_score = await self._get_incident_score(elevator_id)

        overall = int(
            age_score * 0.3 +
            maintenance_score * 0.4 +
            incident_score * 0.3
        )

        return {
            "elevator_id": elevator_id,
            "health_score": overall,
            "breakdown": {
                "age_condition": age_score,
                "maintenance_compliance": maintenance_score,
                "incident_frequency": incident_score,
            },
        }

    def _calculate_age_score(self, elevator: Elevator) -> int:
        """Calculate score based on equipment age."""
        if not elevator.installation_date:
            return 70  # Default for unknown

        age_years = (date.today() - elevator.installation_date).days / 365

        if age_years < 5:
            return 95
        elif age_years < 10:
            return 85
        elif age_years < 20:
            return 70
        else:
            return 55
```

---

## FastAPI Patterns

### Router Structure

```python
# interfaces/api/routers/elevators.py

from uuid import UUID
from fastapi import APIRouter, Depends, HTTPException, status

from sitesync_v3.core.dependencies import (
    get_current_user,
    get_elevator_service,
)
from sitesync_v3.domains.assets.models import (
    Elevator,
    ElevatorCreate,
    ElevatorUpdate,
)
from sitesync_v3.domains.assets.service import ElevatorService
from ..schemas.responses import ElevatorResponse, ElevatorListResponse

router = APIRouter()

@router.get("", response_model=ElevatorListResponse)
async def list_elevators(
    site_id: UUID | None = None,
    status: str | None = None,
    page: int = 1,
    per_page: int = 20,
    user = Depends(get_current_user),
    service: ElevatorService = Depends(get_elevator_service),
):
    """List elevators with optional filtering."""
    elevators = await service.list_elevators(
        site_id=site_id,
        status=status,
        page=page,
        per_page=per_page,
    )
    return ElevatorListResponse(data=elevators)

@router.get("/{elevator_id}", response_model=ElevatorResponse)
async def get_elevator(
    elevator_id: UUID,
    user = Depends(get_current_user),
    service: ElevatorService = Depends(get_elevator_service),
):
    """Get elevator by ID."""
    elevator = await service.get_elevator(elevator_id)
    if not elevator:
        raise HTTPException(
            status_code=status.HTTP_404_NOT_FOUND,
            detail="Elevator not found"
        )
    return ElevatorResponse(data=elevator)

@router.post("", response_model=ElevatorResponse, status_code=status.HTTP_201_CREATED)
async def create_elevator(
    data: ElevatorCreate,
    user = Depends(get_current_user),
    service: ElevatorService = Depends(get_elevator_service),
):
    """Create a new elevator."""
    elevator = await service.register_elevator(data, actor_id=user.id)
    return ElevatorResponse(data=elevator)

@router.patch("/{elevator_id}", response_model=ElevatorResponse)
async def update_elevator(
    elevator_id: UUID,
    data: ElevatorUpdate,
    user = Depends(get_current_user),
    service: ElevatorService = Depends(get_elevator_service),
):
    """Update an elevator."""
    elevator = await service.update_elevator(
        elevator_id, data, actor_id=user.id
    )
    return ElevatorResponse(data=elevator)

@router.patch("/{elevator_id}/status", response_model=ElevatorResponse)
async def update_status(
    elevator_id: UUID,
    status: str,
    reason: str,
    user = Depends(get_current_user),
    service: ElevatorService = Depends(get_elevator_service),
):
    """Update elevator status."""
    elevator = await service.update_status(
        elevator_id=elevator_id,
        status=status,
        reason=reason,
        actor_id=user.id,
    )
    return ElevatorResponse(data=elevator)

@router.get("/{elevator_id}/health")
async def get_health(
    elevator_id: UUID,
    user = Depends(get_current_user),
    service: ElevatorService = Depends(get_elevator_service),
):
    """Get elevator health score."""
    return await service.get_health_score(elevator_id)
```

### Dependency Injection

```python
# core/dependencies.py

from typing import AsyncGenerator
from fastapi import Depends
from sqlalchemy.ext.asyncio import AsyncSession

from .database import async_session
from .security import get_current_user_from_token

async def get_session() -> AsyncGenerator[AsyncSession, None]:
    """Get database session."""
    async with async_session() as session:
        try:
            yield session
            await session.commit()
        except Exception:
            await session.rollback()
            raise

async def get_current_user(
    token: str = Depends(oauth2_scheme),
    session: AsyncSession = Depends(get_session),
):
    """Get current authenticated user and set tenant context."""
    user = await get_current_user_from_token(token, session)

    # Set RLS context
    await session.execute(
        f"SET app.current_org = '{user.organization_id}'"
    )

    return user

def get_elevator_service(
    session: AsyncSession = Depends(get_session),
) -> ElevatorService:
    """Get elevator service with dependencies."""
    repository = PostgresElevatorRepository(session)
    audit_service = AuditService(session)
    return ElevatorService(repository, audit_service)
```

---

## Error Handling

### Custom Exceptions

```python
# core/exceptions.py

class SiteSyncError(Exception):
    """Base exception for SiteSync."""
    pass

class NotFoundError(SiteSyncError):
    """Resource not found."""
    pass

class ValidationError(SiteSyncError):
    """Validation failed."""
    pass

class AuthenticationError(SiteSyncError):
    """Authentication failed."""
    pass

class AuthorizationError(SiteSyncError):
    """Authorization failed."""
    pass

class ConflictError(SiteSyncError):
    """Resource conflict."""
    pass
```

### Exception Handlers

```python
# interfaces/api/middleware.py

from fastapi import Request
from fastapi.responses import JSONResponse

from sitesync_v3.core.exceptions import (
    NotFoundError,
    ValidationError,
    AuthenticationError,
    AuthorizationError,
)

async def not_found_handler(request: Request, exc: NotFoundError):
    return JSONResponse(
        status_code=404,
        content={
            "error": {
                "code": "NOT_FOUND",
                "message": str(exc),
            }
        },
    )

async def validation_handler(request: Request, exc: ValidationError):
    return JSONResponse(
        status_code=422,
        content={
            "error": {
                "code": "VALIDATION_ERROR",
                "message": str(exc),
            }
        },
    )

# Register in main.py
app.add_exception_handler(NotFoundError, not_found_handler)
app.add_exception_handler(ValidationError, validation_handler)
```

---

## Testing

### Test Structure

```python
# domains/assets/tests/test_elevators.py

import pytest
from uuid import uuid4
from unittest.mock import AsyncMock

from sitesync_v3.domains.assets.service import ElevatorService
from sitesync_v3.domains.assets.models import (
    Elevator,
    ElevatorCreate,
    ElevatorStatus,
)

@pytest.fixture
def mock_repository():
    return AsyncMock()

@pytest.fixture
def mock_audit():
    return AsyncMock()

@pytest.fixture
def service(mock_repository, mock_audit):
    return ElevatorService(mock_repository, mock_audit)

class TestElevatorService:

    async def test_register_elevator_success(
        self, service, mock_repository, mock_audit
    ):
        """Test successful elevator registration."""
        # Arrange
        data = ElevatorCreate(
            site_id=uuid4(),
            unit_number="Lift 1",
            manufacturer="KONE",
        )
        expected = Elevator(
            id=uuid4(),
            organization_id=uuid4(),
            site_id=data.site_id,
            unit_number=data.unit_number,
            manufacturer=data.manufacturer,
            status=ElevatorStatus.OPERATIONAL,
            created_at=datetime.now(),
            updated_at=datetime.now(),
        )
        mock_repository.create.return_value = expected

        # Act
        result = await service.register_elevator(data, actor_id=uuid4())

        # Assert
        assert result.unit_number == "Lift 1"
        assert result.manufacturer == "KONE"
        mock_repository.create.assert_called_once()
        mock_audit.log_event.assert_called_once()

    async def test_register_elevator_missing_unit_number(self, service):
        """Test validation failure for missing unit number."""
        data = ElevatorCreate(site_id=uuid4(), unit_number="")

        with pytest.raises(ValidationError):
            await service.register_elevator(data, actor_id=uuid4())

    async def test_update_status_logs_audit(
        self, service, mock_repository, mock_audit
    ):
        """Test that status changes are audited."""
        elevator_id = uuid4()
        current = Elevator(
            id=elevator_id,
            organization_id=uuid4(),
            site_id=uuid4(),
            unit_number="Lift 1",
            status=ElevatorStatus.OPERATIONAL,
            created_at=datetime.now(),
            updated_at=datetime.now(),
        )
        mock_repository.get.return_value = current
        mock_repository.update.return_value = current

        await service.update_status(
            elevator_id=elevator_id,
            status=ElevatorStatus.OUT_OF_SERVICE,
            reason="Door fault",
            actor_id=uuid4(),
        )

        mock_audit.log_event.assert_called_once()
        call_kwargs = mock_audit.log_event.call_args.kwargs
        assert call_kwargs["event_type"] == "elevator_status_changed"
```

### Test Configuration

```python
# tests/conftest.py

import pytest
import asyncio
from sqlalchemy.ext.asyncio import create_async_engine, AsyncSession
from sqlalchemy.orm import sessionmaker

@pytest.fixture(scope="session")
def event_loop():
    loop = asyncio.get_event_loop_policy().new_event_loop()
    yield loop
    loop.close()

@pytest.fixture(scope="session")
async def test_engine():
    engine = create_async_engine(
        "postgresql+asyncpg://test:test@localhost:5432/test_db",
        echo=True,
    )
    yield engine
    await engine.dispose()

@pytest.fixture
async def test_session(test_engine):
    async_session = sessionmaker(
        test_engine, class_=AsyncSession, expire_on_commit=False
    )
    async with async_session() as session:
        yield session
        await session.rollback()
```

---

## Audit Logging

### Audit Service

```python
# domains/audit/service.py

import hashlib
import json
from uuid import UUID
from datetime import datetime
from sqlalchemy.ext.asyncio import AsyncSession
from sqlalchemy import select

from .models import AuditEvent, AuditEventCreate

class AuditService:
    """Service for immutable audit logging."""

    def __init__(self, session: AsyncSession):
        self.session = session

    async def log_event(
        self,
        event_type: str,
        entity_type: str,
        entity_id: UUID,
        actor_id: UUID,
        data: dict,
        previous_state: dict | None = None,
        new_state: dict | None = None,
    ) -> AuditEvent:
        """
        Log an audit event with hash chain integrity.
        """
        # Get previous hash for chain
        previous_hash = await self._get_last_hash(entity_id)

        # Compute event hash
        hash_input = json.dumps({
            "event_type": event_type,
            "entity_id": str(entity_id),
            "actor_id": str(actor_id),
            "data": data,
            "previous_hash": previous_hash or "",
            "timestamp": datetime.now().isoformat(),
        }, sort_keys=True)

        event_hash = hashlib.sha256(hash_input.encode()).hexdigest()

        # Create event
        event = AuditEventModel(
            event_type=event_type,
            entity_type=entity_type,
            entity_id=entity_id,
            actor_id=actor_id,
            event_data=data,
            previous_state=previous_state,
            new_state=new_state,
            previous_hash=previous_hash,
            hash=event_hash,
        )

        self.session.add(event)
        await self.session.flush()

        return AuditEvent.model_validate(event)

    async def _get_last_hash(self, entity_id: UUID) -> str | None:
        """Get the hash of the last event for this entity."""
        result = await self.session.execute(
            select(AuditEventModel.hash)
            .where(AuditEventModel.entity_id == entity_id)
            .order_by(AuditEventModel.created_at.desc())
            .limit(1)
        )
        row = result.scalar_one_or_none()
        return row

    async def verify_chain(self, entity_id: UUID) -> bool:
        """Verify the integrity of the audit chain for an entity."""
        # Implementation would recompute hashes and verify chain
        pass
```

---

## Configuration

### Settings

```python
# core/config.py

from pydantic_settings import BaseSettings

class Settings(BaseSettings):
    """Application settings from environment."""

    # Database
    database_url: str
    database_pool_size: int = 20

    # Redis
    redis_url: str

    # Security
    secret_key: str
    access_token_expire_minutes: int = 15
    refresh_token_expire_days: int = 7

    # AI
    gemini_api_key: str
    anthropic_api_key: str
    openai_api_key: str

    # Environment
    environment: str = "development"
    debug: bool = False

    class Config:
        env_file = ".env"

settings = Settings()
```

---

## Code Quality

### Ruff Configuration

```toml
# pyproject.toml

[tool.ruff]
target-version = "py312"
line-length = 88

[tool.ruff.lint]
select = [
    "E",   # pycodestyle errors
    "W",   # pycodestyle warnings
    "F",   # pyflakes
    "I",   # isort
    "B",   # flake8-bugbear
    "C4",  # flake8-comprehensions
    "UP",  # pyupgrade
]

[tool.ruff.lint.isort]
known-first-party = ["sitesync_v3"]
```

### MyPy Configuration

```toml
# pyproject.toml

[tool.mypy]
python_version = "3.12"
strict = true
plugins = ["pydantic.mypy"]
```

---

**[← Back to Features](features.md)** | **[Next: Market Strategy →](../strategy/market-strategy.md)**


<!-- FILE: docs/reference/features.md -->

# SiteSync V3 - Features

## Complete Feature Specification

> This document details all features of SiteSync V3, from core functionality to breakthrough innovations.

---

## Core Features

### 1. Building Data Ownership

**What It Is:**
Buildings own their complete service history permanently, regardless of which contractors perform the work.

**Key Capabilities:**
- Complete service history tied to the building
- History persists through contractor changes
- Full audit trail with tamper-proof integrity
- Export capabilities for property transactions
- AI insights accumulated over building lifetime

**User Experience:**
- Building managers see unified history from all contractors
- New contractors see complete context from day one
- Equipment quirks and patterns are preserved
- Compliance documentation always available

---

### 2. Multi-Level Visibility

**Site Level:**
- Building Health Score (0-100)
- All trades summary
- Open jobs across all trades
- Cost tracking (YTD, monthly)
- Upcoming maintenance schedule
- Recent activity feed

**Trade Level:**
- Trade-specific health score
- All equipment in that trade
- Service provider history
- Performance comparisons
- AI insights for the trade

**Equipment Level:**
- Complete timeline (all contractors)
- Equipment specifications
- Known quirks (AI-learned)
- Documents and manuals
- Predictive insights
- Compliance certificates

---

### 3. AI-Powered Diagnosis

**Triforce AI System:**
- Multi-model jury (Gemini, Claude, GPT-4)
- Consensus voting for reliability
- Knowledge base validation
- Structured, actionable outputs

**Diagnosis Capabilities:**
- Fault code interpretation
- Symptom analysis
- Probable cause ranking
- Diagnostic step recommendations
- Parts prediction
- Time estimation
- Safety notes

**Output Example:**
```
Fault: F505 on KONE MonoSpace
Confidence: 87%
Primary Cause: Door zone sensor fault
Diagnostic Steps:
1. Check sensor alignment
2. Test sensor output
3. Inspect wiring
Parts Likely Needed: KM-DZ-505 ($85)
Estimated Time: 90 minutes
Similar Cases Resolved: 847
```

---

### 4. Building Health Score

**What It Measures:**
| Component | Weight | Description |
|-----------|--------|-------------|
| Equipment Condition | 25% | Age, wear, recent issues |
| Maintenance Compliance | 25% | Scheduled vs actual |
| Incident Frequency | 20% | Breakdowns, callbacks |
| First-Time Fix Rate | 15% | Resolution efficiency |
| Predictive Risk | 15% | AI-assessed future risk |

**Features:**
- Single score (0-100) for entire building
- Breakdown by trade
- Trend tracking over time
- Comparison to similar buildings
- Predictive forecasting
- Actionable recommendations

---

### 5. Work Order Management

**Lifecycle:**
```
Draft → Pending → Scheduled → In Progress → Completed → Invoiced
                     ↓
                  On Hold
                     ↓
                 Cancelled
```

**Features:**
- AI-assisted creation (auto-suggests priority, type)
- Smart assignment (considers skills, location, availability)
- Real-time status tracking
- Parts and labor logging
- Photo and document attachments
- AI diagnosis integration
- Auto-generated reports
- Callback tracking

**Priority Levels:**
| Priority | Response Target | Use Case |
|----------|-----------------|----------|
| Emergency | Immediate | People trapped, safety issue |
| High | Same day | Equipment out of service |
| Medium | 48 hours | Degraded operation |
| Low | 1 week | Minor issues |
| Scheduled | Planned date | Preventive maintenance |

---

### 6. Van Stock Management

**Inventory Tracking:**
- Real-time stock levels per technician
- Minimum stock alerts
- Auto-reorder suggestions
- Stock transfer between technicians
- Usage history and trends

**Nearby Parts Feature:**
- Locate parts in nearby technicians' vans
- Distance and availability shown
- One-tap contact to request
- Part sharing workflow

**Van Stock Dashboard:**
```
MY VAN STOCK
────────────────────────────────────
Part             Qty  Min  Status
────────────────────────────────────
Door Sensor       2    1   ● OK
Interlock Switch  1    1   ● OK
Encoder Belt      0    1   ○ LOW
Safety Contacts   3    2   ● OK
────────────────────────────────────
[Reorder Low Stock] [Transfer Parts]
```

---

### 7. Parts Marketplace

**Listing Types:**
- Peer-to-peer (tech to tech)
- Company surplus
- Supplier listings
- Used/refurbished parts

**Features:**
- Search by part number, manufacturer
- Condition ratings (new, refurbished, used)
- Location-based results
- Price comparison
- Seller ratings
- Secure transactions

**Revenue Model:**
- 5% transaction fee (peer-to-peer)
- 3% transaction fee (suppliers)
- Premium placement options

---

### 8. Technician Professional Profiles

**Profile Components:**
- Verified job history
- Expertise score (0-100)
- First-time fix rate
- Specializations
- Certifications
- Knowledge contributions
- Endorsements
- Badges and achievements

**Career Features:**
- Resume integration
- Employer search
- Opportunity matching
- Career progression tracking
- Skills development paths

**Privacy Controls:**
- Public / Employers only / Private
- Anonymous contributions option
- Control over visibility

---

### 9. Collective Knowledge Base

**Content Types:**
- Fault solutions
- Quick tips
- Procedures
- Equipment quirks
- Safety notes

**How It Works:**
1. Technician solves problem
2. Documents solution
3. AI validates and enhances
4. Community accesses
5. Usage tracked for reputation

**Search Capabilities:**
- Natural language queries
- Fault code lookup
- Equipment-specific filtering
- AI-synthesized answers

---

### 10. Compliance Management

**Tracking:**
- Inspection schedules
- Certificate management
- Regulatory requirements
- Compliance status dashboard

**Automation:**
- Due date reminders
- Auto-scheduling
- Certificate expiry alerts
- Compliance reporting

**Audit Trail:**
- Immutable event log
- Hash-chain integrity
- Export for regulators
- Due diligence reports

---

## Multi-Trade Support

### Supported Trades

| Trade | Status | AI Specialization |
|-------|--------|-------------------|
| Lifts & Escalators | Launch | Lift AI (full) |
| HVAC | Phase 2 | HVAC AI |
| Electrical | Phase 2 | Electrical AI |
| Plumbing | Phase 2 | Plumbing AI |
| Fire Systems | Phase 2 | Fire AI |
| Security | Phase 3 | Security AI |
| Painting/Fit-out | Phase 3 | Basic |
| Removalists | Phase 3 | Basic |

### Trade-Specific Features

**Each Trade Gets:**
- Specialized AI models
- Trade-specific fault codes
- Relevant compliance tracking
- Appropriate scheduling rules
- Trade knowledge base

---

## Emergency Response

### Category System

**Category 1 - Immediate (People Safety):**
- People trapped in lift
- Fire/smoke detected
- Active flooding
- Security breach

**Response:** Instant alert, auto-dispatch nearest qualified tech

**Category 2 - Urgent (Building Impact):**
- Lift out of service (single-lift building)
- HVAC failure in extreme weather
- Power failure
- Fire system fault

**Response:** 1-hour target, escalation protocols

**Category 3 - Standard:**
- Intermittent faults
- Comfort complaints
- Minor damage
- Vandalism

**Response:** Next business day

### Emergency Flow

```
Report Received
      │
      ▼
AI Categorizes (Cat 1/2/3)
      │
      ▼
Auto-Dispatch if Cat 1
      │
      ▼
Technician Notified
      │
      ▼
Building Gets ETA
      │
      ▼
En-Route Updates
      │
      ▼
Resolution + Report
```

---

## Breakthrough Innovations

### 1. AI Vision

**Capability:** Point camera at equipment, get instant identification and context.

**Features:**
- Nameplate OCR
- Equipment identification
- Auto-download relevant manual
- Show equipment history
- Display known quirks

### 2. Voice-First Interface

**Capability:** Speak naturally, get AI assistance without typing.

**Features:**
- Symptom description by voice
- Voice-activated diagnosis
- Hands-free report dictation
- Voice search in knowledge base

### 3. Smart Scheduling

**Capability:** AI-optimized daily schedules for technicians.

**Features:**
- Route optimization
- Traffic consideration
- Priority balancing
- Skill matching
- Part availability awareness

### 4. Predictive Maintenance

**Capability:** AI predicts failures before they happen.

**Features:**
- Pattern analysis across fleet
- Wear prediction models
- Proactive alerts
- "Motor will need attention in 3 months"

### 5. Self-Writing Reports

**Capability:** Complete professional reports generated automatically.

**Features:**
- Job data synthesis
- Professional language
- Building manager appropriate
- One-tap send
- Template customization

### 6. Colleague Finder

**Capability:** Find nearby expert when stuck.

**Features:**
- Skill-matched search
- Proximity awareness
- Availability status
- Context briefing for helper
- "Maria is 2km away, she's solved this 12 times"

### 7. Anonymous Knowledge Network

**Capability:** Share knowledge without employer attribution.

**Features:**
- Anonymous contribution option
- Knowledge still tracked privately
- No fear of retaliation
- Build the commons

### 8. Building Health Score

**Capability:** Single number representing building condition.

**Features:**
- 0-100 score
- Multi-factor calculation
- Trend analysis
- Peer comparison
- Predictive forecasting

---

## Integrations

### Native Integrations

| System | Integration Type |
|--------|------------------|
| Google Workspace | Calendar, Drive |
| Microsoft 365 | Outlook, SharePoint |
| Xero | Invoicing |
| MYOB | Accounting |
| QuickBooks | Accounting |

### API Capabilities

- REST API (full CRUD)
- Webhooks (real-time events)
- OAuth 2.0 authentication
- Rate limiting
- OpenAPI 3.1 spec

### Future Integrations

- BMS connectors
- IoT device integration
- Manufacturer APIs
- ERP systems

---

## Mobile Experience

### Progressive Web App (PWA)

**Features:**
- Works offline
- Push notifications
- Home screen install
- Camera access
- GPS integration

### Offline Capabilities

- View assigned jobs
- Access equipment history
- Log work (syncs when online)
- Access downloaded manuals
- Use cached knowledge

### Auto-Offline Mode

**Capability:** Automatically switches to high-contrast offline mode when entering areas with no signal (elevator shafts).

**Features:**
- Signal strength detection
- Auto-mode switch
- Flashlight integration
- Essential data cached
- Auto-sync on reconnection

---

## Reporting

### Standard Reports

- Work order summary
- Contractor performance
- Equipment health
- Compliance status
- Cost analysis
- Building health trends

### Custom Reports

- Report builder
- Scheduled delivery
- Multiple formats (PDF, Excel)
- Branding options

### AI-Generated Reports

- Natural language summaries
- Trend analysis
- Recommendations
- Executive briefings

---

**[← Back to API Reference](api.md)** | **[Next: Implementation →](implementation.md)**


<!-- FILE: docs/reference/quick-reference.md -->

# SiteSync V3 - Quick Reference

## Cheatsheet & Lookup Guide

> This document provides quick access to commonly needed information, enums, patterns, and reference material.

---

## The Tagline

```
╔══════════════════════════════════════════════════════════════════╗
║                                                                  ║
║         YOUR BUILDING. YOUR DATA. YOUR INTELLIGENCE.             ║
║                                                                  ║
║                  Contractors come and go.                        ║
║                  Your building remembers forever.                ║
║                                                                  ║
╚══════════════════════════════════════════════════════════════════╝
```

### Why It Works

| Element | Purpose |
|---------|---------|
| "YOUR" (×3) | Hammers ownership - the core differentiator |
| "BUILDING → DATA → INTELLIGENCE" | Escalation - not just storage, but wisdom |
| "Contractors come and go" | Acknowledges reality without blame |
| "Your building remembers forever" | Building as protagonist, permanence |

### Where To Use It

| Location | Format |
|----------|--------|
| **Website hero** | Full tagline, large text |
| **Pitch deck slide 1** | Full tagline |
| **Email signatures** | Line 1 only |
| **App loading screen** | Full tagline |
| **Marketing materials** | Full tagline |
| **Social media bio** | Line 1 only |
| **Business cards** | Line 2 only ("Your building remembers forever") |

### Variations

**Full (preferred):**
> YOUR BUILDING. YOUR DATA. YOUR INTELLIGENCE.
> Contractors come and go. Your building remembers forever.

**Short (Line 1 only):**
> YOUR BUILDING. YOUR DATA. YOUR INTELLIGENCE.

**Emotional (Line 2 only):**
> Contractors come and go. Your building remembers forever.

**Ultra-short:**
> Your building remembers forever.

---

## Key Enums

### Elevator Status

```python
'operational'      # Running normally
'degraded'         # Running with issues
'out_of_service'   # Not running
'maintenance'      # Scheduled maintenance
'decommissioned'   # No longer in use
```

### Work Order Status

```python
'draft'        # Created but not submitted
'pending'      # Awaiting assignment
'scheduled'    # Assigned and scheduled
'in_progress'  # Work started
'on_hold'      # Paused
'completed'    # Work finished
'cancelled'    # Cancelled
'invoiced'     # Invoiced/closed
```

### Work Order Priority

```python
'emergency'    # Immediate response
'high'         # Same day
'medium'       # Within 48 hours
'low'          # Within week
'scheduled'    # Planned maintenance
```

### Work Order Type

```python
'breakdown'      # Equipment failure
'preventive'     # Scheduled maintenance
'inspection'     # Safety inspection
'installation'   # New installation
'modernization'  # Upgrade project
'callback'       # Return visit
'audit'          # Compliance audit
```

### Audit Event Types

```python
'work_order_created'
'work_order_updated'
'work_order_assigned'
'work_order_started'
'work_order_completed'
'work_order_cancelled'
'elevator_created'
'elevator_updated'
'elevator_status_changed'
'inspection_scheduled'
'inspection_completed'
'part_used'
'labor_logged'
'diagnosis_requested'
'document_uploaded'
'user_action'
```

---

## File Locations

```
DEVELOPMENT DIRECTORIES
═══════════════════════════════════════════════════

V2 Source (Library):
~/Desktop/sitesync-claudeV2/

V3 Source (New System):
~/Desktop/sitesync-v3/

Design Documents:
~/Desktop/SiteSync_V3_Design/

Reference Guide:
~/Desktop/sitesync/SITESYNC_V3_REFERENCE/

V2 Data (Symlinked):
~/Desktop/sitesync-v3/data → ../sitesync-claudeV2/data
```

---

## Technology Stack Quick Reference

### Backend

| What | Technology |
|------|------------|
| Language | Python 3.12+ |
| Framework | FastAPI 0.115+ |
| ORM | SQLAlchemy 2.0+ |
| Database Driver | asyncpg |
| Validation | Pydantic 2.10+ |
| AI | Pydantic AI 0.0.9+ |

### Database

| What | Technology |
|------|------------|
| Primary | PostgreSQL 16+ |
| Vectors | pgvector |
| Text Search | pg_trgm |
| Cache | Redis 7+ |

### Frontend

| What | Technology |
|------|------------|
| Framework | React 18 |
| Language | TypeScript 5+ |
| State | TanStack Query |
| Styling | Tailwind CSS |

### Infrastructure

| What | Technology |
|------|------------|
| Compute | Cloud Run |
| Database | Cloud SQL |
| Cache | Memorystore |
| Storage | Cloud Storage |

---

## Common Patterns

### Set Tenant Context

```python
# Always set before queries
await session.execute(
    f"SET app.current_org = '{organization_id}'"
)
```

### V2 Import Bridge

```python
from sitesync.adapters.gemini import GeminiAdapter
from sitesync.domains.diagnosis import DiagnosisAgent

agent = DiagnosisAgent(adapter=GeminiAdapter())
result = await agent.diagnose(fault_code, symptoms)
```

### Repository Pattern

```python
class PostgresRepository:
    def __init__(self, session: AsyncSession):
        self.session = session

    async def get(self, id: UUID) -> Model | None:
        result = await self.session.execute(
            select(DBModel).where(DBModel.id == id)
        )
        row = result.scalar_one_or_none()
        return Model.model_validate(row) if row else None
```

### Service Pattern

```python
class Service:
    def __init__(
        self,
        repository: Repository,
        audit: AuditService,
    ):
        self.repository = repository
        self.audit = audit

    async def create(self, data: CreateDTO, actor_id: UUID) -> Model:
        result = await self.repository.create(data)
        await self.audit.log_event(
            event_type="created",
            entity_id=result.id,
            actor_id=actor_id,
            data=result.model_dump(),
        )
        return result
```

### FastAPI Router

```python
@router.get("/{id}", response_model=Response)
async def get_item(
    id: UUID,
    user = Depends(get_current_user),
    service = Depends(get_service),
):
    item = await service.get(id)
    if not item:
        raise HTTPException(404, "Not found")
    return Response(data=item)
```

---

## API Quick Reference

### Authentication

```
POST /auth/login          # Get tokens
POST /auth/refresh        # Refresh access token
POST /auth/logout         # Invalidate tokens
```

### Sites

```
GET    /sites             # List sites
POST   /sites             # Create site
GET    /sites/{id}        # Get site
PATCH  /sites/{id}        # Update site
DELETE /sites/{id}        # Delete site
GET    /sites/{id}/health # Get health score
```

### Elevators

```
GET    /elevators              # List elevators
POST   /elevators              # Create elevator
GET    /elevators/{id}         # Get elevator
PATCH  /elevators/{id}         # Update elevator
GET    /elevators/{id}/history # Get history
PATCH  /elevators/{id}/status  # Update status
```

### Work Orders

```
GET    /work-orders                    # List
POST   /work-orders                    # Create
GET    /work-orders/{id}               # Get
PATCH  /work-orders/{id}               # Update
POST   /work-orders/{id}/assign        # Assign
POST   /work-orders/{id}/start         # Start
POST   /work-orders/{id}/complete      # Complete
```

### Diagnosis

```
POST   /diagnosis/request              # Request AI diagnosis
GET    /diagnosis/{id}                 # Get diagnosis
POST   /diagnosis/{id}/feedback        # Submit feedback
```

### Inventory

```
GET    /inventory                      # List items
GET    /inventory/van-stock            # Get van stock
GET    /inventory/nearby/{part}        # Find nearby
```

---

## Database Quick Reference

### Core Tables

```
organizations        # Tenant root
users               # User accounts
sites               # Buildings/locations
elevators           # Assets
contractors         # Service providers
work_orders         # Jobs
work_order_tasks    # Task checklist
work_order_parts    # Parts used
work_order_labor    # Labor logged
inventory_items     # Parts catalog
stock_locations     # Van/warehouse stock
audit_events        # Immutable log
```

### Profile Tables

```
technician_profiles      # Tech profiles (platform-wide)
profile_certifications   # Verified certs
knowledge_contributions  # Shared knowledge
```

### RLS Policy

```sql
CREATE POLICY org_isolation ON {table}
    USING (organization_id = current_setting('app.current_org')::uuid);
```

---

## Health Score Calculation

```
BUILDING HEALTH SCORE (0-100)
═══════════════════════════════════════════════════

Component               Weight
─────────────────────────────────
Equipment Condition      25%
Maintenance Compliance   25%
Incident Frequency       20%
First-Time Fix Rate      15%
Predictive Risk          15%
─────────────────────────────────
Total                   100%
```

---

## Emergency Categories

| Category | Response | Examples |
|----------|----------|----------|
| **Cat 1** | Immediate | Trapped passengers, fire |
| **Cat 2** | 1 hour | Out of service, HVAC fail |
| **Cat 3** | Next day | Intermittent fault, complaints |

---

## Pricing Quick Reference

### Buildings

| Tier | Price | Features |
|------|-------|----------|
| Free | $0 | 10 lookups/month |
| Pro | $29/mo | Unlimited |
| Enterprise | $500+/mo | Custom |

### Volume Discounts

| Buildings | Price |
|-----------|-------|
| 1-10 | $29/mo |
| 11-50 | $24/mo |
| 51+ | $19/mo |

### Technicians

| Tier | Price |
|------|-------|
| Basic | $0 |
| Premium | $9/mo |

### Marketplace

| Type | Fee |
|------|-----|
| P2P | 5% |
| Supplier | 3% |

---

## Success Metrics

| Metric | Target |
|--------|--------|
| Task completion time | -85% |
| First-time fix rate | 90%+ |
| Technician productivity | +30% |
| NPS | >70 |
| Annual churn | <5% |

---

## Common Commands

### Development

```bash
# Start development server
uvicorn sitesync_v3.interfaces.api.main:app --reload

# Run tests
pytest

# Run with coverage
pytest --cov=sitesync_v3

# Type check
mypy sitesync_v3

# Lint
ruff check sitesync_v3

# Format
ruff format sitesync_v3
```

### Database

```bash
# Create migration
alembic revision --autogenerate -m "description"

# Run migrations
alembic upgrade head

# Rollback one
alembic downgrade -1
```

### Docker

```bash
# Build
docker build -t sitesync-api .

# Run
docker-compose up -d

# Logs
docker-compose logs -f api
```

---

## Document Map

| Location | Purpose | Audience |
|----------|---------|----------|
| docs/README.md | Navigation hub | Everyone |
| docs/explanation/vision.md | Core message | Everyone |
| docs/explanation/for-buildings.md | Building value prop | Sales, Product |
| docs/explanation/for-technicians.md | Tech value prop | Sales, Product |
| docs/explanation/platform-ecosystem.md | Ecosystem design | Strategy |
| docs/reference/architecture.md | System design | Engineering |
| docs/reference/data-model.md | Database schemas | Engineering |
| docs/explanation/triforce-ai.md | AI system | Engineering |
| docs/reference/api.md | API docs | Engineering |
| docs/reference/features.md | Feature specs | Product |
| docs/reference/implementation.md | Code patterns | Engineering |
| docs/strategy/market-strategy.md | GTM plan | Leadership |
| docs/reference/quick-reference.md | Cheatsheet | Everyone |

---

## Contact & Resources

```
Documentation:  ~/Desktop/sitesync/SITESYNC_V3_REFERENCE/
Source (V3):    ~/Desktop/sitesync-v3/
Source (V2):    ~/Desktop/sitesync-claudeV2/
```

---

**[← Back to Market Strategy](../strategy/market-strategy.md)** | **[Back to Documentation Hub →](../README.md)**


<!-- FILE: docs/reference/ui-ux-spec.md -->

# UI/UX Specification

> Design system and interface patterns for SiteSync

## Design Principles

### 1. Mobile-First
Technicians work in the field. Design for phone screens first, then expand.

### 2. Minimal Clicks
Every tap costs time. Reduce steps to complete common tasks.

### 3. Progressive Disclosure
Show essential info first. Hide details behind taps.

### 4. Invisible AI
AI assists silently. No "AI is thinking" spinners. Results appear ready.

### 5. Offline-Capable
Core functions work without connectivity. Sync when online.

---

## Information Architecture

### Navigation Hierarchy

**Building Managers:**
```
Dashboard → Sites → Assets → Work Orders
```

**Technicians:**
```
My Schedule → Work Order Detail → Complete Job
```

### Primary Views

| View | Primary User | Purpose |
|------|--------------|---------|
| Dashboard | Manager | Overview of all sites |
| Site Detail | Manager | Single building deep-dive |
| Schedule | Technician | Today's jobs |
| Work Order | Both | Job details & actions |
| Asset | Both | Equipment history |

---

## Dashboard (Building Manager)

### Layout

| Zone | Content | Priority |
|------|---------|----------|
| **Header** | Building selector, notifications | Fixed |
| **Hero** | Health Score (large number) | Highest |
| **Trade Grid** | 6 trade summary cards | High |
| **Insights** | AI recommendations (3-5 items) | Medium |
| **Upcoming** | Next 5 scheduled items | Medium |
| **Activity** | Recent events feed | Low |

### Health Score Display

**Visual:**
- Large number (48-72px)
- Color-coded ring: Green (75+), Yellow (50-74), Red (<50)
- Trend arrow: ↑ improving, ↓ declining, → stable
- Comparison text: "Top 15% of similar buildings"

**Behavior:**
- Tap → drill into Health Score breakdown
- Updates in real-time when data changes

### Trade Summary Grid

**Layout:** 2x3 grid on mobile, 6 columns on desktop

**Each card shows:**
- Trade icon + name
- Health score (mini)
- Asset count
- Open work orders count
- Status indicator (dot: green/yellow/red)

**Behavior:**
- Tap card → filter to that trade
- Long press → quick actions menu

### AI Insights Panel

**Content:** 3-5 actionable recommendations

**Format per insight:**
```
[Icon] [Headline]
[Supporting detail - one line]
[Action button if applicable]
```

**Examples:**
- "Lift 2 door operator showing wear" → [Schedule Service]
- "Fire inspection due in 14 days" → [View Schedule]
- "HVAC filter replacement recommended" → [Create Work Order]

**Behavior:**
- Swipe to dismiss (remembers for 7 days)
- Tap → expand with full details
- Maximum 5 visible, "Show more" for additional

---

## Work Order List

### Layout Options

**Default: Card View**
Each work order as a card (better for scanning)

**Alternative: Table View**
Dense list (better for bulk management)

### Work Order Card

**Visual hierarchy (top to bottom):**

1. **Priority badge** — Color-coded chip (Emergency=red, High=orange, Medium=blue, Low=gray)
2. **Title** — Bold, 1-2 lines max
3. **Location** — Site name + Asset number
4. **Status pill** — Current state
5. **AI insight** — If available, one-line summary
6. **Footer** — Assigned to, time info

**Dimensions:**
- Full width on mobile
- Max 400px on desktop
- Padding: 16px
- Border radius: 8px
- Shadow: subtle (elevation 1)

**States:**
- Default: white background
- Selected: light blue background
- Overdue: red left border

**Actions:**
- Tap → Open detail
- Swipe right → Quick assign
- Swipe left → Change status

### Filters

**Always visible:** Status, Priority
**Expandable:** Trade, Date range, Assigned to

**Behavior:**
- Active filters shown as removable chips
- Filter counts shown in dropdown options
- "Clear all" when any filter active

---

## Work Order Detail

### Mobile Layout (Primary)

**Screen sections (scrollable):**

1. **Header (sticky)**
   - Back button
   - WO number
   - Status dropdown
   - Actions menu (•••)

2. **Summary Card**
   - Priority + Type badges
   - Title (large)
   - Asset link → tap to view
   - Site link → tap to view

3. **AI Diagnosis Card** (if available)
   - Confidence indicator (pie or bar)
   - Likely cause
   - Suggested parts (checkable)
   - "Why this diagnosis?" expandable

4. **Details Section**
   - Description
   - Fault details
   - Reported by
   - Timestamps

5. **Assignment Section**
   - Assigned contractor (avatar + name)
   - Scheduled time
   - [Reassign] button

6. **Activity Timeline**
   - Chronological events
   - Collapsible older items

7. **Action Bar (sticky bottom)**
   - Primary action (context-dependent)
   - e.g., [Start Job] or [Complete] or [Assign]

### Status Transitions

**Allowed actions by status:**

| Current | Actions Available |
|---------|-------------------|
| `draft` | Submit, Edit, Delete |
| `pending` | Assign, Edit, Cancel |
| `scheduled` | Start, Reassign, Cancel |
| `in_progress` | Complete, Pause, Add Notes |
| `on_hold` | Resume, Cancel |
| `completed` | Reopen, Invoice |

### Complete Job Flow

**Step 1: Resolution**
- Required: Resolution type dropdown
- Required: Resolution notes (min 10 chars)
- Optional: Root cause

**Step 2: Parts Used**
- Add from inventory (searchable)
- Or manual entry (part, qty, cost)
- Van stock auto-suggested

**Step 3: Labor**
- Auto-calculated from start/end
- Adjustable
- Labor type: Regular, Overtime, Emergency

**Step 4: Confirm**
- Summary of costs
- [Complete Job] button

---

## Technician Mobile App

### Schedule View

**Layout:** Vertical timeline (infinite scroll)

**Day header:** Sticky when scrolling

**Job cards show:**
- Time block (start - end)
- Priority indicator
- Title
- Location
- [Navigate] button

**Gestures:**
- Pull down → refresh
- Swipe between days
- Tap job → detail
- Long press → quick actions

### On-Site Job Flow

**Step 1: Arrive**
- [I've Arrived] button
- Auto-detects location (optional)
- Starts timer

**Step 2: Work**
- View AI diagnosis
- Access asset history
- View/download manuals
- Add photos
- Add notes (voice or text)

**Step 3: Parts**
- Select from van stock (auto-suggested based on diagnosis)
- Scan barcode
- Record usage

**Step 4: Complete**
- Resolution notes
- Customer signature (optional)
- [Complete Job]

### Offline Mode

**Available offline:**
- Today's scheduled jobs (pre-cached)
- Asset details for scheduled jobs
- Manuals for scheduled assets
- Parts list for van stock

**Queued for sync:**
- Status changes
- Notes added
- Photos taken
- Time logged

**Visual indicator:**
- Offline banner at top
- Sync status icon
- Pending changes count

---

## Components Library

### Buttons

| Type | Use for | Style |
|------|---------|-------|
| Primary | Main action | Solid, brand color |
| Secondary | Alternative action | Outlined |
| Destructive | Delete, cancel | Red |
| Ghost | Tertiary actions | Text only |

**Sizes:** Large (48px), Medium (40px), Small (32px)

### Status Pills

| Status | Color | Background |
|--------|-------|------------|
| Draft | Gray | Gray-100 |
| Pending | Yellow | Yellow-100 |
| Scheduled | Blue | Blue-100 |
| In Progress | Purple | Purple-100 |
| Completed | Green | Green-100 |
| Cancelled | Red | Red-100 |

### Priority Badges

| Priority | Color | Icon |
|----------|-------|------|
| Emergency | Red-600 | Alert triangle |
| High | Orange-500 | Arrow up |
| Medium | Blue-500 | Minus |
| Low | Gray-400 | Arrow down |

### Health Score

| Range | Color | Label |
|-------|-------|-------|
| 90-100 | Green-500 | Excellent |
| 75-89 | Green-400 | Good |
| 60-74 | Yellow-500 | Fair |
| 40-59 | Orange-500 | Poor |
| 0-39 | Red-500 | Critical |

### Trade Icons

Use consistent iconography:
- Lifts: Elevator icon
- HVAC: Snowflake/thermometer
- Electrical: Lightning bolt
- Plumbing: Water drop
- Fire: Flame
- Security: Shield

---

## Responsive Breakpoints

| Name | Width | Layout |
|------|-------|--------|
| Mobile | < 640px | Single column |
| Tablet | 640-1024px | 2 columns |
| Desktop | > 1024px | 3+ columns, sidebar |

### Mobile Adaptations

- Navigation → bottom tab bar
- Filters → slide-up sheet
- Tables → cards
- Side-by-side → stacked
- Hover states → tap states

---

## Performance Targets

| Metric | Target |
|--------|--------|
| First paint | < 1.5s |
| Full load | < 3s |
| Interaction response | < 100ms |
| Scroll | 60 fps |
| Offline launch | < 500ms |

---

## Accessibility

- Touch targets: minimum 44x44px
- Color contrast: WCAG AA (4.5:1)
- Screen reader labels on all interactive elements
- Keyboard navigation on desktop
- Focus indicators visible
- Reduced motion option

---

**[← Back to Docs](../README.md)**


<!-- FILE: docs/explanation/triforce-ai.md -->

<!--
---
title: Triforce AI System
description: Multi-model AI architecture for fault diagnosis and intelligent automation
version: 3.0.0
last_updated: 2025-12
status: stable
implementation_status: design
audience: developer, ai_assistant
prerequisites:
  - Understanding of LLMs
  - Basic async Python knowledge
related_docs:
  - /docs/GLOSSARY.md (AI terminology)
  - /docs/reference/data-model.md (DiagnosisResult schema)
  - /AI_CONTEXT.md (system overview)
---
-->

# SiteSync V3 - Triforce AI System

## Multi-Model AI Architecture

> This document describes the Triforce AI system - SiteSync's multi-model approach to AI-assisted diagnosis, knowledge retrieval, and intelligent automation.

## What is Triforce?

Triforce is a multi-model AI system that:
1. Queries multiple LLMs in parallel (Gemini, Claude, GPT-4)
2. Aggregates responses using consensus voting
3. Validates answers against a knowledge base
4. Produces structured, type-safe outputs

**Key Principle**: Multiple models catch each other's mistakes, producing more reliable results than any single model.

---

## Architecture Overview

```
TRIFORCE AI ARCHITECTURE
══════════════════════════════════════════════════════════════════

┌─────────────────────────────────────────────────────────────────┐
│                         TRIFORCE V3                              │
├─────────────────────────────────────────────────────────────────┤
│                                                                  │
│  ┌───────────┐   ┌───────────┐   ┌───────────┐                  │
│  │  Gemini   │   │  Claude   │   │   GPT-4   │  ← JURY          │
│  │  2.0 Pro  │   │  Sonnet   │   │   Turbo   │    (Parallel)    │
│  └─────┬─────┘   └─────┬─────┘   └─────┬─────┘                  │
│        │               │               │                         │
│        └───────────────┼───────────────┘                         │
│                        ▼                                         │
│              ┌─────────────────┐                                 │
│              │    CONSENSUS    │  ← Weighted voting              │
│              │     ENGINE      │                                 │
│              └────────┬────────┘                                 │
│                       ▼                                          │
│  ┌─────────────────────────────────────────────────────────┐    │
│  │                    WITNESS (Validation)                  │    │
│  │  ┌──────────────┐  ┌──────────────┐  ┌──────────────┐   │    │
│  │  │ Knowledge    │  │ Hybrid       │  │ Tool Result  │   │    │
│  │  │ Base         │  │ Search       │  │ Verification │   │    │
│  │  └──────────────┘  └──────────────┘  └──────────────┘   │    │
│  └──────────────────────────┬──────────────────────────────┘    │
│                             ▼                                    │
│              ┌─────────────────────────┐                         │
│              │         JUDGE           │  ← Final synthesis      │
│              │   (Claude Opus 4.5)     │    with skills          │
│              └─────────────────────────┘                         │
│                             │                                    │
│                             ▼                                    │
│  ┌─────────────────────────────────────────────────────────┐    │
│  │                 HIERARCHICAL MEMORY                      │    │
│  │  ┌───────────┐  ┌───────────┐  ┌────────────┐           │    │
│  │  │ Episodic  │  │ Semantic  │  │ Procedural │           │    │
│  │  │ (Tasks)   │  │ (Facts)   │  │ (Skills)   │           │    │
│  │  └───────────┘  └───────────┘  └────────────┘           │    │
│  └─────────────────────────────────────────────────────────┘    │
│                                                                  │
└─────────────────────────────────────────────────────────────────┘

══════════════════════════════════════════════════════════════════
```

---

## Core Components

### 1. Jury System

The jury consists of multiple LLMs that evaluate problems in parallel, providing diverse perspectives.

```python
# sitesync_v3/core/triforce/jury.py

from dataclasses import dataclass
from enum import Enum
from typing import Protocol
import asyncio

class JuryModel(str, Enum):
    GEMINI_PRO = "gemini-2.0-pro"
    CLAUDE_SONNET = "claude-sonnet-4-20250514"
    GPT4_TURBO = "gpt-4-turbo"

@dataclass
class JuryResponse:
    """Response from a single jury member."""
    model: JuryModel
    answer: str
    confidence: float  # 0.0 - 1.0
    reasoning: str
    sources: list[str]
    latency_ms: int

class JuryMember(Protocol):
    """Protocol for jury member implementations."""

    async def evaluate(
        self,
        prompt: str,
        context: dict,
    ) -> JuryResponse:
        """Evaluate a prompt and return response."""
        ...

class Jury:
    """Multi-model jury for parallel evaluation."""

    def __init__(
        self,
        members: list[JuryMember],
        timeout_seconds: float = 30.0,
    ):
        self.members = members
        self.timeout = timeout_seconds

    async def deliberate(
        self,
        prompt: str,
        context: dict,
    ) -> list[JuryResponse]:
        """
        Run all jury members in parallel.

        Returns list of responses from each member.
        Handles timeouts and failures gracefully.
        """
        tasks = [
            asyncio.wait_for(
                member.evaluate(prompt, context),
                timeout=self.timeout
            )
            for member in self.members
        ]

        results = await asyncio.gather(*tasks, return_exceptions=True)

        responses = []
        for result in results:
            if isinstance(result, JuryResponse):
                responses.append(result)
            # Log failures but continue with available responses

        return responses
```

### 2. Consensus Engine

The consensus engine aggregates jury responses using configurable voting strategies.

```python
# sitesync_v3/core/triforce/consensus.py

from dataclasses import dataclass
from enum import Enum
from collections import Counter

class VotingStrategy(str, Enum):
    MAJORITY = "majority"          # Most common answer wins
    WEIGHTED = "weighted"          # Factor in confidence scores
    UNANIMOUS = "unanimous"        # All must agree
    QUORUM = "quorum"              # N of M must agree

@dataclass
class ConsensusResult:
    """Result of consensus voting."""
    answer: str
    confidence: float
    agreement_rate: float
    strategy_used: VotingStrategy
    supporting_responses: list[JuryResponse]
    dissenting_responses: list[JuryResponse]

class ConsensusEngine:
    """Aggregate jury responses through voting."""

    # Default weights by model (can be tuned based on performance)
    DEFAULT_WEIGHTS = {
        JuryModel.GEMINI_PRO: 1.0,
        JuryModel.CLAUDE_SONNET: 1.2,  # Slightly higher for reasoning
        JuryModel.GPT4_TURBO: 1.0,
    }

    def __init__(
        self,
        strategy: VotingStrategy = VotingStrategy.WEIGHTED,
        weights: dict[JuryModel, float] | None = None,
        quorum_threshold: int = 2,
    ):
        self.strategy = strategy
        self.weights = weights or self.DEFAULT_WEIGHTS
        self.quorum_threshold = quorum_threshold

    def vote(
        self,
        responses: list[JuryResponse],
    ) -> ConsensusResult:
        """
        Aggregate responses using configured strategy.
        """
        if not responses:
            raise ValueError("No responses to vote on")

        if self.strategy == VotingStrategy.MAJORITY:
            return self._majority_vote(responses)
        elif self.strategy == VotingStrategy.WEIGHTED:
            return self._weighted_vote(responses)
        elif self.strategy == VotingStrategy.UNANIMOUS:
            return self._unanimous_vote(responses)
        elif self.strategy == VotingStrategy.QUORUM:
            return self._quorum_vote(responses)
        else:
            raise ValueError(f"Unknown strategy: {self.strategy}")

    def _weighted_vote(
        self,
        responses: list[JuryResponse],
    ) -> ConsensusResult:
        """
        Weighted voting based on model weights and confidence.
        """
        # Calculate weighted scores for each unique answer
        answer_scores: dict[str, float] = {}
        answer_responses: dict[str, list[JuryResponse]] = {}

        for response in responses:
            weight = self.weights.get(response.model, 1.0)
            score = weight * response.confidence

            if response.answer not in answer_scores:
                answer_scores[response.answer] = 0
                answer_responses[response.answer] = []

            answer_scores[response.answer] += score
            answer_responses[response.answer].append(response)

        # Find winning answer
        winning_answer = max(answer_scores, key=answer_scores.get)
        total_score = sum(answer_scores.values())

        supporting = answer_responses[winning_answer]
        dissenting = [
            r for r in responses
            if r.answer != winning_answer
        ]

        return ConsensusResult(
            answer=winning_answer,
            confidence=answer_scores[winning_answer] / total_score,
            agreement_rate=len(supporting) / len(responses),
            strategy_used=VotingStrategy.WEIGHTED,
            supporting_responses=supporting,
            dissenting_responses=dissenting,
        )

    def _majority_vote(
        self,
        responses: list[JuryResponse],
    ) -> ConsensusResult:
        """Simple majority voting."""
        answers = [r.answer for r in responses]
        counter = Counter(answers)
        winning_answer, count = counter.most_common(1)[0]

        supporting = [r for r in responses if r.answer == winning_answer]
        dissenting = [r for r in responses if r.answer != winning_answer]

        avg_confidence = sum(r.confidence for r in supporting) / len(supporting)

        return ConsensusResult(
            answer=winning_answer,
            confidence=avg_confidence,
            agreement_rate=count / len(responses),
            strategy_used=VotingStrategy.MAJORITY,
            supporting_responses=supporting,
            dissenting_responses=dissenting,
        )

    def _unanimous_vote(
        self,
        responses: list[JuryResponse],
    ) -> ConsensusResult:
        """Require unanimous agreement."""
        answers = set(r.answer for r in responses)

        if len(answers) == 1:
            answer = answers.pop()
            avg_confidence = sum(r.confidence for r in responses) / len(responses)
            return ConsensusResult(
                answer=answer,
                confidence=avg_confidence,
                agreement_rate=1.0,
                strategy_used=VotingStrategy.UNANIMOUS,
                supporting_responses=responses,
                dissenting_responses=[],
            )
        else:
            # No consensus - fall back to weighted
            return self._weighted_vote(responses)

    def _quorum_vote(
        self,
        responses: list[JuryResponse],
    ) -> ConsensusResult:
        """Require quorum threshold agreement."""
        answers = [r.answer for r in responses]
        counter = Counter(answers)
        winning_answer, count = counter.most_common(1)[0]

        if count >= self.quorum_threshold:
            supporting = [r for r in responses if r.answer == winning_answer]
            dissenting = [r for r in responses if r.answer != winning_answer]
            avg_confidence = sum(r.confidence for r in supporting) / len(supporting)

            return ConsensusResult(
                answer=winning_answer,
                confidence=avg_confidence,
                agreement_rate=count / len(responses),
                strategy_used=VotingStrategy.QUORUM,
                supporting_responses=supporting,
                dissenting_responses=dissenting,
            )
        else:
            # Quorum not met - fall back to weighted
            return self._weighted_vote(responses)
```

### 3. Witness Layer (Validation)

The witness layer validates and enriches jury responses with factual data.

```python
# sitesync_v3/core/triforce/witness.py

from dataclasses import dataclass
from typing import Protocol

@dataclass
class ValidationResult:
    """Result of witness validation."""
    is_valid: bool
    confidence_adjustment: float  # -1.0 to +1.0
    supporting_evidence: list[str]
    contradicting_evidence: list[str]
    enrichment_data: dict

class Witness(Protocol):
    """Protocol for witness implementations."""

    async def validate(
        self,
        claim: str,
        context: dict,
    ) -> ValidationResult:
        """Validate a claim against known data."""
        ...

class KnowledgeBaseWitness:
    """Validates against the knowledge base."""

    def __init__(self, knowledge_service):
        self.knowledge = knowledge_service

    async def validate(
        self,
        claim: str,
        context: dict,
    ) -> ValidationResult:
        """
        Search knowledge base for supporting or
        contradicting information.
        """
        # Search for relevant knowledge
        results = await self.knowledge.search(
            query=claim,
            equipment_type=context.get("equipment_type"),
            limit=10,
        )

        supporting = []
        contradicting = []

        for result in results:
            # Analyze if result supports or contradicts claim
            # This would use embedding similarity or another LLM
            if result.relevance_score > 0.8:
                supporting.append(result.content)

        confidence_adj = len(supporting) * 0.05 - len(contradicting) * 0.1

        return ValidationResult(
            is_valid=len(contradicting) == 0,
            confidence_adjustment=max(-0.5, min(0.5, confidence_adj)),
            supporting_evidence=supporting,
            contradicting_evidence=contradicting,
            enrichment_data={
                "related_fault_codes": [r.fault_code for r in results if r.fault_code],
                "related_procedures": [r.procedure_id for r in results if r.procedure_id],
            },
        )

class HybridSearchWitness:
    """Validates using hybrid search (vector + keyword)."""

    def __init__(self, search_service):
        self.search = search_service

    async def validate(
        self,
        claim: str,
        context: dict,
    ) -> ValidationResult:
        """
        Use hybrid search to find supporting documents.
        """
        results = await self.search.hybrid_search(
            query=claim,
            filters=context,
        )

        # Extract relevant evidence
        supporting = [
            r.snippet for r in results
            if r.relevance > 0.7
        ]

        return ValidationResult(
            is_valid=True,
            confidence_adjustment=0.1 if supporting else 0,
            supporting_evidence=supporting[:5],
            contradicting_evidence=[],
            enrichment_data={
                "document_references": [r.document_id for r in results[:5]],
            },
        )

class WitnessPanel:
    """Coordinates multiple witnesses."""

    def __init__(self, witnesses: list[Witness]):
        self.witnesses = witnesses

    async def validate_all(
        self,
        claim: str,
        context: dict,
    ) -> list[ValidationResult]:
        """Run all witnesses in parallel."""
        tasks = [
            witness.validate(claim, context)
            for witness in self.witnesses
        ]
        return await asyncio.gather(*tasks)

    def aggregate_validations(
        self,
        results: list[ValidationResult],
    ) -> ValidationResult:
        """Combine validation results."""
        all_supporting = []
        all_contradicting = []
        total_adjustment = 0
        all_enrichment = {}

        for result in results:
            all_supporting.extend(result.supporting_evidence)
            all_contradicting.extend(result.contradicting_evidence)
            total_adjustment += result.confidence_adjustment
            all_enrichment.update(result.enrichment_data)

        return ValidationResult(
            is_valid=len(all_contradicting) == 0,
            confidence_adjustment=total_adjustment / len(results),
            supporting_evidence=all_supporting,
            contradicting_evidence=all_contradicting,
            enrichment_data=all_enrichment,
        )
```

### 4. Judge (Final Synthesis)

The judge makes the final decision, incorporating jury consensus and witness validation.

```python
# sitesync_v3/core/triforce/judge.py

from pydantic import BaseModel
from pydantic_ai import Agent

class DiagnosisOutput(BaseModel):
    """Structured output for diagnosis."""
    fault_code: str
    severity: str  # 'critical', 'high', 'medium', 'low'
    primary_cause: str
    secondary_causes: list[str]
    recommended_actions: list[str]
    parts_needed: list[str]
    estimated_repair_time_minutes: int
    confidence: float
    reasoning: str

class Judge:
    """Final synthesis and decision making."""

    def __init__(self):
        self.agent = Agent(
            'claude-opus-4-5-20251101',
            result_type=DiagnosisOutput,
            system_prompt=self._build_system_prompt(),
        )

    def _build_system_prompt(self) -> str:
        return """
You are the final judge in an AI diagnosis system for elevator faults.

You receive:
1. A consensus from multiple AI models (the "jury")
2. Validation results from knowledge base searches (the "witnesses")
3. Equipment context and history

Your job is to synthesize all inputs and provide the final diagnosis.

Guidelines:
- If jury and witnesses agree, be confident
- If they disagree, explain the uncertainty
- Always consider equipment-specific quirks
- Prioritize safety-critical issues
- Recommend the minimum necessary actions

Output must be structured and actionable.
"""

    async def decide(
        self,
        consensus: ConsensusResult,
        validation: ValidationResult,
        context: dict,
    ) -> DiagnosisOutput:
        """
        Make final diagnosis decision.
        """
        prompt = self._build_prompt(consensus, validation, context)
        result = await self.agent.run(prompt)
        return result.data

    def _build_prompt(
        self,
        consensus: ConsensusResult,
        validation: ValidationResult,
        context: dict,
    ) -> str:
        return f"""
## Jury Consensus
Answer: {consensus.answer}
Confidence: {consensus.confidence:.0%}
Agreement: {consensus.agreement_rate:.0%}

## Supporting Evidence
{chr(10).join(f'- {e}' for e in validation.supporting_evidence[:5])}

## Equipment Context
Manufacturer: {context.get('manufacturer', 'Unknown')}
Model: {context.get('model', 'Unknown')}
Age: {context.get('age_years', 'Unknown')} years
Known Quirks: {', '.join(context.get('known_quirks', []))}

## Reported Symptoms
{context.get('symptoms', 'No symptoms reported')}

## Fault Code
{context.get('fault_code', 'No fault code')}

Please provide your final diagnosis.
"""
```

---

## Hierarchical Memory

### Memory Architecture

```python
# sitesync_v3/core/triforce/memory.py

from dataclasses import dataclass
from datetime import datetime
from typing import Protocol
from uuid import UUID

@dataclass
class MemoryEntry:
    """A single memory entry."""
    id: UUID
    content: str
    memory_type: str  # 'episodic', 'semantic', 'procedural'
    relevance_score: float
    created_at: datetime
    last_accessed: datetime
    access_count: int
    metadata: dict

class MemoryStore(Protocol):
    """Protocol for memory storage."""

    async def store(self, entry: MemoryEntry) -> None: ...
    async def retrieve(self, query: str, limit: int) -> list[MemoryEntry]: ...
    async def update_access(self, entry_id: UUID) -> None: ...

class EpisodicMemory:
    """
    Task-specific, short-term memory.

    Stores recent interactions, current task context,
    and temporary working memory.

    Examples:
    - "Last time with this KONE unit, F505 was humidity-related"
    - "User prefers brief responses"
    - "Current task: diagnose door fault on Lift 2"
    """

    def __init__(self, store: MemoryStore):
        self.store = store

    async def remember_task(
        self,
        task_id: UUID,
        context: dict,
    ) -> None:
        """Store task-specific memory."""
        entry = MemoryEntry(
            id=UUID(),
            content=str(context),
            memory_type="episodic",
            relevance_score=1.0,
            created_at=datetime.now(),
            last_accessed=datetime.now(),
            access_count=1,
            metadata={"task_id": str(task_id)},
        )
        await self.store.store(entry)

    async def recall_similar_tasks(
        self,
        query: str,
        limit: int = 5,
    ) -> list[MemoryEntry]:
        """Retrieve similar past tasks."""
        return await self.store.retrieve(query, limit)

class SemanticMemory:
    """
    Factual, long-term knowledge.

    Stores facts, definitions, and learned information
    that persists across sessions.

    Examples:
    - "F505 means door zone fault"
    - "KONE MonoSpace uses EcoDisc drive"
    - "Standard door close time is 3.5 seconds"
    """

    def __init__(self, store: MemoryStore):
        self.store = store

    async def learn_fact(
        self,
        fact: str,
        source: str,
        confidence: float,
    ) -> None:
        """Store a factual memory."""
        entry = MemoryEntry(
            id=UUID(),
            content=fact,
            memory_type="semantic",
            relevance_score=confidence,
            created_at=datetime.now(),
            last_accessed=datetime.now(),
            access_count=1,
            metadata={"source": source},
        )
        await self.store.store(entry)

    async def recall_facts(
        self,
        query: str,
        limit: int = 10,
    ) -> list[MemoryEntry]:
        """Retrieve relevant facts."""
        return await self.store.retrieve(query, limit)

class ProceduralMemory:
    """
    Skills and procedures.

    Stores how to do things - procedures, workflows,
    and learned skills.

    Examples:
    - "How to diagnose door faults step by step"
    - "Procedure for KONE controller reset"
    - "Best practices for safety circuit testing"
    """

    def __init__(self, store: MemoryStore):
        self.store = store

    async def learn_procedure(
        self,
        name: str,
        steps: list[str],
        equipment_type: str | None = None,
    ) -> None:
        """Store a procedure."""
        content = f"{name}\n" + "\n".join(f"{i+1}. {s}" for i, s in enumerate(steps))
        entry = MemoryEntry(
            id=UUID(),
            content=content,
            memory_type="procedural",
            relevance_score=1.0,
            created_at=datetime.now(),
            last_accessed=datetime.now(),
            access_count=1,
            metadata={
                "name": name,
                "equipment_type": equipment_type,
                "step_count": len(steps),
            },
        )
        await self.store.store(entry)

    async def recall_procedures(
        self,
        query: str,
        equipment_type: str | None = None,
        limit: int = 5,
    ) -> list[MemoryEntry]:
        """Retrieve relevant procedures."""
        # Filter by equipment type if specified
        return await self.store.retrieve(query, limit)

class HierarchicalMemory:
    """
    Unified interface to all memory types.
    """

    def __init__(
        self,
        episodic: EpisodicMemory,
        semantic: SemanticMemory,
        procedural: ProceduralMemory,
    ):
        self.episodic = episodic
        self.semantic = semantic
        self.procedural = procedural

    async def recall(
        self,
        query: str,
        memory_types: list[str] | None = None,
        limit_per_type: int = 5,
    ) -> dict[str, list[MemoryEntry]]:
        """
        Recall relevant memories from specified types.
        """
        types = memory_types or ["episodic", "semantic", "procedural"]
        results = {}

        if "episodic" in types:
            results["episodic"] = await self.episodic.recall_similar_tasks(
                query, limit_per_type
            )
        if "semantic" in types:
            results["semantic"] = await self.semantic.recall_facts(
                query, limit_per_type
            )
        if "procedural" in types:
            results["procedural"] = await self.procedural.recall_procedures(
                query, limit=limit_per_type
            )

        return results

    async def consolidate(self) -> None:
        """
        Memory consolidation - move short-term to long-term.

        Called during idle periods to:
        - Promote frequently accessed episodic to semantic
        - Update relevance scores
        - Prune rarely used memories
        """
        # Implementation depends on storage backend
        pass
```

---

## Skills Manager

### Dynamic Skill Loading

```python
# sitesync_v3/core/triforce/skills.py

from dataclasses import dataclass
from pathlib import Path
import yaml

@dataclass
class Skill:
    """A loadable skill definition."""
    name: str
    description: str
    prompt_template: str
    required_context: list[str]
    output_format: str
    examples: list[dict]

class SkillsManager:
    """Load and inject specialized skills."""

    def __init__(self, skills_dir: Path):
        self.skills_dir = skills_dir
        self._skills_cache: dict[str, Skill] = {}

    def load_skill(self, skill_name: str) -> Skill:
        """Load a skill definition from YAML."""
        if skill_name in self._skills_cache:
            return self._skills_cache[skill_name]

        skill_path = self.skills_dir / f"{skill_name}.yaml"
        if not skill_path.exists():
            raise ValueError(f"Skill not found: {skill_name}")

        with open(skill_path) as f:
            data = yaml.safe_load(f)

        skill = Skill(
            name=data["name"],
            description=data["description"],
            prompt_template=data["prompt_template"],
            required_context=data.get("required_context", []),
            output_format=data.get("output_format", "text"),
            examples=data.get("examples", []),
        )

        self._skills_cache[skill_name] = skill
        return skill

    def list_skills(self) -> list[str]:
        """List available skills."""
        return [
            p.stem for p in self.skills_dir.glob("*.yaml")
        ]

    def select_skills_for_task(
        self,
        task_type: str,
        equipment_type: str | None = None,
    ) -> list[Skill]:
        """
        Automatically select relevant skills for a task.
        """
        relevant_skills = []

        # Map task types to skills
        skill_mapping = {
            "diagnosis": ["fault_diagnosis", "safety_assessment"],
            "maintenance": ["maintenance_planning", "parts_identification"],
            "inspection": ["inspection_checklist", "compliance_check"],
            "report": ["report_generation", "summary_writing"],
        }

        skill_names = skill_mapping.get(task_type, [])

        # Add equipment-specific skills
        if equipment_type:
            equipment_skill = f"{equipment_type.lower()}_specialist"
            if (self.skills_dir / f"{equipment_skill}.yaml").exists():
                skill_names.append(equipment_skill)

        for name in skill_names:
            try:
                relevant_skills.append(self.load_skill(name))
            except ValueError:
                pass  # Skill not found, skip

        return relevant_skills

    def build_skill_prompt(
        self,
        skill: Skill,
        context: dict,
    ) -> str:
        """
        Build a prompt from skill template and context.
        """
        # Validate required context
        missing = [
            key for key in skill.required_context
            if key not in context
        ]
        if missing:
            raise ValueError(f"Missing context for skill: {missing}")

        # Format template
        prompt = skill.prompt_template.format(**context)

        # Add examples if available
        if skill.examples:
            examples_text = "\n\nExamples:\n"
            for ex in skill.examples[:3]:
                examples_text += f"\nInput: {ex['input']}\nOutput: {ex['output']}\n"
            prompt += examples_text

        return prompt
```

### Example Skill Definition

```yaml
# skills/fault_diagnosis.yaml
name: fault_diagnosis
description: Diagnose elevator faults from symptoms and fault codes

prompt_template: |
  You are an expert elevator fault diagnosis system.

  Equipment: {manufacturer} {model}
  Fault Code: {fault_code}
  Symptoms: {symptoms}
  Equipment Age: {age_years} years
  Known Quirks: {known_quirks}

  Based on this information, provide a diagnosis including:
  1. Most likely cause
  2. Secondary possible causes
  3. Recommended diagnostic steps
  4. Parts that may be needed
  5. Estimated repair time

required_context:
  - manufacturer
  - fault_code
  - symptoms

output_format: structured

examples:
  - input:
      manufacturer: KONE
      fault_code: F505
      symptoms: Door won't close, error on display
    output:
      primary_cause: Door zone sensor fault
      confidence: 0.85
      recommended_actions:
        - Check door zone sensor alignment
        - Test sensor output
        - Inspect wiring connections
```

---

## Pydantic AI Integration

### Structured Outputs

```python
# sitesync_v3/core/triforce/structured.py

from pydantic import BaseModel, Field
from pydantic_ai import Agent

class FaultDiagnosis(BaseModel):
    """Structured fault diagnosis output."""
    fault_code: str = Field(description="The fault code being diagnosed")
    severity: str = Field(description="critical, high, medium, or low")
    primary_cause: str = Field(description="Most likely cause of the fault")
    secondary_causes: list[str] = Field(description="Other possible causes")
    diagnostic_steps: list[str] = Field(description="Steps to confirm diagnosis")
    recommended_actions: list[str] = Field(description="Actions to resolve")
    parts_needed: list[str] = Field(description="Parts that may be required")
    estimated_time_minutes: int = Field(description="Estimated repair time")
    confidence: float = Field(ge=0, le=1, description="Confidence in diagnosis")
    safety_notes: list[str] = Field(description="Safety considerations")

class ReportContent(BaseModel):
    """Structured report output."""
    summary: str = Field(description="Brief summary of the work")
    work_performed: list[str] = Field(description="List of work items")
    parts_used: list[dict] = Field(description="Parts used with quantities")
    recommendations: list[str] = Field(description="Future recommendations")
    next_service_date: str | None = Field(description="Recommended next service")

# Create specialized agents
diagnosis_agent = Agent(
    'gemini-2.0-flash',
    result_type=FaultDiagnosis,
    system_prompt="""
You are an expert elevator fault diagnosis system.
Analyze the provided symptoms and fault code to determine
the most likely cause and recommended actions.
Always prioritize safety considerations.
"""
)

report_agent = Agent(
    'gemini-2.0-flash',
    result_type=ReportContent,
    system_prompt="""
You are a professional technical report writer.
Generate clear, concise service reports from work order data.
Use professional language appropriate for building managers.
"""
)
```

---

## Putting It All Together

### The Triforce Orchestrator

```python
# sitesync_v3/core/triforce/orchestrator.py

class TriforceOrchestrator:
    """
    Main orchestrator for the Triforce AI system.

    Coordinates jury, witnesses, judge, memory, and skills
    to produce high-quality AI outputs.
    """

    def __init__(
        self,
        jury: Jury,
        witness_panel: WitnessPanel,
        judge: Judge,
        memory: HierarchicalMemory,
        skills_manager: SkillsManager,
    ):
        self.jury = jury
        self.witnesses = witness_panel
        self.judge = judge
        self.memory = memory
        self.skills = skills_manager

    async def diagnose(
        self,
        fault_code: str,
        symptoms: list[str],
        equipment_context: dict,
    ) -> DiagnosisOutput:
        """
        Full diagnosis pipeline.
        """
        # 1. Recall relevant memories
        memories = await self.memory.recall(
            query=f"{fault_code} {' '.join(symptoms)}",
            memory_types=["semantic", "procedural", "episodic"],
        )

        # 2. Load relevant skills
        skills = self.skills.select_skills_for_task(
            task_type="diagnosis",
            equipment_type=equipment_context.get("manufacturer"),
        )

        # 3. Build context
        context = {
            **equipment_context,
            "fault_code": fault_code,
            "symptoms": symptoms,
            "relevant_facts": [m.content for m in memories.get("semantic", [])],
            "relevant_procedures": [m.content for m in memories.get("procedural", [])],
            "past_experiences": [m.content for m in memories.get("episodic", [])],
        }

        # 4. Jury deliberation
        prompt = self._build_diagnosis_prompt(context, skills)
        jury_responses = await self.jury.deliberate(prompt, context)

        # 5. Consensus voting
        consensus = ConsensusEngine(VotingStrategy.WEIGHTED).vote(jury_responses)

        # 6. Witness validation
        validations = await self.witnesses.validate_all(
            claim=consensus.answer,
            context=context,
        )
        aggregated_validation = self.witnesses.aggregate_validations(validations)

        # 7. Judge final decision
        result = await self.judge.decide(
            consensus=consensus,
            validation=aggregated_validation,
            context=context,
        )

        # 8. Store in episodic memory for future reference
        await self.memory.episodic.remember_task(
            task_id=UUID(),
            context={
                "fault_code": fault_code,
                "diagnosis": result.primary_cause,
                "confidence": result.confidence,
            },
        )

        return result

    def _build_diagnosis_prompt(
        self,
        context: dict,
        skills: list[Skill],
    ) -> str:
        """Build the diagnosis prompt with skills."""
        base_prompt = f"""
Diagnose the following elevator fault:

Fault Code: {context['fault_code']}
Symptoms: {', '.join(context['symptoms'])}
Equipment: {context.get('manufacturer', 'Unknown')} {context.get('model', '')}

Relevant Knowledge:
{chr(10).join(context.get('relevant_facts', [])[:5])}

Past Similar Cases:
{chr(10).join(context.get('past_experiences', [])[:3])}
"""

        # Add skill-specific instructions
        for skill in skills:
            base_prompt += f"\n\n{skill.prompt_template}"

        return base_prompt
```

---

## Usage Example

```python
# Example usage in a service

async def diagnose_fault(
    work_order: WorkOrder,
    elevator: Elevator,
) -> DiagnosisOutput:
    """
    Use Triforce to diagnose a fault.
    """
    triforce = get_triforce_orchestrator()  # Dependency injection

    result = await triforce.diagnose(
        fault_code=work_order.fault_code,
        symptoms=work_order.reported_symptoms,
        equipment_context={
            "manufacturer": elevator.manufacturer,
            "model": elevator.model,
            "controller_type": elevator.controller_type,
            "age_years": calculate_age(elevator.installation_date),
            "known_quirks": elevator.known_quirks,
        },
    )

    return result
```

---

**[← Back to Data Model](../reference/data-model.md)** | **[Next: API Reference →](../reference/api.md)**


<!-- FILE: docs/explanation/vision.md -->

# SiteSync V3 - Vision & Positioning

## The Foundation of Everything We Build

> This document defines who we are, what we believe, and how we communicate. Every product decision, every feature, every piece of marketing should align with the principles here.

---

## The Core Message

```
╔══════════════════════════════════════════════════════════════════╗
║                                                                  ║
║         YOUR BUILDING. YOUR DATA. YOUR INTELLIGENCE.             ║
║                                                                  ║
║                  Contractors come and go.                        ║
║                  Your building remembers forever.                ║
║                                                                  ║
╚══════════════════════════════════════════════════════════════════╝
```

This is our primary message. It speaks to:
- **Ownership** - YOUR building, YOUR data
- **Permanence** - remembers forever
- **Reality** - contractors come and go (everyone knows this)
- **Solution** - the building itself becomes intelligent

---

## The Story We Tell

### The Building's Story

> There's a building.
>
> It's been standing for 40 years. Six different service companies have come and gone. Each time, the building forgot everything. Started over. Lost wisdom. Lost history.
>
> Now imagine.
>
> That building remembers everything. Every repair. Every upgrade. Every quirk learned. 40 years of wisdom, searchable in seconds.
>
> A new technician arrives. Before they even open their toolbox, they know this building like a friend.
>
> *"Ah, Lift 2. The one that needs extra attention on the door alignment. Got it."*

### The Technician's Story

> There's a technician.
>
> She's been in the trade 25 years. She's solved problems nobody else could. She's discovered shortcuts that save hours. That knowledge used to live only in her head.
>
> Now imagine.
>
> Her expertise helps a young tech in Brisbane. Her shortcut saves someone 3 hours in Perth. Her career of learning lives on forever.
>
> The next generation starts further ahead. The craft advances. The profession rises.

### The Industry's Story

> There's an industry.
>
> For decades, knowledge was hoarded. Buildings were dependent. Workers' expertise was invisible. The ones who controlled information controlled everything.
>
> Now imagine.
>
> Buildings own their own intelligence. Workers own their reputations. Knowledge flows to where it's needed. Quality wins over access.
>
> Everyone rises together.

---

## The Three Empowerments

### Empowerment 1: Buildings Own Their Data

**The Principle:**
A building's service history belongs to the building - not to whoever happened to service it. When contractors change, knowledge should stay with the property.

**What This Means:**
- Every service record is permanently tied to the building
- Full history is searchable, regardless of who performed the work
- Building intelligence accumulates over decades
- New service providers see complete context from day one
- Property value increases with documented history

**The Experience:**
```
Building Manager View:
├── 20 years of service history
├── 6 different contractors' work - all visible
├── AI insights learned from complete history
├── Building Health Score based on everything
└── "This building knows itself"
```

### Empowerment 2: Workers Own Their Reputation

**The Principle:**
A technician's expertise should be visible, portable, and valuable. Years of skill development deserve recognition that travels with the worker.

**What This Means:**
- Professional profiles built from verified work
- Reputation scores based on actual performance
- Contributions to collective knowledge are tracked
- Employers can verify expertise before hiring
- Career advancement based on demonstrated skill

**The Experience:**
```
Technician Profile:
├── 2,847 verified jobs completed
├── 94% first-time fix rate
├── 156 solutions contributed
├── 1,200+ technicians helped
└── "My work speaks for itself"
```

### Empowerment 3: Knowledge Flows Freely

**The Principle:**
Collective wisdom from thousands of skilled workers should benefit everyone. The more people contribute, the smarter everyone becomes.

**What This Means:**
- Solutions discovered by one technician help all
- AI synthesises knowledge from across the community
- New technicians start with decades of wisdom
- Problems solved faster through shared experience
- The entire profession elevates together

**The Experience:**
```
Collective Intelligence:
├── 100,000+ documented solutions
├── AI-synthesised best practices
├── "This fault? 847 techs solved it. Here's what worked."
├── Continuous learning from every job
└── "We're all smarter together"
```

---

## Who We Serve

### Primary: Buildings

**Who they are:**
- Building owners
- Facility managers
- Property management companies
- Strata committees
- Commercial real estate operators

**What they want:**
- Control over their own property data
- Freedom to choose service providers
- Visibility into what's happening
- Predictable maintenance costs
- Confidence in their building's condition

**What we give them:**
- Permanent institutional memory
- Independence from any single contractor
- Complete visibility at site/trade/equipment level
- AI-powered predictions and insights
- Building Health Score

**Our promise to them:**
> *"Your building will never forget anything again. Every lesson learned stays with the property. Every contractor contributes to the whole. You're in control."*

### Secondary: Technicians

**Who they are:**
- Elevator technicians
- HVAC specialists
- Electrical workers
- Plumbers
- Fire system technicians
- Multi-trade maintenance workers

**What they want:**
- Recognition for their expertise
- Career advancement opportunities
- Help solving difficult problems
- Fair competition based on skill
- Their knowledge to matter

**What we give them:**
- Professional profiles with verified metrics
- Reputation that travels with them
- Access to collective wisdom
- Platform to showcase expertise
- Career progression pathway

**Our promise to them:**
> *"Your expertise matters. Every job builds your reputation. Every solution you share helps others. Your career is yours to own."*

### Tertiary: Service Companies

**Who they are:**
- Small independent contractors
- Mid-size service companies
- Regional specialists

**What they want:**
- Access to jobs
- Efficient operations
- Skilled workforce
- Competitive positioning

**What we give them:**
- Platform presence where buildings look
- Operational tools (scheduling, inventory, invoicing)
- Access to qualified technicians
- Ability to compete on quality

**Our promise to them:**
> *"Win work based on the quality you deliver. Find skilled technicians. Run efficient operations. Grow your business."*

---

## What We Believe

### Our Core Beliefs

**1. Buildings should own their own history**
A building's service records are part of the building - like the walls and the wiring. They shouldn't walk out the door when a contractor leaves.

**2. Workers' expertise has lasting value**
A technician who spends 25 years mastering their craft has created something valuable. That wisdom should be recognized, portable, and beneficial to others.

**3. Knowledge shared freely makes everyone stronger**
When one technician discovers a better way, everyone should benefit. Collective intelligence outperforms hoarded secrets.

**4. The best service should win on merit**
Competition should be about quality, skill, and value - not about who controls access to information.

**5. Technology should be invisible and empowering**
The best tools are the ones you don't think about. AI should make people more capable, not more dependent.

### What We Don't Believe

We don't believe in:
- Information as a weapon of control
- Data ownership as leverage over customers
- Expertise being invisible or unrecognized
- Technology that creates dependence
- Complexity for its own sake

---

## The Invisible AI Principle

### The Rule

> AI should be seamless and invisible. When users say "this tool is amazing" (never "this AI is amazing"), we've succeeded.

### What This Means in Practice

| Visible AI (Wrong) | Invisible AI (Right) |
|--------------------|----------------------|
| "Our AI chatbot will help you!" | Form auto-fills before you type |
| "Powered by GPT-4" badge | System suggests exactly what you need |
| "Let AI analyze your data" | Report appears, already written |
| "AI is thinking..." spinner | Instant results (pre-computed) |
| User knows they're using AI | User thinks the tool is brilliant |

### The "How Did It Know?" Moments

These are the experiences that create delight:

1. **Arrival Recognition**: Open app at jobsite → already knows which building, which job
2. **Camera Intelligence**: Point at nameplate → reads it → downloads manual → shows history
3. **Voice-First Diagnosis**: Speak symptoms → AI suggests causes → one tap to confirm
4. **Self-Writing Reports**: Finish job → report ready in 30 seconds
5. **Smart Parts**: Diagnose fault → AI suggests part → shows who has it nearby
6. **Predictive Alerts**: "Motor will need attention in 3 months. Schedule now?"

### AI Confidence and User Experience

| AI Confidence | User Experience | User Action |
|---------------|-----------------|-------------|
| High (95%+) | "Likely the sensor. Order it?" | One tap to confirm |
| Medium (70-95%) | "Could be A, B, or C" | Tap to choose |
| Low (<70%) | "What do you see?" | Photo/voice input |

**The human is always in control. AI is always helpful. Neither is ever in the way.**

---

## Messaging Guide

### Primary Tagline
```
YOUR BUILDING. YOUR DATA. YOUR INTELLIGENCE.
```

### Secondary Tagline
```
Contractors come and go. Your building remembers forever.
```

### For Buildings (Marketing)
```
Your building deserves permanent memory.

Every repair. Every service call. Every lesson learned.
20 years of history, searchable in seconds.
Yours to keep. Forever.

$29/month.
```

### For Technicians (Marketing)
```
Your expertise deserves recognition.

Every job builds your profile.
Every solution you share helps others.
Your reputation travels with you.

Your work speaks for itself.
```

### Elevator Pitch (30 seconds)
```
"SiteSync is building intelligence for buildings.

Today, when a building changes service contractors, they lose
all their history. We fix that - the building owns its own data,
forever, regardless of who does the work.

And we give technicians professional profiles based on verified
work, so their expertise is finally visible.

Buildings remember. Workers are recognized. Everyone benefits."
```

### Investor Pitch (60 seconds)
```
"We're shifting power in the building services industry.

Currently, contractors own all service data. When buildings
switch vendors, they lose everything. Workers' expertise is
invisible. Knowledge is hoarded.

SiteSync changes this. Buildings own their data permanently.
Technicians build portable reputations. Knowledge flows freely.

We sell to buildings at $29/month - a 10x undercut vs. incumbents
who sell to contractors. Those incumbents can't pivot to our
model without destroying their customer base.

We're building the operating system for building services,
starting with elevators in Australia, expanding to all trades
globally."
```

---

## The Movement

### What We're Building

```
╔══════════════════════════════════════════════════════════════════╗
║                                                                  ║
║                         SITESYNC V3                             ║
║                                                                  ║
║              EMPOWERING BUILDINGS.                               ║
║              ELEVATING WORKERS.                                  ║
║              ADVANCING THE INDUSTRY.                             ║
║                                                                  ║
╚══════════════════════════════════════════════════════════════════╝
```

### The Outcome We Seek

When we succeed:

- **Buildings** have complete, permanent memory of everything that's ever happened to them
- **Technicians** have visible, portable reputations that advance their careers
- **Knowledge** flows freely to benefit everyone who needs it
- **Quality** wins over access, skill wins over secrets
- **The entire industry** operates at a higher level

### How We Know We're Winning

- Building managers say: *"I finally understand what's happening in my building"*
- Technicians say: *"My expertise finally counts for something"*
- New techs say: *"I can solve problems my predecessors couldn't"*
- The industry says: *"This is how it should have always worked"*

---

## Principles for Decision-Making

When making product, design, or business decisions, ask:

1. **Does this empower buildings to own their data?**
2. **Does this help workers build visible reputation?**
3. **Does this enable knowledge to flow freely?**
4. **Is the AI invisible and helpful, not showy and intrusive?**
5. **Are we framing this positively - what we enable, not what we oppose?**

If the answer to these questions is yes, proceed. If not, reconsider.

---

**[← Back to Documentation Hub](../README.md)** | **[Next: For Buildings →](for-buildings.md)**


<!-- FILE: docs/explanation/for-buildings.md -->

# SiteSync V3 - For Buildings

## Complete Guide to Building Empowerment

> This document explains how SiteSync serves building owners, facility managers, and property management companies. It covers the core value proposition, features, and experiences that make buildings smarter.

---

## The Core Promise

```
╔══════════════════════════════════════════════════════════════════╗
║                                                                  ║
║   YOUR BUILDING WILL NEVER FORGET ANYTHING AGAIN.                ║
║                                                                  ║
║   Every service record. Every repair. Every lesson learned.      ║
║   Permanent. Searchable. Yours.                                  ║
║                                                                  ║
║   Contractors come and go.                                       ║
║   Your building remembers forever.                               ║
║                                                                  ║
╚══════════════════════════════════════════════════════════════════╝
```

---

## The Building-Centric Model

### How It Works

In SiteSync, the **building** is the center of everything - not the contractor who services it.

```
BUILDING-CENTRIC DATA MODEL
══════════════════════════════════════════════════════════════════

Your Building (You Own This)
│
├── Site Information
│   └── Address, contacts, access details
│
├── All Equipment (Assets)
│   ├── Lift 1 - KONE MonoSpace
│   ├── Lift 2 - Otis Gen2
│   ├── HVAC Unit 1 - Daikin
│   └── Fire Panel - Notifier
│
├── Complete Service History
│   ├── 2015-2020: Work by Contractor A
│   ├── 2020-2023: Work by Contractor B
│   ├── 2023-present: Work by Contractor C
│   └── ALL VISIBLE, ALL SEARCHABLE
│
├── AI-Learned Intelligence
│   ├── Equipment quirks and patterns
│   ├── Predictive maintenance insights
│   └── Accumulated over entire building lifetime
│
└── Compliance & Documentation
    ├── Inspection certificates
    ├── Audit trail
    └── Regulatory records

══════════════════════════════════════════════════════════════════

CONTRACTORS ARE TEMPORARY WORKERS.
YOUR BUILDING'S INTELLIGENCE IS PERMANENT.
```

### What This Changes

| Before SiteSync | With SiteSync |
|------------------|----------------|
| Switch contractors, lose all history | History stays with building forever |
| New contractor starts from zero | New contractor sees complete context |
| Equipment quirks forgotten | AI remembers every pattern |
| Dependent on contractor for information | You control your own data |
| Records scattered across vendors | Single source of truth |

---

## Multi-Level Visibility

### Three Views of Your Building

Building managers can view their property at three levels of detail, drilling down from big picture to individual equipment.

### Level 1: Site Overview

See your entire building at a glance.

```
┌─────────────────────────────────────────────────────────────────────┐
│                                                                     │
│   123 COLLINS STREET                                                │
│   ══════════════════                                                │
│                                                                     │
│   BUILDING HEALTH SCORE                                             │
│   ┌─────────────────────────────────────────────────────────────┐   │
│   │                                                             │   │
│   │                         91                                  │   │
│   │                       ───────                               │   │
│   │                      │ ████ │   EXCELLENT                   │   │
│   │                      │ ████ │                               │   │
│   │                       ───────                               │   │
│   │                                                             │   │
│   │   Top 15% of similar buildings in Sydney                    │   │
│   │   ↑ Improved 7 points this year                             │   │
│   │                                                             │   │
│   └─────────────────────────────────────────────────────────────┘   │
│                                                                     │
│   TRADE SUMMARY                                                     │
│   ┌──────────────┬───────────┬────────────┬──────────┬──────────┐   │
│   │ Trade        │ Status    │ Open Jobs  │ This Mth │ YTD Cost │   │
│   ├──────────────┼───────────┼────────────┼──────────┼──────────┤   │
│   │ Lifts        │ ● Good    │     1      │    8     │ $12,400  │   │
│   │ HVAC         │ ● Good    │     0      │    5     │  $8,200  │   │
│   │ Electrical   │ ● Good    │     0      │    3     │  $4,100  │   │
│   │ Fire Systems │ ○ Attn    │     1      │    2     │  $3,800  │   │
│   │ Plumbing     │ ● Good    │     0      │    4     │  $2,900  │   │
│   │ Security     │ ● Good    │     0      │    1     │  $1,200  │   │
│   └──────────────┴───────────┴────────────┴──────────┴──────────┘   │
│                                                                     │
│   TOTAL YTD: $32,600                                                │
│                                                                     │
│   UPCOMING                                                          │
│   • Fire system inspection due in 14 days                           │
│   • Lift 1 preventive maintenance scheduled next week               │
│   • HVAC filter replacement recommended (AI suggestion)             │
│                                                                     │
│   RECENT ACTIVITY                                                   │
│   • Today: Lift 2 callback completed (door adjustment)              │
│   • Yesterday: Fire panel inspection passed                         │
│   • 3 days ago: HVAC service completed                              │
│                                                                     │
└─────────────────────────────────────────────────────────────────────┘
```

### Level 2: Trade View

Drill into a specific trade to see all related equipment and activity.

```
┌─────────────────────────────────────────────────────────────────────┐
│                                                                     │
│   LIFTS - 123 COLLINS STREET                                        │
│   ══════════════════════════                                        │
│                                                                     │
│   TRADE HEALTH: 94/100 (Excellent)                                  │
│                                                                     │
│   EQUIPMENT                                                         │
│   ┌───────────────┬─────────────┬──────────────┬──────────────────┐ │
│   │ Unit          │ Status      │ Last Service │ Next Due         │ │
│   ├───────────────┼─────────────┼──────────────┼──────────────────┤ │
│   │ Lift 1        │ ● Opera-    │ 3 days ago   │ 89 days          │ │
│   │ KONE Mono     │   tional    │ Preventive   │ Preventive       │ │
│   ├───────────────┼─────────────┼──────────────┼──────────────────┤ │
│   │ Lift 2        │ ● Opera-    │ Today        │ 90 days          │ │
│   │ Otis Gen2     │   tional    │ Callback     │ Preventive       │ │
│   ├───────────────┼─────────────┼──────────────┼──────────────────┤ │
│   │ Lift 3        │ ● Opera-    │ 12 days ago  │ 78 days          │ │
│   │ KONE Mono     │   tional    │ Preventive   │ Preventive       │ │
│   ├───────────────┼─────────────┼──────────────┼──────────────────┤ │
│   │ Escalator 1   │ ● Opera-    │ 5 days ago   │ 85 days          │ │
│   │ Schindler     │   tional    │ Inspection   │ Preventive       │ │
│   └───────────────┴─────────────┴──────────────┴──────────────────┘ │
│                                                                     │
│   CURRENT SERVICE PROVIDER: Summit Elevator Services                │
│   Since: March 2023                                                 │
│                                                                     │
│   SERVICE HISTORY (All Contractors)                                 │
│   • 2023-Present: Summit Elevator Services (47 jobs)                │
│   • 2019-2023: Acme Lifts (89 jobs)                                 │
│   • 2015-2019: KONE Direct (112 jobs)                               │
│   Total: 248 jobs over 10 years - ALL VISIBLE                       │
│                                                                     │
│   AI INSIGHTS                                                       │
│   • Lift 2 door operator showing wear pattern - monitor             │
│   • Lift 1 runs 23% more cycles than building average               │
│   • Escalator 1 performing above expected for age                   │
│                                                                     │
│   [View All History] [Compare to Similar Buildings] [Export]        │
│                                                                     │
└─────────────────────────────────────────────────────────────────────┘
```

### Level 3: Equipment Detail

See the complete story of a single piece of equipment.

```
┌─────────────────────────────────────────────────────────────────────┐
│                                                                     │
│   LIFT 1 - KONE MONOSPACE                                           │
│   ════════════════════════                                          │
│                                                                     │
│   123 Collins Street │ Unit 1 │ Installed 2015                      │
│                                                                     │
│   ┌─────────────────────────────────────────────────────────────┐   │
│   │ EQUIPMENT HEALTH: 92/100                                    │   │
│   │ Status: Operational                                         │   │
│   │ Last Service: 3 days ago (Preventive)                       │   │
│   │ Next Due: 89 days (Preventive maintenance)                  │   │
│   └─────────────────────────────────────────────────────────────┘   │
│                                                                     │
│   SPECIFICATIONS                                                    │
│   ├── Manufacturer: KONE                                            │
│   ├── Model: MonoSpace 500                                          │
│   ├── Serial: KM-2015-78234                                         │
│   ├── Registration: EL-NSW-45678                                    │
│   ├── Capacity: 1000kg / 13 persons                                 │
│   ├── Speed: 1.6 m/s                                                │
│   ├── Floors Served: 12                                             │
│   ├── Controller: KONE KCM                                          │
│   └── Drive: KONE EcoDisc                                           │
│                                                                     │
│   ═══════════════════════════════════════════════════════════════   │
│                                                                     │
│   COMPLETE TIMELINE                                                 │
│   ─────────────────                                                 │
│                                                                     │
│   2024                                                              │
│   ────                                                              │
│   Dec 15  Preventive maintenance               Summit Elevators     │
│           └── Routine service, all checks passed                    │
│           └── Tech: Maria S. (Rating: 94)                           │
│                                                                     │
│   Nov 22  Callback - Door hesitation           Summit Elevators     │
│           └── Adjusted door operator timing                         │
│           └── Parts: None required                                  │
│           └── Resolution: 45 minutes                                │
│           └── Tech: James T. (Rating: 89)                           │
│                                                                     │
│   Sep 14  Annual safety inspection             SafeLift Inspections │
│           └── PASSED - Certificate #INS-2024-7823                   │
│           └── Minor: Door gap at L3 - noted for next service        │
│                                                                     │
│   Jun 03  Emergency - Passengers stuck         Summit Elevators     │
│           └── Cause: Door interlock fault                           │
│           └── Parts: Interlock switch x1 ($85)                      │
│           └── Resolution: 47 minutes                                │
│           └── Tech: Maria S. (Rating: 94)                           │
│                                                                     │
│   Mar 12  Preventive maintenance               Summit Elevators     │
│           └── Routine service, door adjustment performed            │
│                                                                     │
│   2023                                                              │
│   ────                                                              │
│   Dec 08  Preventive maintenance               Acme Lifts           │
│           └── Final service before contract change                  │
│                                                                     │
│   ... [View complete 10-year history - 112 entries]                 │
│                                                                     │
│   ═══════════════════════════════════════════════════════════════   │
│                                                                     │
│   AI INSIGHTS (Learned from 10 years of data)                       │
│   ───────────────────────────────────────────                       │
│                                                                     │
│   • "F505 errors on this unit correlate with humidity >80%"         │
│   • "Door operator has been adjusted 12 times - consider upgrade"   │
│   • "This unit runs 23% more cycles than building average"          │
│   • "Motor bearing replacement likely needed within 18 months"      │
│   • "Similar units in Sydney average 94/100 health - this is 92"    │
│                                                                     │
│   KNOWN QUIRKS                                                      │
│   ────────────                                                      │
│   • Humidity sensitivity: F505 on humid days is usually false alarm │
│   • Door timing: Runs better with slightly longer dwell time        │
│   • L3 door: Gap noted - cosmetic, not safety issue                 │
│                                                                     │
│   DOCUMENTS                                                         │
│   ─────────                                                         │
│   • Installation manual (KONE MonoSpace)                            │
│   • Safety inspection certificates (2015-2024)                      │
│   • Modernization proposal (2023 - not actioned)                    │
│   • Warranty documentation                                          │
│                                                                     │
│   [Export History] [Generate Report] [Schedule Service]             │
│                                                                     │
└─────────────────────────────────────────────────────────────────────┘
```

---

## Building Health Score

### What It Is

A single number (0-100) representing the overall health and condition of your building's systems.

```
BUILDING HEALTH SCORE
══════════════════════════════════════════════════════════════════

                    ┌─────────────────────┐
                    │                     │
                    │         91          │
                    │       ───────       │
                    │      │ ████ │       │
                    │      │ ████ │       │
                    │       ───────       │
                    │                     │
                    │     EXCELLENT       │
                    │                     │
                    └─────────────────────┘

Score Ranges:
├── 90-100: Excellent - Top tier condition
├── 75-89:  Good - Well maintained
├── 60-74:  Fair - Some attention needed
├── 40-59:  Poor - Significant issues
└── 0-39:   Critical - Immediate action required

══════════════════════════════════════════════════════════════════
```

### How It's Calculated

The score is computed from multiple factors:

| Factor | Weight | What It Measures |
|--------|--------|------------------|
| Equipment Age & Condition | 25% | Physical state of assets |
| Maintenance Compliance | 25% | Are scheduled services being done? |
| Incident Frequency | 20% | How often do problems occur? |
| First-Time Fix Rate | 15% | Are issues resolved efficiently? |
| Predictive Risk | 15% | AI-assessed future risk |

### What You Can Do With It

**Track Over Time:**
```
Building Health Score - 123 Collins Street
───────────────────────────────────────────
2024: 91 ████████████████████░░░░
2023: 84 █████████████████░░░░░░░  ↑ +7 points
2022: 79 ████████████████░░░░░░░░
2021: 81 ████████████████░░░░░░░░
2020: 77 ███████████████░░░░░░░░░
```

**Compare to Similar Buildings:**
```
Your Building:        91 (Top 15%)
Sydney CBD Average:   78
Similar Size Average: 82
Similar Age Average:  76
```

**Predict Future State:**
```
Current Score: 91

Predicted in 6 months:
├── With recommended maintenance: 92 (+1)
├── With current trajectory: 88 (-3)
└── Without planned repairs: 79 (-12)
```

---

## Freedom of Choice

### Work With Any Contractor

Because your building owns its data, you're free to work with any service provider you choose.

```
YOUR BUILDING DATA                    CONTRACTORS
═══════════════════                   ═══════════

┌──────────────────────┐
│                      │         ┌─────────────────┐
│   Your Building's    │◄────────│  Contractor A   │
│   Complete History   │         └─────────────────┘
│                      │
│   AI Insights        │         ┌─────────────────┐
│                      │◄────────│  Contractor B   │
│   All Documentation  │         └─────────────────┘
│                      │
│   Equipment Quirks   │         ┌─────────────────┐
│                      │◄────────│  Contractor C   │
│   Known Issues       │         └─────────────────┘
│                      │
└──────────────────────┘

YOU CONTROL ACCESS.
CONTRACTORS WORK FOR YOU.
DATA STAYS WITH THE BUILDING.
```

### When You Switch Contractors

**Traditional Model:**
- Lose all service history
- New contractor starts blind
- Equipment quirks forgotten
- "What happened before?" - Unknown

**SiteSync Model:**
- Complete history transfers instantly
- New contractor sees everything from day one
- Equipment quirks documented and visible
- Seamless continuity

### Contractor Performance Visibility

You can see how each contractor has performed:

```
CONTRACTOR COMPARISON - 123 Collins Street
══════════════════════════════════════════════════════════════════

                         Summit       Acme        KONE
                         (Current)    (Previous)  (Original)
                         ─────────    ──────────  ──────────
Period:                  2023-now     2019-2023   2015-2019
Jobs Completed:          47           89          112

First-Time Fix Rate:     94%          87%         91%
Average Response Time:   2.1 hrs      3.4 hrs     4.2 hrs
Average Resolution:      1.2 hrs      1.8 hrs     1.5 hrs
Customer Satisfaction:   4.8/5        4.2/5       4.5/5

Callbacks:               2 (4%)       11 (12%)    8 (7%)
Emergency Response:      Excellent    Good        Good

══════════════════════════════════════════════════════════════════

Data-driven contractor selection.
```

---

## Compliance & Audit Trail

### Regulatory Confidence

Buildings have compliance obligations. SiteSync provides the documentation you need.

```
COMPLIANCE DASHBOARD - 123 Collins Street
══════════════════════════════════════════════════════════════════

CERTIFICATIONS STATUS
─────────────────────

✓ Lift Safety Certificates (4/4 current)
  └── All lifts inspected within last 12 months
  └── Next due: Lift 3 on March 15, 2025

✓ Fire System Compliance
  └── Annual inspection passed November 2024
  └── Next due: November 2025

✓ Essential Services Register
  └── All items current
  └── Last audit: October 2024

○ HVAC Maintenance Log
  └── Recommended: Document refrigerant handling
  └── Not required but best practice

══════════════════════════════════════════════════════════════════
```

### Immutable Audit Trail

Every action is recorded with tamper-proof integrity:

```
AUDIT TRAIL
══════════════════════════════════════════════════════════════════

Every record includes:
├── What happened
├── Who did it
├── When it occurred
├── What changed
└── Cryptographic hash (tamper-evident)

This provides:
├── Regulatory compliance evidence
├── Insurance documentation
├── Due diligence for property sales
├── Dispute resolution records
└── Legal protection

══════════════════════════════════════════════════════════════════
```

---

## Property Value

### Buildings With History Are Worth More

When selling a building, complete service history is valuable:

```
PROPERTY SALE SCENARIO
══════════════════════════════════════════════════════════════════

WITHOUT SITESYNC:
──────────────────
Buyer: "What's the maintenance history on the lifts?"
Seller: "We have some records from our current contractor."
Buyer: "What about before them?"
Seller: "That was a different company... we don't have those."
Buyer: "So I'm buying $2M of equipment with partial history?"

Result: Lower offers, longer due diligence, more risk

WITH SITESYNC:
───────────────
Buyer: "What's the maintenance history?"
Seller: [Exports complete 15-year history]
Buyer: "Building Health Score 91, all compliance current,
        AI predicts $45K maintenance over next 3 years."
Buyer: "This is exactly what we need."

Result: Premium pricing, fast close, confident buyer

══════════════════════════════════════════════════════════════════

SITESYNC HISTORY ADDS VALUE TO YOUR PROPERTY.
```

### Due Diligence Made Easy

For property transactions:

```
EXPORT OPTIONS
══════════════════════════════════════════════════════════════════

One-Click Reports:
├── Complete Equipment Register
├── Full Service History (by date range)
├── Compliance Certificate Summary
├── Building Health Score Report
├── Contractor Performance Summary
├── Predictive Maintenance Forecast
└── AI Insights Summary

Formats: PDF, Excel, API

══════════════════════════════════════════════════════════════════
```

---

## Multi-Trade Support

### All Building Services, One Platform

SiteSync isn't just for elevators. Manage all building trades:

```
SUPPORTED TRADES
══════════════════════════════════════════════════════════════════

LIFTS & ESCALATORS
├── Elevators (all types)
├── Escalators
├── Moving walkways
└── Specialized lift AI

HVAC
├── Air conditioning
├── Heating systems
├── Ventilation
└── Specialized HVAC AI

ELECTRICAL
├── Switchboards
├── Lighting systems
├── Emergency power
└── Electrical AI

PLUMBING
├── Hot water systems
├── Pumps
├── Drainage
└── Plumbing AI

FIRE SYSTEMS
├── Detection systems
├── Suppression systems
├── Emergency lighting
├── Exit systems
└── Fire AI

SECURITY
├── Access control
├── CCTV systems
├── Intercoms
└── Security AI

PAINTING & FIT-OUT
├── Scheduled refreshes
├── Repairs
└── Quote management

REMOVALISTS & LOGISTICS
├── Move scheduling
├── Lift booking
└── Coordination

══════════════════════════════════════════════════════════════════

EACH TRADE HAS SPECIALIZED AI.
ALL TRADES IN ONE DASHBOARD.
ONE BUILDING HEALTH SCORE.
```

---

## Emergency Response

### Categorised Emergency Handling

```
EMERGENCY CATEGORIES
══════════════════════════════════════════════════════════════════

CATEGORY 1 - IMMEDIATE (People Safety)
──────────────────────────────────────
• People stuck in lift
• Fire/smoke detected
• Flooding/water damage active
• Security breach in progress

Response: Instant notification, auto-dispatch

CATEGORY 2 - URGENT (Building Impact)
─────────────────────────────────────
• Lift out of service (single lift building)
• HVAC failure (extreme weather)
• Power failure
• Fire system fault

Response: Within 1 hour, escalation if needed

CATEGORY 3 - STANDARD
─────────────────────
• Lift intermittent fault
• Comfort complaints
• Minor damage reports
• Vandalism

Response: Next business day

══════════════════════════════════════════════════════════════════
```

### What Happens in an Emergency

```
EMERGENCY FLOW: PASSENGERS STUCK IN LIFT
══════════════════════════════════════════════════════════════════

1. REPORT
   └── Building manager reports via app or call

2. INSTANT TRIAGE
   └── AI confirms: Category 1 - People Safety

3. AUTO-DISPATCH
   └── Nearest qualified technician notified
   └── Building manager sees ETA

4. TECHNICIAN BRIEFED
   └── Tech receives: Building location, lift details,
       access codes, equipment history, known quirks

5. EN ROUTE UPDATES
   └── Building manager sees technician location
   └── ETA updates automatically

6. RESOLUTION
   └── Passengers freed
   └── Incident logged automatically
   └── Follow-up scheduled if needed

7. DOCUMENTATION
   └── Complete audit trail
   └── Report generated
   └── Insurance documentation ready

══════════════════════════════════════════════════════════════════
```

---

## Getting Started

### Onboarding Your Building

```
STEP 1: REGISTER YOUR BUILDING
──────────────────────────────
• Basic property details
• Number and type of equipment
• Current service arrangements

STEP 2: ADD YOUR EQUIPMENT
──────────────────────────
• Enter each asset
• Upload existing documentation
• Link to manufacturer specs (AI-assisted)

STEP 3: IMPORT HISTORY (Optional)
─────────────────────────────────
• Import from spreadsheets
• Import from other systems
• AI helps structure data

STEP 4: INVITE YOUR CONTRACTORS
───────────────────────────────
• Contractors join (free for them)
• Grant access to your building
• They start logging work

STEP 5: YOUR BUILDING GETS SMARTER
──────────────────────────────────
• Every service adds knowledge
• AI learns your equipment
• Building Health Score improves
```

### Time to Value

| Activity | Time Required |
|----------|---------------|
| Account setup | 5 minutes |
| Add first building | 10 minutes |
| Add equipment | 5 minutes per asset |
| Import basic history | 30 minutes |
| First AI insights | Within first week |
| Building Health Score | After 30 days |

---

## Pricing

### Simple, Affordable, Transparent

```
BUILDING PRICING
══════════════════════════════════════════════════════════════════

$29/month per building

Includes:
├── Unlimited equipment tracking
├── Complete history retention (forever)
├── All trades supported
├── Building Health Score
├── AI insights and predictions
├── Compliance dashboard
├── Unlimited contractor invitations
├── Mobile access
├── Export and reporting
└── Support

No per-user fees.
No per-equipment fees.
No data storage fees.

══════════════════════════════════════════════════════════════════
```

### Volume Pricing

| Buildings | Price per Building |
|-----------|-------------------|
| 1-10 | $29/month |
| 11-50 | $24/month |
| 51+ | $19/month |

---

## The Bottom Line

```
╔══════════════════════════════════════════════════════════════════╗
║                                                                  ║
║   YOUR BUILDING. YOUR DATA. YOUR INTELLIGENCE.                   ║
║                                                                  ║
║   • Complete history that stays with the building forever        ║
║   • Freedom to work with any contractor you choose               ║
║   • AI insights that make your building smarter over time        ║
║   • One dashboard for all trades                                 ║
║   • Compliance confidence                                        ║
║   • Property value protection                                    ║
║                                                                  ║
║   Contractors come and go.                                       ║
║   Your building remembers forever.                               ║
║                                                                  ║
║   $29/month.                                                     ║
║                                                                  ║
╚══════════════════════════════════════════════════════════════════╝
```

---

**[← Back to Vision](vision.md)** | **[Next: For Technicians →](for-technicians.md)**


<!-- FILE: docs/explanation/for-technicians.md -->

# SiteSync V3 - For Technicians

## Complete Guide to Professional Recognition

> This document explains how SiteSync empowers technicians to build visible, portable reputations based on verified work. Your expertise deserves recognition.

---

## The Core Promise

```
╔══════════════════════════════════════════════════════════════════╗
║                                                                  ║
║   YOUR EXPERTISE. YOUR REPUTATION. YOUR CAREER.                  ║
║                                                                  ║
║   Every job builds your story.                                   ║
║   Every contribution grows your name.                            ║
║   Every employer can see your value.                             ║
║                                                                  ║
║   Your work speaks for itself.                                   ║
║                                                                  ║
╚══════════════════════════════════════════════════════════════════╝
```

---

## The Professional Profile

### Your Digital Professional Identity

Every technician on SiteSync has a professional profile built from their actual work - not self-reported claims, but verified performance.

```
┌─────────────────────────────────────────────────────────────────────┐
│                                                                     │
│  ┌──────┐   MARIA SANTOS                                           │
│  │      │   Master Elevator Technician                              │
│  │ FOTO │   Sydney, Australia                                       │
│  │      │   SiteSync Verified ✓                                    │
│  └──────┘                                                           │
│                                                                     │
│  ════════════════════════════════════════════════════════════════   │
│                                                                     │
│   EXPERTISE SCORE                                                   │
│   ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━                      │
│   ████████████████████████████░░░░  94 / 100                        │
│                                                                     │
│   Top 3% of technicians on SiteSync                                │
│                                                                     │
│  ════════════════════════════════════════════════════════════════   │
│                                                                     │
│   SPECIALISATIONS                                                   │
│   ┌─────────────────┐ ┌─────────────────┐ ┌─────────────────┐       │
│   │   KONE Expert   │ │  Door Systems   │ │ Modernisation   │       │
│   │     ★★★★★       │ │     ★★★★★       │ │     ★★★★☆       │       │
│   └─────────────────┘ └─────────────────┘ └─────────────────┘       │
│                                                                     │
│  ════════════════════════════════════════════════════════════════   │
│                                                                     │
│   VERIFIED IMPACT                                                   │
│                                                                     │
│   🔧  2,847 jobs completed                                          │
│   🎯  94% first-time fix rate                                       │
│   💡  156 solutions contributed                                     │
│   ⭐  1,200+ technicians helped                                     │
│   🏢  43 buildings trust this technician                            │
│   ⏱️  Avg resolution: 1.2 hours                                     │
│                                                                     │
│  ════════════════════════════════════════════════════════════════   │
│                                                                     │
│   CERTIFICATIONS                                                    │
│   ✓ A-Grade Elevator Mechanic (NSW) - Verified                      │
│   ✓ KONE Certified Technician - Verified                            │
│   ✓ Working at Heights - Verified                                   │
│   ✓ Electrical License (Class 2) - Verified                         │
│                                                                     │
│  ════════════════════════════════════════════════════════════════   │
│                                                                     │
│   EXPERIENCE                                                        │
│                                                                     │
│   12 years in elevator industry                                     │
│   ├── Summit Elevator Services (2020-Present)                       │
│   ├── Acme Lift Services (2015-2020)                                │
│   └── KONE Australia (2012-2015)                                    │
│                                                                     │
│  ════════════════════════════════════════════════════════════════   │
│                                                                     │
│   TOP CONTRIBUTIONS                                                 │
│                                                                     │
│   "KONE MonoSpace F505 - The Humidity Fix"                          │
│   └── Used by 847 technicians • Saved est. 1,200+ hours             │
│                                                                     │
│   "Door Operator Calibration Shortcut"                              │
│   └── Used by 623 technicians • Saved est. 900+ hours               │
│                                                                     │
│   "Gen2 Controller Reset Sequence"                                  │
│   └── Used by 412 technicians • Saved est. 600+ hours               │
│                                                                     │
│  ════════════════════════════════════════════════════════════════   │
│                                                                     │
│   RECOGNITION                                                       │
│                                                                     │
│   🏆 Top 3% Expertise Score                                         │
│   🌟 Knowledge Keeper (50+ contributions)                           │
│   🎯 First-Fix Master (95%+ first-time fix rate)                    │
│   🤝 Mentor (Guided 25+ technicians)                                │
│                                                                     │
│  ════════════════════════════════════════════════════════════════   │
│                                                                     │
│   ENDORSEMENTS                                                      │
│                                                                     │
│   "Maria's door system expertise is exceptional. Her F505           │
│    contribution saved our team countless hours."                    │
│    — James T., Service Manager                                      │
│                                                                     │
│   "We hired Maria based on her SiteSync profile. Best              │
│    decision we made. Her reputation is well-earned."                │
│    — Summit Elevator Services                                       │
│                                                                     │
│   "Maria helped me solve a problem I'd been stuck on for            │
│    two days. Incredibly generous with her knowledge."               │
│    — David C., Technician                                           │
│                                                                     │
│  ════════════════════════════════════════════════════════════════   │
│                                                                     │
│   📧 Contact    📄 Download Profile    🔗 Share    ✓ Available      │
│                                                                     │
└─────────────────────────────────────────────────────────────────────┘
```

### What Makes It Different

| Traditional Resume | SiteSync Profile |
|--------------------|-------------------|
| Self-reported claims | Verified from actual work |
| "5 years experience" | "2,847 jobs completed" |
| "Expert in KONE" | "94% first-fix rate on KONE" |
| "Problem solver" | "156 solutions helped 1,200 techs" |
| Subjective | Data-driven |
| Static document | Living, growing record |

---

## How Your Reputation Grows

### Everything Counts

Every job you complete on SiteSync builds your professional profile:

```
YOUR REPUTATION BUILDS AUTOMATICALLY
══════════════════════════════════════════════════════════════════

EVERY JOB COMPLETED
───────────────────
├── Added to your verified job count
├── Contributes to your first-time fix rate
├── Builds your experience with that equipment type
├── Shows buildings you've served
└── Demonstrates your reliability

EVERY PROBLEM SOLVED
────────────────────
├── Builds your expertise in that area
├── Can become a contribution for others
├── Shows your diagnostic ability
└── Increases your expertise score

EVERY CONTRIBUTION SHARED
─────────────────────────
├── Helps other technicians
├── Earns recognition badges
├── Shows your generosity
├── Builds industry standing
└── Creates lasting value

EVERY POSITIVE OUTCOME
──────────────────────
├── Building managers can endorse you
├── Fellow technicians can recognise you
├── Your track record speaks
└── Opportunities find you

══════════════════════════════════════════════════════════════════

THE MORE YOU WORK, THE MORE YOUR REPUTATION GROWS.
THE MORE YOU SHARE, THE MORE YOU'RE RECOGNISED.
```

### Expertise Score Breakdown

Your expertise score (0-100) is calculated from multiple factors:

```
EXPERTISE SCORE CALCULATION
══════════════════════════════════════════════════════════════════

Component                           Weight    Your Score
────────────────────────────────────────────────────────────
Jobs Completed                       20%      95/100
  └── Based on verified job volume

First-Time Fix Rate                  25%      94/100
  └── Jobs resolved without callback

Specialisation Depth                 20%      92/100
  └── Expertise in specific areas

Community Contribution               15%      96/100
  └── Solutions shared, techs helped

Experience Breadth                   10%      90/100
  └── Variety of equipment serviced

Certification Status                 10%      100/100
  └── Verified professional credentials
────────────────────────────────────────────────────────────
TOTAL EXPERTISE SCORE                         94/100

Percentile: Top 3%

══════════════════════════════════════════════════════════════════
```

---

## Career Progression

### The SiteSync Career Ladder

```
YOUR SITESYNC JOURNEY
══════════════════════════════════════════════════════════════════


                         ┌─────────────────────┐
                         │   INDUSTRY LEGEND   │
                         │   Score: 95-100     │
                         │                     │
                         │ • Top 1% globally   │
                         │ • Thousands helped  │
                         │ • Legacy impact     │
                         │ • Industry shaping  │
                         └──────────┬──────────┘
                                    │
                         ┌──────────┴──────────┐
                         │  MASTER TECHNICIAN  │
                         │   Score: 80-94      │
                         │                     │
                         │ • Industry expert   │
                         │ • Major contributor │
                         │ • Premium opps      │
                         │ • Mentor to many    │
                         └──────────┬──────────┘
                                    │
                         ┌──────────┴──────────┐
                         │   TRUSTED EXPERT    │
                         │   Score: 60-79      │
                         │                     │
                         │ • Go-to specialist  │
                         │ • Sought by employ  │
                         │ • Regular contrib   │
                         │ • Growing rep       │
                         └──────────┬──────────┘
                                    │
                         ┌──────────┴──────────┐
                         │    RISING STAR      │
                         │   Score: 40-59      │
                         │                     │
                         │ • Contributing      │
                         │ • Building profile  │
                         │ • Getting noticed   │
                         │ • Developing skills │
                         └──────────┬──────────┘
                                    │
                         ┌──────────┴──────────┐
                         │     APPRENTICE      │
                         │   Score: 0-39       │
                         │                     │
                         │ • Learning          │
                         │ • Building history  │
                         │ • Absorbing wisdom  │
                         │ • Starting journey  │
                         └─────────────────────┘


══════════════════════════════════════════════════════════════════

EVERY TECHNICIAN STARTS SOMEWHERE.
EVERY MASTER WAS ONCE AN APPRENTICE.
YOUR JOURNEY IS YOURS TO BUILD.
```

### Leveling Up

How to progress through each stage:

| Level | How to Reach | What Opens Up |
|-------|--------------|---------------|
| **Apprentice** | Join SiteSync | Access to collective knowledge |
| **Rising Star** | Complete 100+ jobs, start contributing | Visibility to employers |
| **Trusted Expert** | Strong first-fix rate, regular contributions | Premium job opportunities |
| **Master Technician** | Top 20%, significant community impact | Industry recognition, mentorship |
| **Industry Legend** | Top 1%, lasting contributions | Speaking invitations, advisory roles |

---

## Recognition & Badges

### Achievements That Tell Your Story

Badges are earned through your work and contributions. They appear on your profile and show specific accomplishments.

```
ACHIEVEMENT BADGES
══════════════════════════════════════════════════════════════════

EXPERIENCE BADGES
─────────────────

┌─────────────┐ ┌─────────────┐ ┌─────────────┐ ┌─────────────┐
│     🔧      │ │     🔧      │ │     🔧      │ │     🔧      │
│   FIRST     │ │   CENTURY   │ │  THOUSAND   │ │   VETERAN   │
│    100      │ │    CLUB     │ │   MASTER    │ │   (5000+)   │
│             │ │   (500+)    │ │  (1000+)    │ │             │
│ 100 jobs    │ │  500 jobs   │ │ 1000 jobs   │ │ 5000 jobs   │
└─────────────┘ └─────────────┘ └─────────────┘ └─────────────┘


QUALITY BADGES
──────────────

┌─────────────┐ ┌─────────────┐ ┌─────────────┐ ┌─────────────┐
│     🎯      │ │     🎯      │ │     🎯      │ │     🎯      │
│  RELIABLE   │ │   EXPERT    │ │   MASTER    │ │   PERFECT   │
│             │ │             │ │             │ │             │
│ 85% first   │ │ 90% first   │ │ 95% first   │ │ 99% first   │
│ fix rate    │ │ fix rate    │ │ fix rate    │ │ fix rate    │
└─────────────┘ └─────────────┘ └─────────────┘ └─────────────┘


CONTRIBUTION BADGES
───────────────────

┌─────────────┐ ┌─────────────┐ ┌─────────────┐ ┌─────────────┐
│     💡      │ │     💡      │ │     💡      │ │     💡      │
│   HELPER    │ │  PROBLEM    │ │  KNOWLEDGE  │ │   WISDOM    │
│             │ │   SOLVER    │ │   KEEPER    │ │   MASTER    │
│ 10 tips     │ │ 25 tips     │ │ 50 tips     │ │ 100+ tips   │
│ shared      │ │ shared      │ │ shared      │ │ shared      │
└─────────────┘ └─────────────┘ └─────────────┘ └─────────────┘


IMPACT BADGES
─────────────

┌─────────────┐ ┌─────────────┐ ┌─────────────┐ ┌─────────────┐
│     ⭐      │ │     ⭐      │ │     ⭐      │ │     ⭐      │
│   HELPER    │ │  INFLUENCER │ │   LEADER    │ │   LEGEND    │
│    100      │ │             │ │             │ │             │
│             │ │ 500 techs   │ │ 1000 techs  │ │ 5000 techs  │
│ 100 techs   │ │ helped      │ │ helped      │ │ helped      │
│ helped      │ │             │ │             │ │             │
└─────────────┘ └─────────────┘ └─────────────┘ └─────────────┘


SPECIALISATION BADGES
─────────────────────

┌─────────────┐ ┌─────────────┐ ┌─────────────┐ ┌─────────────┐
│     🏅      │ │     🏅      │ │     🏅      │ │     🏅      │
│    KONE     │ │    OTIS     │ │  SCHINDLER  │ │    DOOR     │
│   EXPERT    │ │   EXPERT    │ │   EXPERT    │ │   MASTER    │
│             │ │             │ │             │ │             │
│ 200+ KONE   │ │ 200+ Otis   │ │ 200+ Sch.   │ │ 500+ door   │
│ jobs        │ │ jobs        │ │ jobs        │ │ jobs        │
└─────────────┘ └─────────────┘ └─────────────┘ └─────────────┘


COMMUNITY BADGES
────────────────

┌─────────────┐ ┌─────────────┐ ┌─────────────┐ ┌─────────────┐
│     🤝      │ │     🌟      │ │     🏆      │ │     👑      │
│   MENTOR    │ │   RISING    │ │   TOP 10%   │ │   TOP 1%    │
│             │ │    STAR     │ │             │ │             │
│ Guided 10+  │ │ Fastest     │ │ Expertise   │ │ Expertise   │
│ new techs   │ │ growing     │ │ top 10%     │ │ top 1%      │
└─────────────┘ └─────────────┘ └─────────────┘ └─────────────┘

══════════════════════════════════════════════════════════════════

EVERY BADGE TELLS A STORY.
EVERY STORY BUILDS YOUR CAREER.
```

---

## Knowledge Contribution

### Sharing What You Know

When you solve a problem, you can share that solution with the community. Your contribution helps other technicians and builds your reputation.

```
CONTRIBUTION FLOW
══════════════════════════════════════════════════════════════════

1. YOU SOLVE A PROBLEM
   └── KONE MonoSpace showing F505 on humid days

2. YOU DOCUMENT THE SOLUTION
   ┌─────────────────────────────────────────────────────────────┐
   │ SHARE YOUR KNOWLEDGE                                        │
   │                                                             │
   │ Equipment: KONE MonoSpace                                   │
   │ Fault Code: F505                                            │
   │ Situation: False alarm on humid days (>80% humidity)        │
   │                                                             │
   │ Solution:                                                   │
   │ The door zone sensor is moisture-sensitive. On humid days,  │
   │ F505 triggers falsely. Check sensor housing seal first.     │
   │ If intact, the sensor itself may need replacing with the    │
   │ updated moisture-resistant version (part #KM-DZ-505R).      │
   │                                                             │
   │ Time Saved: ~2 hours (avoids misdiagnosis)                  │
   │                                                             │
   │ [Submit Contribution]                                       │
   └─────────────────────────────────────────────────────────────┘

3. AI VALIDATES & ENHANCES
   └── Cross-references with similar cases
   └── Adds relevant documentation links
   └── Makes searchable for others

4. COMMUNITY BENEFITS
   └── Next tech with F505 finds your solution
   └── They solve it in 30 min instead of 3 hours

5. YOU GET CREDIT
   └── Your contribution is tracked
   └── Every use builds your reputation
   └── "Used by 847 technicians"

══════════════════════════════════════════════════════════════════
```

### Types of Contributions

| Contribution Type | Description | Impact |
|-------------------|-------------|--------|
| **Quick Tip** | Brief insight or shortcut | Helps many, builds rep |
| **Solution Guide** | Detailed problem resolution | High value, high recognition |
| **Equipment Quirk** | Known issue with specific equipment | Prevents repeated mistakes |
| **Procedure** | Step-by-step process | Reference material |
| **Safety Note** | Important safety information | Critical, highest value |

### Your Contribution Impact

```
YOUR CONTRIBUTION DASHBOARD
══════════════════════════════════════════════════════════════════

TOTAL CONTRIBUTIONS: 156

IMPACT SUMMARY
──────────────
• Technicians helped: 1,247
• Estimated hours saved: 2,700+
• Most popular: "KONE F505 Humidity Fix" (847 uses)

CONTRIBUTION BREAKDOWN
──────────────────────
Solutions:        42  ████████████████
Quick Tips:       78  ██████████████████████████████
Equipment Notes:  28  ███████████
Procedures:        8  ███

RECENT ACTIVITY
───────────────
• Your "Door Operator Calibration" was used 12 times this week
• David C. thanked you for "Gen2 Reset Sequence"
• New technician used 3 of your tips today

══════════════════════════════════════════════════════════════════
```

### Privacy Options

You control how your contributions are attributed:

```
CONTRIBUTION PRIVACY
══════════════════════════════════════════════════════════════════

Option 1: FULL ATTRIBUTION (Default)
────────────────────────────────────
• Your name on contribution
• Builds your personal reputation
• Shows on your profile

Option 2: COMPANY ATTRIBUTION
─────────────────────────────
• Company name shown
• Personal rep still tracked privately
• Good for employer requirements

Option 3: ANONYMOUS
───────────────────
• "Community Contributor"
• Still tracked privately for your score
• Knowledge shared without identification

══════════════════════════════════════════════════════════════════

YOUR KNOWLEDGE. YOUR CHOICE.
```

---

## Resume Integration

### Adding SiteSync to Your CV

Your SiteSync profile becomes a powerful addition to your traditional resume:

```
RESUME EXAMPLE
══════════════════════════════════════════════════════════════════

MARIA SANTOS
Master Elevator Technician
Sydney, Australia

────────────────────────────────────────────────────────────────

EXPERIENCE
──────────
Summit Elevator Services                          2020 - Present
Senior Technician
• Lead technician for commercial portfolio
• Specialising in modernisation projects
• Mentoring junior technicians

Acme Lift Services                                2015 - 2020
Technician
• General maintenance and repair
• Emergency callout response
• Multi-brand experience

────────────────────────────────────────────────────────────────

CERTIFICATIONS
──────────────
• A-Grade Elevator Mechanic (NSW)
• KONE Certified Technician
• Working at Heights
• Electrical License (Class 2)

────────────────────────────────────────────────────────────────

SITESYNC VERIFIED PROFILE
──────────────────────────
🔗 sitesync.com/tech/maria-santos

┌─────────────────────────────────────────────────────────────┐
│                                                             │
│  VERIFIED PERFORMANCE                                       │
│                                                             │
│  ✓ 2,847 jobs completed                                     │
│  ✓ 94% first-time fix rate                                  │
│  ✓ Top 3% expertise score (94/100)                          │
│  ✓ 156 community contributions                              │
│  ✓ 1,200+ technicians helped                                │
│                                                             │
│  SPECIALISATIONS                                            │
│  ★★★★★ KONE Systems                                         │
│  ★★★★★ Door Systems                                         │
│  ★★★★☆ Modernisation                                        │
│                                                             │
│  "View complete verified work history"                      │
│                                                             │
└─────────────────────────────────────────────────────────────┘

────────────────────────────────────────────────────────────────

REFERENCES
──────────
Available upon request

══════════════════════════════════════════════════════════════════
```

### What Employers See

When an employer clicks your SiteSync link:

```
EMPLOYER VIEW
══════════════════════════════════════════════════════════════════

VERIFIED INFORMATION
────────────────────
• Complete job history (verified by buildings served)
• Actual first-time fix rate (calculated from real outcomes)
• Equipment types serviced (verified from job records)
• Certifications (verification available)
• Community contributions (visible impact)
• Endorsements from managers and peers

WHAT THEY CAN'T GET FROM A TRADITIONAL RESUME
─────────────────────────────────────────────
• Actual performance metrics
• Verified specialisation depth
• Real track record
• Community standing
• Contribution to the profession

══════════════════════════════════════════════════════════════════

YOUR WORK SPEAKS FOR ITSELF.
```

---

## Finding Opportunities

### Employers Find You

With a strong SiteSync profile, opportunities come to you:

```
OPPORTUNITY MATCHING
══════════════════════════════════════════════════════════════════

YOUR PROFILE SETTINGS
─────────────────────
Status: ● Open to Opportunities

Interested in:
☑ Full-time positions
☑ Contract work
☐ Part-time
☑ Remote/hybrid where applicable

Location: Sydney (willing to relocate: Melbourne, Brisbane)

Preferred:
☑ KONE specialist roles
☑ Modernisation projects
☑ Senior/Lead positions

────────────────────────────────────────────────────────────────

EMPLOYERS SEARCHING FOR TECHS LIKE YOU
──────────────────────────────────────

[Opportunity 1]
Senior Elevator Technician - Sydney
Major Property Services Co.
Match: 94%
"Looking for KONE expert with 90%+ first-fix rate"
[View Details] [Express Interest]

[Opportunity 2]
Lead Technician - Modernisation Projects
Elevator Excellence Ltd
Match: 89%
"Need experienced tech for CBD modernisation portfolio"
[View Details] [Express Interest]

[Opportunity 3]
Technical Trainer - Part Time
Industry Training Academy
Match: 82%
"Seeking experienced tech to train next generation"
[View Details] [Express Interest]

══════════════════════════════════════════════════════════════════

YOUR REPUTATION OPENS DOORS.
```

### Profile Visibility

Control who can find you:

| Setting | Who Can See | Best For |
|---------|-------------|----------|
| **Public** | Anyone searching | Actively seeking work |
| **Open to Opportunities** | Verified employers only | Passive job search |
| **Connections Only** | People you've worked with | Not seeking work |
| **Private** | Only you | Focus on current role |

---

## Learning From the Community

### Collective Wisdom at Your Fingertips

As a SiteSync technician, you have access to knowledge from thousands of experienced professionals:

```
KNOWLEDGE ACCESS
══════════════════════════════════════════════════════════════════

SCENARIO: You're stuck on an unfamiliar fault

YOU: "KONE EcoDisc showing E45, haven't seen this before"

SITESYNC AI:
─────────────
"E45 on KONE EcoDisc indicates motor temperature sensor fault.

Based on 234 similar cases in the community:

Most Common Causes:
1. Sensor connector loose (67% of cases)
   └── Check connector at motor terminal block

2. Sensor failure (21% of cases)
   └── Test sensor resistance: should be 1.8-2.2kΩ at 20°C

3. Controller board fault (8% of cases)
   └── Rare - check other causes first

Community Tips:
• 'Always check the connector first - 5 minute fix vs 2 hour
   misdiagnosis' - James T., Master Technician

• 'If sensor tests good, check for water ingress in terminal
   box' - Maria S., 12 years KONE experience

Related Documentation:
• KONE EcoDisc Service Manual - Section 7.4
• Temperature Sensor Testing Procedure

This solution helped 89 technicians resolve E45."

══════════════════════════════════════════════════════════════════

DECADES OF WISDOM, AVAILABLE IN SECONDS.
```

---

## Getting Started

### Creating Your Profile

```
GETTING STARTED
══════════════════════════════════════════════════════════════════

STEP 1: SIGN UP (2 minutes)
───────────────────────────
• Basic information
• Current employer (optional)
• Location

STEP 2: ADD CERTIFICATIONS (5 minutes)
──────────────────────────────────────
• Upload or link certificates
• Verification process
• Adds credibility immediately

STEP 3: START WORKING (Ongoing)
───────────────────────────────
• Complete jobs through SiteSync
• Each job builds your profile automatically
• Quality work = growing reputation

STEP 4: CONTRIBUTE (When you're ready)
──────────────────────────────────────
• Share solutions you discover
• Help fellow technicians
• Build your expertise score faster

STEP 5: GROW YOUR CAREER
────────────────────────
• Profile grows with every job
• Reputation becomes visible
• Opportunities find you

══════════════════════════════════════════════════════════════════

FREE FOR ALL TECHNICIANS.
YOUR EXPERTISE FINALLY COUNTS.
```

### What It Costs

```
PRICING FOR TECHNICIANS
══════════════════════════════════════════════════════════════════

BASIC PROFILE: FREE
───────────────────
• Professional profile
• Verified job tracking
• Expertise score
• Basic badges
• Access to community knowledge
• Resume link

PREMIUM PROFILE: $9/month (optional)
────────────────────────────────────
Everything in Basic, plus:
• Enhanced profile customisation
• Priority visibility to employers
• Detailed analytics
• Advanced opportunity matching
• Profile download for print
• Early access to new features

══════════════════════════════════════════════════════════════════

YOUR REPUTATION GROWS FOR FREE.
PREMIUM IS OPTIONAL.
```

---

## The Value For You

```
╔══════════════════════════════════════════════════════════════════╗
║                                                                  ║
║   YOUR EXPERTISE. YOUR REPUTATION. YOUR CAREER.                  ║
║                                                                  ║
║   ────────────────────────────────────────────────────────────   ║
║                                                                  ║
║   Every job you complete builds your verified track record.      ║
║                                                                  ║
║   Every solution you share demonstrates your expertise.          ║
║                                                                  ║
║   Every technician you help grows your standing.                 ║
║                                                                  ║
║   ────────────────────────────────────────────────────────────   ║
║                                                                  ║
║   Your 20 years of experience finally has proof.                 ║
║   Your problem-solving ability finally has data.                 ║
║   Your contribution to the profession finally counts.            ║
║                                                                  ║
║   ────────────────────────────────────────────────────────────   ║
║                                                                  ║
║   This is your career, made visible.                             ║
║   This is your expertise, made portable.                         ║
║   This is your work, speaking for itself.                        ║
║                                                                  ║
╚══════════════════════════════════════════════════════════════════╝
```

---

**[← Back to For Buildings](for-buildings.md)** | **[Next: Platform & Ecosystem →](platform-ecosystem.md)**


<!-- FILE: docs/explanation/platform-ecosystem.md -->

# SiteSync V3 - Platform & Ecosystem

## How Everything Connects

> This document explains how SiteSync creates a growing ecosystem where buildings, technicians, service companies, and knowledge all connect to create compounding value for everyone.

---

## The Platform Vision

```
╔══════════════════════════════════════════════════════════════════╗
║                                                                  ║
║   ONE PLATFORM. EVERYONE CONNECTED. EVERYONE BENEFITS.           ║
║                                                                  ║
║   Buildings own their data.                                      ║
║   Technicians own their reputation.                              ║
║   Knowledge flows to where it's needed.                          ║
║   The whole industry rises together.                             ║
║                                                                  ║
╚══════════════════════════════════════════════════════════════════╝
```

---

## The Ecosystem Map

### Who Participates

```
THE SITESYNC ECOSYSTEM
══════════════════════════════════════════════════════════════════

                         ┌─────────────────┐
                         │   SITESYNC     │
                         │    PLATFORM     │
                         └────────┬────────┘
                                  │
          ┌───────────────────────┼───────────────────────┐
          │                       │                       │
          ▼                       ▼                       ▼
   ┌─────────────┐        ┌─────────────┐        ┌─────────────┐
   │  BUILDINGS  │        │ TECHNICIANS │        │   SERVICE   │
   │             │        │             │        │  COMPANIES  │
   │ Own their   │        │ Own their   │        │             │
   │ data        │        │ reputation  │        │ Access jobs │
   │             │        │             │        │ & talent    │
   │ Pay for     │        │ Free access │        │             │
   │ platform    │        │ to platform │        │ Pay for     │
   │             │        │             │        │ tools       │
   └──────┬──────┘        └──────┬──────┘        └──────┬──────┘
          │                      │                      │
          │                      │                      │
          ▼                      ▼                      ▼
   ┌─────────────────────────────────────────────────────────────┐
   │                                                             │
   │                    SHARED VALUE                             │
   │                                                             │
   │  ┌─────────────┐  ┌─────────────┐  ┌─────────────┐         │
   │  │ COLLECTIVE  │  │    PARTS    │  │   BETTER    │         │
   │  │ KNOWLEDGE   │  │ MARKETPLACE │  │  OUTCOMES   │         │
   │  └─────────────┘  └─────────────┘  └─────────────┘         │
   │                                                             │
   └─────────────────────────────────────────────────────────────┘

══════════════════════════════════════════════════════════════════

EVERYONE CONTRIBUTES. EVERYONE BENEFITS.
```

### Value Exchange

Each participant gives something and gets something:

| Participant | What They Give | What They Get |
|-------------|----------------|---------------|
| **Buildings** | Monthly fee, access permissions | Permanent data ownership, choice, insights |
| **Technicians** | Job completion, knowledge sharing | Visible reputation, career growth, wisdom access |
| **Service Companies** | Service delivery, platform use | Job access, operational tools, talent pool |
| **The Platform** | Technology, AI, infrastructure | Revenue, data, network growth |

---

## Collective Intelligence

### How Knowledge Compounds

The more people use SiteSync, the smarter the entire system becomes.

```
COLLECTIVE INTELLIGENCE MODEL
══════════════════════════════════════════════════════════════════

INDIVIDUAL KNOWLEDGE
────────────────────
Maria knows: "KONE F505 on humid days is usually false alarm"
James knows: "Otis E41 - check cable harness before encoder"
Sarah knows: "Schindler 3300 leveling issues = vane not sensor"

                    │
                    ▼

AI SYNTHESIS
────────────
┌─────────────────────────────────────────────────────────────┐
│                                                             │
│  SiteSync AI combines knowledge from:                      │
│  • 10,000+ technicians                                      │
│  • 500,000+ completed jobs                                  │
│  • 100,000+ documented solutions                            │
│  • Manufacturer documentation                               │
│  • Historical patterns                                      │
│                                                             │
└─────────────────────────────────────────────────────────────┘

                    │
                    ▼

COLLECTIVE WISDOM
─────────────────
Any technician can now access:
• "F505 on KONE MonoSpace: 847 techs solved this.
   67% was humidity-related false alarm. Check sensor seal."

• "E41 on Otis Gen2: 412 cases. Check cable harness first
   (saves 2 hours vs. replacing encoder)"

• "Schindler 3300 leveling: 89% of cases were vane, not sensor.
   Start there."

══════════════════════════════════════════════════════════════════

ONE TECHNICIAN'S INSIGHT HELPS THOUSANDS.
THOUSANDS OF INSIGHTS CREATE UNMATCHED WISDOM.
```

### Knowledge Growth Curve

```
KNOWLEDGE ACCUMULATION
══════════════════════════════════════════════════════════════════

Year 1:   1,000 solutions
          ████

Year 2:   10,000 solutions (10x growth)
          ████████████████████████████████████████

Year 3:   50,000 solutions
          ████████████████████████████████████████████████████████

Year 5:   500,000+ solutions
          [COMPREHENSIVE COVERAGE OF ALL EQUIPMENT & SCENARIOS]

══════════════════════════════════════════════════════════════════

This knowledge base becomes:
• Impossible to replicate (would take years)
• More valuable over time (network effects)
• A permanent competitive advantage
```

### How AI Makes It Useful

Raw knowledge isn't enough - AI makes it accessible:

```
AI CAPABILITIES
══════════════════════════════════════════════════════════════════

1. PATTERN RECOGNITION
   └── "This fault code, on this equipment, in these conditions,
        has been solved 847 times. Here's what worked."

2. CONTEXTUAL RELEVANCE
   └── "Based on this specific unit's history and the current
        symptoms, the most likely cause is..."

3. PREDICTIVE INSIGHTS
   └── "Similar units in similar buildings typically need
        this part replaced at this age."

4. NATURAL LANGUAGE
   └── Technician speaks: "Door won't close properly"
       AI understands: [door fault + closing issue]
       AI responds: "Based on symptoms, likely causes are..."

5. CONTINUOUS LEARNING
   └── Every resolved job teaches the AI
   └── Every contribution adds to the knowledge
   └── The system gets smarter every day

══════════════════════════════════════════════════════════════════
```

---

## Parts Marketplace

### Connecting Supply and Demand

The parts marketplace connects technicians who have parts with those who need them.

```
PARTS MARKETPLACE
══════════════════════════════════════════════════════════════════

┌─────────────────────────────────────────────────────────────────┐
│                                                                 │
│  SEARCH: KONE Door Sensor KM-DZ-505                            │
│                                                                 │
│  ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━  │
│                                                                 │
│  AVAILABLE NOW                                                  │
│  ─────────────                                                  │
│                                                                 │
│  ┌───────────────────────────────────────────────────────────┐  │
│  │ $35 - NEW                                    Sydney       │  │
│  │ Sarah M. - Rating: 94                        2.3 km away  │  │
│  │ "Ordered spare, project cancelled"                        │  │
│  │ [Contact] [Reserve]                                       │  │
│  └───────────────────────────────────────────────────────────┘  │
│                                                                 │
│  ┌───────────────────────────────────────────────────────────┐  │
│  │ $25 - USED (Tested Working)                  Melbourne    │  │
│  │ James T. - Rating: 91                        Ships today  │  │
│  │ "Removed during modernisation, 2 years service"           │  │
│  │ [Contact] [Reserve]                                       │  │
│  └───────────────────────────────────────────────────────────┘  │
│                                                                 │
│  ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━  │
│                                                                 │
│  SUPPLIERS                                                      │
│  ─────────                                                      │
│                                                                 │
│  KONE Direct:      $47  │  Next day delivery                    │
│  Motion Australia: $52  │  Same day (order by 2pm)              │
│  Elevator Parts:   $44  │  2-3 days                             │
│                                                                 │
└─────────────────────────────────────────────────────────────────┘

══════════════════════════════════════════════════════════════════

FIND PARTS FASTER. SAVE MONEY. REDUCE WASTE.
```

### Van Stock Management

Every technician can track what's in their vehicle:

```
VAN STOCK - SARAH M.
══════════════════════════════════════════════════════════════════

MY INVENTORY                                    Value: $2,340
────────────────────────────────────────────────────────────────

Item                          Qty    Min    Status
─────────────────────────────────────────────────────────────
KONE Door Sensor KM-DZ-505     2      1     ● Good
Otis Interlock Switch          1      1     ● Good
Generic Door Rollers (set)     3      2     ● Good
Schindler Encoder Belt         0      1     ○ LOW - Reorder
Safety Contact Set             2      1     ● Good
...

ALERTS
──────
⚠ Schindler Encoder Belt below minimum - [Reorder]
ℹ Door Sensor available - 3 nearby techs need this part

NEARBY REQUESTS
───────────────
James T. (2.1 km) needs: KONE Door Sensor
  └── You have 2 in stock
  └── [Offer to Sell] [Message James]

══════════════════════════════════════════════════════════════════
```

### The Marketplace Flywheel

```
MARKETPLACE GROWTH
══════════════════════════════════════════════════════════════════

              More Sellers
                   │
                   ▼
         ┌─────────────────┐
         │ Better Selection│
         │ Lower Prices    │
         └────────┬────────┘
                  │
                  ▼
              More Buyers
                  │
                  ▼
         ┌─────────────────┐
         │ More Listings   │
         │ Faster Sales    │
         └────────┬────────┘
                  │
                  └──────► More Sellers
                           (cycle continues)

══════════════════════════════════════════════════════════════════

THE MORE PEOPLE PARTICIPATE, THE BETTER IT WORKS FOR EVERYONE.
```

### Revenue Model

| Transaction Type | Fee | Who Pays |
|-----------------|-----|----------|
| Peer-to-peer sale | 5% | Seller |
| Supplier listing | 3% | Supplier |
| Premium placement | Flat fee | Supplier |

---

## Network Effects

### Four Reinforcing Loops

SiteSync has multiple network effects that compound over time:

```
NETWORK EFFECT 1: KNOWLEDGE
══════════════════════════════════════════════════════════════════

More Technicians
      │
      ▼
More Knowledge Contributed
      │
      ▼
Better AI / Better Solutions
      │
      ▼
More Value for Technicians
      │
      └──────► More Technicians Join

══════════════════════════════════════════════════════════════════


NETWORK EFFECT 2: BUILDINGS & CONTRACTORS
══════════════════════════════════════════════════════════════════

More Buildings
      │
      ▼
Contractors Must Join to Access Work
      │
      ▼
More Contractors on Platform
      │
      ▼
Better Service Options for Buildings
      │
      └──────► More Buildings Join

══════════════════════════════════════════════════════════════════


NETWORK EFFECT 3: PARTS MARKETPLACE
══════════════════════════════════════════════════════════════════

More Participants
      │
      ▼
More Parts Available
      │
      ▼
Better Prices & Faster Availability
      │
      ▼
More Reasons to Use Marketplace
      │
      └──────► More Participants

══════════════════════════════════════════════════════════════════


NETWORK EFFECT 4: REPUTATION
══════════════════════════════════════════════════════════════════

More Technicians Building Profiles
      │
      ▼
Employers Rely on SiteSync for Hiring
      │
      ▼
Profile Becomes Essential for Career
      │
      ▼
More Technicians Invest in Profile
      │
      └──────► More Complete Data

══════════════════════════════════════════════════════════════════
```

### Compounding Value

```
VALUE OVER TIME
══════════════════════════════════════════════════════════════════

Year 1:  Platform works
         Basic features, small community
         Value: ████

Year 3:  Network effects emerging
         Growing knowledge base, marketplace active
         Value: ████████████████

Year 5:  Strong network effects
         Comprehensive knowledge, dominant marketplace
         Value: ████████████████████████████████████████

Year 10: Industry standard
         Irreplaceable knowledge, essential infrastructure
         Value: [EXTRAORDINARY]

══════════════════════════════════════════════════════════════════

THE PLATFORM BECOMES MORE VALUABLE EVERY DAY.
THIS VALUE IS SHARED WITH ALL PARTICIPANTS.
```

---

## The Invisible AI Principle

### AI That Disappears

Throughout the platform, AI is present everywhere but visible nowhere.

```
THE INVISIBLE AI PRINCIPLE
══════════════════════════════════════════════════════════════════

WHAT USERS EXPERIENCE          WHAT AI IS DOING
────────────────────           ────────────────────

"The app knew which job       GPS + calendar + building data
 I was going to"              = predictive job context

"It read the nameplate        Computer vision + OCR +
 instantly"                   database lookup

"The report wrote itself"     NLP + job data + template
                              selection + formatting

"It suggested exactly the     Symptom analysis + historical
 right part"                  patterns + inventory check

"My schedule was already      Route optimisation + priority
 perfect"                     weighting + traffic data

══════════════════════════════════════════════════════════════════

USERS DON'T SAY: "THE AI IS AMAZING"
USERS SAY: "THIS TOOL IS AMAZING"

THAT'S THE GOAL.
```

### AI Touchpoints

Every major interaction has invisible AI assistance:

| User Action | AI Behind the Scenes |
|-------------|---------------------|
| Open app at site | Context detection, job lookup |
| Photograph equipment | Image recognition, data extraction |
| Describe symptoms | NLP, pattern matching, diagnosis |
| Search for parts | Availability prediction, pricing |
| Complete job | Report generation, quality check |
| Schedule next week | Route optimisation, priority balancing |

### The "How Did It Know?" Moments

These moments create word-of-mouth and user delight:

```
MAGIC MOMENTS
══════════════════════════════════════════════════════════════════

MOMENT: ARRIVAL RECOGNITION
───────────────────────────
Technician pulls into parking lot.
Before they even open the app:
"Good morning! You're at 123 Collins St for the Lift 2 service."

Reaction: "How did it know?"

────────────────────────────────────────────────────────────────

MOMENT: CAMERA INTELLIGENCE
───────────────────────────
Technician points phone at equipment nameplate.
App instantly shows:
• Equipment identified: KONE MonoSpace 2015
• Manual downloaded
• This unit's history
• Known quirks: "Humidity sensitive - F505 may be false alarm"

Reaction: "This is incredible."

────────────────────────────────────────────────────────────────

MOMENT: COLLEAGUE FINDER
────────────────────────
Technician is stuck on an unusual fault.
App shows:
"Maria S. is 2.3km away. She's solved this fault 12 times.
 She's currently available. [Request Help]"

Reaction: "How did it know to suggest her?"

────────────────────────────────────────────────────────────────

MOMENT: PREDICTIVE ALERT
────────────────────────
Building manager receives notification:
"Lift 1 motor showing early wear patterns. Based on similar
 units, service recommended within 3 months. Schedule now?"

Building wasn't even thinking about Lift 1.
AI was watching patterns across thousands of similar units.

Reaction: "It warned us before there was a problem?"

══════════════════════════════════════════════════════════════════
```

---

## Multi-Trade Expansion

### Starting Focused, Expanding Strategically

SiteSync starts with elevators (deep expertise) and expands to all building trades.

```
EXPANSION STRATEGY
══════════════════════════════════════════════════════════════════

PHASE 1: ELEVATORS (Launch)
───────────────────────────
• Deepest expertise
• Clear pain points
• Defined market
• Prove the model

PHASE 2: VERTICAL TRANSPORT (Year 1-2)
──────────────────────────────────────
• Escalators
• Moving walkways
• Platform lifts
• Natural extension, same customers

PHASE 3: MECHANICAL TRADES (Year 2-3)
─────────────────────────────────────
• HVAC
• Plumbing
• Fire systems
• Similar service model, building managers want unified view

PHASE 4: ALL BUILDING SERVICES (Year 3+)
────────────────────────────────────────
• Electrical
• Security
• Painting/fit-out
• Cleaning
• Complete building operating system

══════════════════════════════════════════════════════════════════
```

### Unified Building View

Building managers benefit from seeing all trades in one place:

```
MULTI-TRADE DASHBOARD
══════════════════════════════════════════════════════════════════

123 COLLINS STREET - BUILDING HEALTH: 91/100
────────────────────────────────────────────────────────────────

TRADE           HEALTH    OPEN JOBS    NEXT DUE
──────────────────────────────────────────────────────────────
Lifts           94/100       1         Preventive (14 days)
HVAC            88/100       0         Filter change (7 days)
Fire            95/100       0         Annual inspection (89 days)
Electrical      89/100       1         Emergency light test (30 days)
Plumbing        92/100       0         Backflow test (45 days)
Security        90/100       0         System check (21 days)

──────────────────────────────────────────────────────────────

ONE DASHBOARD. ALL TRADES. COMPLETE VISIBILITY.

══════════════════════════════════════════════════════════════════
```

### Trade-Specific AI

Each trade has specialised AI trained on that domain:

```
SPECIALIZED AI BY TRADE
══════════════════════════════════════════════════════════════════

LIFT AI
───────
• Fault code interpretation
• Door system diagnostics
• Drive system patterns
• Safety circuit analysis
• Trained on: 100,000+ lift service records

HVAC AI
───────
• Compressor diagnostics
• Refrigerant cycle analysis
• Airflow optimisation
• Energy efficiency patterns
• Trained on: HVAC-specific knowledge base

FIRE AI
───────
• Detection system analysis
• Compliance requirements
• Suppression system diagnostics
• Emergency lighting
• Trained on: Fire safety standards + service data

ELECTRICAL AI
─────────────
• Circuit analysis
• Load balancing
• Power quality diagnostics
• Emergency power systems
• Trained on: Electrical service patterns

══════════════════════════════════════════════════════════════════

EACH TRADE GETS PURPOSE-BUILT INTELLIGENCE.
```

---

## Platform Economics

### Value Distribution

How value flows through the ecosystem:

```
VALUE FLOW
══════════════════════════════════════════════════════════════════

BUILDINGS PAY: $29/month
├── What they get:
│   ├── Permanent data ownership
│   ├── AI insights
│   ├── Building Health Score
│   ├── Complete visibility
│   └── Freedom of choice
│
└── Value: Estimated $500-2,000/month in
           efficiency gains, better decisions,
           property value protection

TECHNICIANS PAY: $0-9/month
├── What they get:
│   ├── Professional profile
│   ├── Reputation building
│   ├── Career advancement
│   ├── Knowledge access
│   └── Job opportunities
│
└── Value: Career growth, higher earnings,
           professional recognition

SERVICE COMPANIES PAY: Tools + Transaction Fees
├── What they get:
│   ├── Access to building jobs
│   ├── Operational tools
│   ├── Workforce management
│   └── Parts marketplace
│
└── Value: More jobs, better operations,
           access to qualified talent

══════════════════════════════════════════════════════════════════
```

### Unit Economics

```
PLATFORM UNIT ECONOMICS
══════════════════════════════════════════════════════════════════

Revenue per Building:        $29/month ($348/year)
Gross Margin:               ~95% (software)
Customer Acquisition Cost:   ~$100 (target)
Lifetime Value:             $1,740 (5-year average)
LTV:CAC Ratio:              17:1

Additional Revenue:
├── Parts marketplace fees:   ~2-5% per transaction
├── Premium tech profiles:    $9/month
├── Enterprise features:      Custom pricing
└── API access:              Usage-based

══════════════════════════════════════════════════════════════════
```

---

## Building the Ecosystem

### Growth Strategy

```
ECOSYSTEM GROWTH PHASES
══════════════════════════════════════════════════════════════════

PHASE 1: SEED THE SUPPLY
────────────────────────
• Recruit quality technicians
• Build initial knowledge base
• Establish credibility
• Free for technicians

PHASE 2: ATTRACT BUILDINGS
──────────────────────────
• Buildings see value in data ownership
• Pay $29/month for platform
• Require their contractors to use SiteSync

PHASE 3: CONTRACTORS FOLLOW
───────────────────────────
• Contractors join to access building work
• They see operational benefits
• They adopt for all their buildings

PHASE 4: FLYWHEEL SPINS
───────────────────────
• More buildings → more contractors must join
• More contractors → more knowledge
• More knowledge → more value for everyone
• More value → more buildings

══════════════════════════════════════════════════════════════════
```

### Critical Mass Indicators

| Indicator | Target | Why It Matters |
|-----------|--------|----------------|
| Active technicians | 1,000+ | Enough knowledge contributors |
| Buildings | 500+ | Enough to create contractor pull |
| Solutions in database | 10,000+ | Comprehensive coverage |
| Parts marketplace listings | 5,000+ | Useful inventory |
| Average jobs per tech/month | 10+ | Active engagement |

---

## The Complete Picture

```
╔══════════════════════════════════════════════════════════════════╗
║                                                                  ║
║                  THE SITESYNC ECOSYSTEM                         ║
║                                                                  ║
║   ┌─────────┐         ┌─────────┐         ┌─────────┐           ║
║   │BUILDINGS│◄───────►│PLATFORM │◄───────►│  TECHS  │           ║
║   │Own Data │         │   AI    │         │Own Rep  │           ║
║   └────┬────┘         └────┬────┘         └────┬────┘           ║
║        │                   │                   │                 ║
║        │    ┌──────────────┴──────────────┐   │                 ║
║        │    │                             │   │                 ║
║        │    ▼                             ▼   │                 ║
║        │  ┌─────────────┐  ┌─────────────┐   │                 ║
║        └─►│ COLLECTIVE  │  │    PARTS    │◄──┘                 ║
║           │  KNOWLEDGE  │  │ MARKETPLACE │                      ║
║           └─────────────┘  └─────────────┘                      ║
║                                                                  ║
║   ────────────────────────────────────────────────────────────   ║
║                                                                  ║
║   Buildings own their data forever.                              ║
║   Technicians own their reputation forever.                      ║
║   Knowledge flows freely to benefit everyone.                    ║
║   The more people participate, the more everyone benefits.       ║
║                                                                  ║
║   ────────────────────────────────────────────────────────────   ║
║                                                                  ║
║   This is not just software.                                     ║
║   This is a new way for an industry to work together.            ║
║                                                                  ║
╚══════════════════════════════════════════════════════════════════╝
```

---

**[← Back to For Technicians](for-technicians.md)** | **[Next: Architecture →](../reference/architecture.md)**


<!-- FILE: docs/explanation/security-compliance.md -->

# SiteSync V3 - Security & Compliance

## Trust, Privacy, and Regulatory Framework

> This document details SiteSync's security architecture, compliance certifications, privacy practices, and regulatory alignment for building services.

---

## Security Philosophy

```
╔══════════════════════════════════════════════════════════════════╗
║                                                                  ║
║   YOUR DATA. YOUR CONTROL.                                       ║
║                                                                  ║
║   SiteSync is built on the principle that buildings own their   ║
║   data. This isn't just philosophy—it's architecture.            ║
║                                                                  ║
║   Every security decision starts with: "Does this protect the    ║
║   building's ownership and control of their information?"        ║
║                                                                  ║
╚══════════════════════════════════════════════════════════════════╝
```

### Security Principles

| Principle | Implementation |
|-----------|----------------|
| **Defense in Depth** | Multiple security layers at every level |
| **Least Privilege** | Access only what's needed, nothing more |
| **Zero Trust** | Verify everything, trust nothing by default |
| **Encryption Everywhere** | Data protected at rest and in transit |
| **Auditability** | Every action logged, traceable, immutable |
| **Transparency** | Clear about what we do with your data |

---

## Compliance Certifications

### Current Certifications

```
COMPLIANCE STATUS
═══════════════════════════════════════════════════════════════════

SOC 2 Type II                                        ✓ Certified
────────────────────────────────────────────────────
Scope: Security, Availability, Confidentiality
Auditor: [Independent Third Party]
Last Audit: [Date]
Report Available: On request (NDA required)

ISO 27001                                            ◐ In Progress
────────────────────────────────────────────────────
Expected: [Target Date]
Scope: Information Security Management System

GDPR Compliant                                       ✓ Compliant
────────────────────────────────────────────────────
Data Processing Agreement available
EU Data Storage option available
Privacy Impact Assessment completed

Australian Privacy Act                               ✓ Compliant
────────────────────────────────────────────────────
APP compliance verified
Privacy Policy aligned with OAIC guidance
Data breach notification procedures in place

═══════════════════════════════════════════════════════════════════
```

### SOC 2 Trust Service Criteria

**Security:**
- Access controls and authentication
- Network security and monitoring
- Vulnerability management
- Incident response procedures

**Availability:**
- System uptime commitments
- Disaster recovery procedures
- Backup and restoration
- Capacity planning

**Confidentiality:**
- Data classification
- Encryption standards
- Access restrictions
- Secure disposal

**Processing Integrity:**
- Data accuracy controls
- Change management
- Quality assurance
- Error handling

**Privacy:**
- Data collection practices
- Use limitation
- Consent management
- Individual rights

---

## Data Protection

### Encryption Standards

```
ENCRYPTION ARCHITECTURE
═══════════════════════════════════════════════════════════════════

DATA IN TRANSIT
───────────────
Protocol: TLS 1.3 (minimum TLS 1.2)
Certificate: EV SSL, auto-renewal
HSTS: Enabled, preloaded
API: All endpoints HTTPS-only

DATA AT REST
────────────
Database: AES-256 encryption (Google Cloud SQL)
Files: AES-256 (Google Cloud Storage)
Backups: AES-256, separate key management
Audit Logs: Encrypted, append-only

KEY MANAGEMENT
──────────────
Provider: Google Cloud KMS
Rotation: Automatic, 90-day cycle
Access: Strictly controlled, audited
Separation: Per-customer keys available (Enterprise)

SENSITIVE FIELDS
────────────────
Passwords: Argon2id hashing
API Keys: SHA-256 hashing
PII: Field-level encryption option
Tokens: Cryptographically random, short-lived

═══════════════════════════════════════════════════════════════════
```

### Data Classification

| Classification | Definition | Examples | Protection |
|----------------|------------|----------|------------|
| **Public** | Non-sensitive, shareable | Marketing content | Basic |
| **Internal** | Business operations | Aggregate analytics | Standard |
| **Confidential** | Customer data | Work orders, equipment | Enhanced |
| **Restricted** | Highly sensitive | Credentials, billing | Maximum |

### Data Isolation

**Multi-Tenant Architecture:**

```
TENANT ISOLATION
═══════════════════════════════════════════════════════════════════

DATABASE LEVEL
──────────────
• Row-Level Security (RLS) enforced in PostgreSQL
• Every query filtered by organization_id
• Application cannot bypass RLS
• Tested and audited regularly

                    ┌─────────────────────────────┐
                    │     SiteSync Platform      │
                    └─────────────────────────────┘
                              │
         ┌────────────────────┼────────────────────┐
         │                    │                    │
   ┌─────▼─────┐        ┌─────▼─────┐        ┌─────▼─────┐
   │ Building A │        │ Building B │        │ Building C │
   │   (RLS)    │        │   (RLS)    │        │   (RLS)    │
   └───────────┘        └───────────┘        └───────────┘

   Building A cannot see Building B's data.
   Ever. By architecture, not just policy.

APPLICATION LEVEL
─────────────────
• Tenant context set at request start
• Validated against authenticated user
• Cannot be modified during request
• Logged for audit purposes

API LEVEL
─────────
• API keys scoped to organization
• Rate limiting per tenant
• Resource quotas enforced
• Cross-tenant requests blocked

═══════════════════════════════════════════════════════════════════
```

---

## Access Control

### Authentication

```
AUTHENTICATION METHODS
═══════════════════════════════════════════════════════════════════

STANDARD AUTHENTICATION
───────────────────────
• Email + Password (minimum 12 characters)
• Password requirements:
  - Minimum 12 characters
  - Complexity recommended, not required
  - Breach database checking (HaveIBeenPwned)
  - No maximum length

MULTI-FACTOR AUTHENTICATION (MFA)
─────────────────────────────────
• TOTP (Google Authenticator, Authy, etc.)
• SMS (as backup only)
• Hardware keys (WebAuthn/FIDO2) - Enterprise
• Required for admin accounts
• Recommended for all users

ENTERPRISE SSO
──────────────
• SAML 2.0
• OIDC (OpenID Connect)
• Supported IdPs:
  - Okta
  - Azure AD
  - Google Workspace
  - OneLogin
  - Custom SAML

PASSWORDLESS OPTIONS
────────────────────
• Magic link (email)
• Passkeys (WebAuthn)
• SSO-only mode

═══════════════════════════════════════════════════════════════════
```

### Authorization Model

**Role-Based Access Control (RBAC):**

```
ROLE HIERARCHY
═══════════════════════════════════════════════════════════════════

BUILDING ROLES
──────────────
Owner
├── Full access to building data
├── Manage users and permissions
├── Invite/remove contractors
├── Export all data
├── Delete building
└── Billing management

Manager
├── View all building data
├── Create/edit work orders
├── Upload documents
├── Invite contractors (with approval)
└── Cannot delete or export

Viewer
├── View building data
├── View work orders (read-only)
└── Cannot create or modify

CONTRACTOR ROLES
────────────────
Service Admin
├── Manage contractor company
├── Add/remove technicians
├── Accept building invitations
├── View all assigned buildings
└── Billing for contractor

Dispatcher
├── Create/assign work orders
├── View assigned buildings
├── Manage schedules
└── Cannot access billing

Technician
├── View assigned work orders
├── Log work performed
├── Access AI diagnosis
├── Update job status
└── Cannot access other techs' data

PLATFORM ROLES
──────────────
System Admin (SiteSync Staff)
├── Platform administration
├── Support access (with customer consent)
├── Cannot view customer data without audit trail
└── All access logged and reviewed

═══════════════════════════════════════════════════════════════════
```

### Permission Matrix

| Resource | Owner | Manager | Viewer | Service Admin | Technician |
|----------|-------|---------|--------|---------------|------------|
| View equipment | ✓ | ✓ | ✓ | ✓ | ✓ (assigned) |
| Edit equipment | ✓ | ✓ | - | - | - |
| View work orders | ✓ | ✓ | ✓ | ✓ | ✓ (assigned) |
| Create work orders | ✓ | ✓ | - | ✓ | - |
| Complete work orders | ✓ | ✓ | - | ✓ | ✓ (assigned) |
| View compliance | ✓ | ✓ | ✓ | ✓ | - |
| Upload documents | ✓ | ✓ | - | ✓ | ✓ |
| Export data | ✓ | - | - | - | - |
| Manage users | ✓ | - | - | ✓ | - |
| Billing access | ✓ | - | - | ✓ | - |

---

## Infrastructure Security

### Cloud Architecture

```
INFRASTRUCTURE OVERVIEW
═══════════════════════════════════════════════════════════════════

CLOUD PROVIDER: Google Cloud Platform (GCP)
─────────────────────────────────────────
• Region: Australia (sydney) primary
• Secondary: US (us-central1) available
• EU region available for EU customers

NETWORK SECURITY
────────────────
• VPC with private subnets
• Cloud Armor (WAF/DDoS protection)
• Cloud NAT for outbound
• No public IPs on compute instances

                     ┌─────────────────────────────┐
                     │      Cloud Armor (WAF)      │
                     │      DDoS Protection        │
                     └──────────────┬──────────────┘
                                    │
                     ┌──────────────▼──────────────┐
                     │      Cloud Load Balancer    │
                     │      SSL Termination        │
                     └──────────────┬──────────────┘
                                    │
         ┌──────────────────────────┼──────────────────────────┐
         │                          │                          │
   ┌─────▼─────┐             ┌──────▼──────┐            ┌──────▼──────┐
   │ Cloud Run │             │  Cloud Run  │            │  Cloud Run  │
   │ (API)     │             │  (Workers)  │            │  (AI)       │
   └─────┬─────┘             └──────┬──────┘            └──────┬──────┘
         │                          │                          │
         └──────────────────────────┼──────────────────────────┘
                                    │
                     ┌──────────────▼──────────────┐
                     │     VPC Private Network     │
                     └──────────────┬──────────────┘
                                    │
              ┌─────────────────────┼─────────────────────┐
              │                     │                     │
        ┌─────▼─────┐         ┌─────▼─────┐         ┌─────▼─────┐
        │ Cloud SQL │         │Memorystore│         │  Cloud    │
        │(PostgreSQL)│        │  (Redis)  │         │  Storage  │
        │ (Private) │         │ (Private) │         │ (Private) │
        └───────────┘         └───────────┘         └───────────┘

COMPUTE SECURITY
────────────────
• Cloud Run (serverless, no SSH access)
• Container images scanned for vulnerabilities
• Minimal base images (distroless)
• No persistent state on compute

DATABASE SECURITY
─────────────────
• Cloud SQL with private IP only
• Automated backups (point-in-time recovery)
• Encryption at rest (Google-managed keys)
• Customer-managed keys available (Enterprise)

═══════════════════════════════════════════════════════════════════
```

### Security Monitoring

```
MONITORING & DETECTION
═══════════════════════════════════════════════════════════════════

LOGGING
───────
• All API requests logged
• Authentication events
• Authorization decisions
• Data access patterns
• Retention: 90 days online, 7 years archived

ALERTING
────────
• Failed authentication attempts
• Privilege escalation attempts
• Unusual data access patterns
• API rate limit breaches
• System availability issues

INCIDENT RESPONSE
─────────────────
• 24/7 on-call rotation
• Defined escalation procedures
• Customer notification SLAs
• Post-incident reviews
• Root cause analysis published

PENETRATION TESTING
───────────────────
• Annual third-party testing
• Continuous automated scanning
• Bug bounty program (planned)
• Results remediated promptly

═══════════════════════════════════════════════════════════════════
```

---

## Privacy Framework

### Australian Privacy Principles (APPs)

**Compliance Summary:**

| APP | Requirement | SiteSync Compliance |
|-----|-------------|---------------------|
| APP 1 | Open and transparent management | Privacy Policy published, regularly updated |
| APP 2 | Anonymity and pseudonymity | Anonymous knowledge contributions supported |
| APP 3 | Collection of solicited information | Only collect what's necessary for service |
| APP 4 | Unsolicited information | Destroyed if not needed |
| APP 5 | Notification of collection | Clear notices at collection points |
| APP 6 | Use or disclosure | Only for stated purposes, no selling |
| APP 7 | Direct marketing | Opt-in only, easy unsubscribe |
| APP 8 | Cross-border disclosure | Disclosed in privacy policy, adequate protections |
| APP 9 | Government identifiers | Not used as primary identifiers |
| APP 10 | Quality of personal information | Accuracy maintained, correction supported |
| APP 11 | Security of personal information | Technical and organizational measures |
| APP 12 | Access to personal information | Self-service and request options |
| APP 13 | Correction of personal information | Edit and request correction |

### GDPR Alignment

**For EU Users/Data:**

```
GDPR COMPLIANCE
═══════════════════════════════════════════════════════════════════

LAWFUL BASIS FOR PROCESSING
───────────────────────────
• Contract: Service provision
• Legitimate Interest: Platform improvement
• Consent: Marketing, optional features

DATA SUBJECT RIGHTS
───────────────────
Right of Access          ✓ Self-service export
Right to Rectification   ✓ Edit profile/data
Right to Erasure         ✓ Delete account request
Right to Restriction     ✓ Pause processing
Right to Portability     ✓ Export in standard formats
Right to Object          ✓ Marketing opt-out, AI opt-out
Automated Decisions      ✓ Human review available

DATA PROCESSING AGREEMENT
─────────────────────────
• Standard Contractual Clauses available
• Sub-processor list maintained
• Notification of changes

EU DATA STORAGE
───────────────
• EU region available on request
• Data residency guarantee
• No transfer outside EU (if selected)

═══════════════════════════════════════════════════════════════════
```

### Privacy by Design

**Implementation:**

1. **Data Minimization**
   - Collect only what's needed
   - Clear purpose for each field
   - Regular review of data collected

2. **Purpose Limitation**
   - Data used only for stated purposes
   - New uses require consent
   - No selling of personal data

3. **Storage Limitation**
   - Defined retention periods
   - Automated deletion schedules
   - Export before deletion available

4. **Transparency**
   - Clear privacy policy
   - In-app privacy notices
   - Easy access to personal data

5. **User Control**
   - Privacy settings dashboard
   - Export functionality
   - Deletion requests honored

---

## Building Industry Compliance

### Elevator Regulations

```
AUSTRALIAN ELEVATOR REGULATIONS
═══════════════════════════════════════════════════════════════════

WORK HEALTH AND SAFETY
──────────────────────
• AS 1735 Lifts, Escalators and Moving Walks
• State/Territory WHS Acts
• Registration requirements vary by state

INSPECTION REQUIREMENTS
───────────────────────
• Annual safety inspection (most states)
• Major inspection every 5 years
• Records must be maintained
• SiteSync tracks and alerts

STATE-SPECIFIC
──────────────
Victoria: WorkSafe Victoria registration
NSW: SafeWork NSW registration
Queensland: Workplace Health and Safety Queensland
WA: WorkSafe WA
SA: SafeWork SA

HOW SITESYNC HELPS
───────────────────
✓ Track inspection due dates
✓ Store certificates digitally
✓ Alert before expiry
✓ Generate compliance reports
✓ Maintain audit trail for regulators

═══════════════════════════════════════════════════════════════════
```

### Building Compliance

```
BUILDING MANAGEMENT COMPLIANCE
═══════════════════════════════════════════════════════════════════

STRATA/BODY CORPORATE
─────────────────────
• Strata Schemes Management Act (NSW)
• Owners Corporation Act (VIC)
• Body Corporate and Community Management Act (QLD)
• Record-keeping requirements
• Meeting/communication requirements

COMMERCIAL BUILDINGS
────────────────────
• Building Code of Australia (BCA)
• Essential Services requirements
• Fire safety compliance
• Accessibility standards

ENVIRONMENTAL
─────────────
• NABERS ratings (voluntary/mandatory)
• Energy efficiency reporting
• Sustainability certifications

SITESYNC SUPPORT
─────────────────
✓ Centralized record keeping
✓ Compliance calendar
✓ Document management
✓ Audit-ready reports
✓ Export for regulators

═══════════════════════════════════════════════════════════════════
```

---

## Audit Trail

### Immutable Event Log

**Architecture:**

```
AUDIT ARCHITECTURE
═══════════════════════════════════════════════════════════════════

WHAT'S LOGGED
─────────────
• Every data modification
• Every access to sensitive data
• Authentication events
• Authorization decisions
• System configuration changes

LOG STRUCTURE
─────────────
{
  "event_id": "uuid",
  "timestamp": "ISO8601",
  "event_type": "work_order_created",
  "actor_id": "user_uuid",
  "actor_type": "user|system|api",
  "organization_id": "org_uuid",
  "resource_type": "work_order",
  "resource_id": "wo_uuid",
  "changes": {
    "before": {...},
    "after": {...}
  },
  "ip_address": "masked",
  "user_agent": "browser info",
  "hash": "sha256 of previous + this event"
}

INTEGRITY
─────────
• Hash chain (each event references previous)
• Append-only storage
• No modification possible
• Regular integrity verification
• Third-party attestation available

RETENTION
─────────
• Online: 90 days (searchable)
• Archive: 7 years (retrievable)
• Compliance exports: On request

═══════════════════════════════════════════════════════════════════
```

### Event Types

| Category | Event Types |
|----------|-------------|
| **Authentication** | login, logout, mfa_challenge, password_reset |
| **Authorization** | permission_granted, permission_denied, role_changed |
| **Data** | created, updated, deleted, exported, accessed |
| **Work Orders** | created, assigned, started, completed, cancelled |
| **Equipment** | created, updated, status_changed |
| **Compliance** | certificate_uploaded, expiry_alert, inspection_scheduled |
| **System** | config_changed, integration_connected, api_key_created |

---

## Incident Response

### Response Procedures

```
INCIDENT RESPONSE FRAMEWORK
═══════════════════════════════════════════════════════════════════

SEVERITY LEVELS
───────────────
P1 - Critical
• Data breach confirmed
• Service completely unavailable
• Response: Immediate, all hands

P2 - High
• Potential data exposure
• Significant service degradation
• Response: Within 1 hour

P3 - Medium
• Security vulnerability found
• Minor service impact
• Response: Within 4 hours

P4 - Low
• Suspicious activity
• No immediate impact
• Response: Within 24 hours

RESPONSE PHASES
───────────────
1. Detection
   └── Automated alerts, user reports, monitoring

2. Containment
   └── Isolate affected systems, preserve evidence

3. Eradication
   └── Remove threat, patch vulnerabilities

4. Recovery
   └── Restore services, verify integrity

5. Lessons Learned
   └── Post-incident review, process improvement

═══════════════════════════════════════════════════════════════════
```

### Data Breach Protocol

**Notification Requirements:**

| Jurisdiction | Requirement | Timeline |
|--------------|-------------|----------|
| Australia (NDB) | Notify OAIC and affected individuals | As soon as practicable |
| GDPR | Notify supervisory authority | Within 72 hours |
| US (varies by state) | Notify affected individuals | Varies (30-90 days) |

**SiteSync Commitment:**
- Notify affected customers within 24 hours
- Provide details of what was affected
- Explain remediation steps taken
- Offer support and next steps

---

## Vendor Security

### Sub-Processors

**Primary Service Providers:**

| Provider | Service | Data Processed | Compliance |
|----------|---------|----------------|------------|
| Google Cloud | Infrastructure | All data | SOC 2, ISO 27001 |
| OpenAI/Anthropic/Google AI | AI Processing | Anonymized queries | SOC 2, GDPR |
| Stripe | Payments | Payment info | PCI-DSS Level 1 |
| SendGrid | Email | Email addresses | SOC 2 |
| Sentry | Error tracking | Error logs (no PII) | SOC 2 |

**Vendor Assessment:**
- Security questionnaire for all vendors
- Annual review of vendor security posture
- Data Processing Agreements in place
- Right to audit provisions

### Third-Party Integrations

**Integration Security:**

```
INTEGRATION SECURITY
═══════════════════════════════════════════════════════════════════

OAUTH 2.0
─────────
• All integrations use OAuth 2.0
• Scoped permissions (minimum required)
• Token refresh, no long-lived credentials
• User can revoke at any time

WEBHOOK SECURITY
────────────────
• HTTPS only
• Signature verification
• Payload encryption (optional)
• Retry with backoff

API SECURITY
────────────
• API keys scoped to organization
• Rate limiting enforced
• IP allowlisting available (Enterprise)
• Request logging

═══════════════════════════════════════════════════════════════════
```

---

## Security for Users

### Building Manager Security Checklist

```
SECURITY CHECKLIST FOR BUILDING MANAGERS
═══════════════════════════════════════════════════════════════════

ACCOUNT SECURITY
☐ Enable MFA on your account
☐ Use a unique, strong password
☐ Keep recovery codes in secure location
☐ Review active sessions regularly

USER MANAGEMENT
☐ Only grant necessary permissions
☐ Remove access when roles change
☐ Audit user list quarterly
☐ Use SSO if available (Enterprise)

CONTRACTOR ACCESS
☐ Review contractor permissions annually
☐ Revoke access when contracts end
☐ Monitor contractor activity
☐ Use approval workflow for sensitive actions

DATA PROTECTION
☐ Limit who can export data
☐ Review audit logs monthly
☐ Report suspicious activity
☐ Keep compliance documents current

═══════════════════════════════════════════════════════════════════
```

### Technician Security Checklist

```
SECURITY CHECKLIST FOR TECHNICIANS
═══════════════════════════════════════════════════════════════════

PERSONAL SECURITY
☐ Enable MFA on your account
☐ Don't share your credentials
☐ Log out on shared devices
☐ Keep app updated

DATA HANDLING
☐ Only access data you need
☐ Don't screenshot sensitive info
☐ Report lost/stolen devices immediately
☐ Use secure networks when possible

KNOWLEDGE CONTRIBUTIONS
☐ Don't share proprietary information
☐ Use anonymous option if needed
☐ Review before submitting
☐ Report concerning content

═══════════════════════════════════════════════════════════════════
```

---

## Security FAQs

**Q: Who can see my building's data?**
A: Only users you've authorized—your staff and contractors you've invited. SiteSync staff can only access your data with your explicit consent for support purposes, and all access is logged.

**Q: Is my data shared with other buildings?**
A: Never. Your building data is isolated. The only "shared" data is anonymized, aggregated insights for AI training and industry benchmarking—never identifiable information.

**Q: What happens to my data if I cancel?**
A: You can export all your data before cancellation. After cancellation, data is retained for 90 days (in case you return), then permanently deleted. Audit logs are retained for compliance.

**Q: Can technicians see data from other buildings?**
A: No. Technicians only see data for buildings/work orders they're assigned to. Row-Level Security ensures this at the database level.

**Q: How is AI trained on my data?**
A: AI models are trained on anonymized, aggregated patterns. Your specific building's data is never used in a way that could identify you. You can opt out of AI training entirely.

**Q: What certifications does SiteSync have?**
A: We maintain SOC 2 Type II certification and are GDPR compliant. ISO 27001 certification is in progress. See Compliance Certifications section for details.

**Q: Can I get a copy of your security audit?**
A: Yes. SOC 2 Type II reports are available under NDA for enterprise customers. Contact security@sitesync.com.

**Q: What happens in a data breach?**
A: We follow defined incident response procedures and notify affected customers within 24 hours. See Incident Response section for details.

---

## Contact & Resources

### Security Team

```
SECURITY CONTACTS
═══════════════════════════════════════════════════════════════════

General Security Inquiries
security@sitesync.com

Report a Vulnerability
security@sitesync.com (PGP key available)

Privacy Inquiries
privacy@sitesync.com

Compliance Documentation Requests
compliance@sitesync.com

Data Protection Officer (GDPR)
dpo@sitesync.com

═══════════════════════════════════════════════════════════════════
```

### Documentation

- [Privacy Policy](https://sitesync.com/privacy)
- [Terms of Service](https://sitesync.com/terms)
- [Data Processing Agreement](https://sitesync.com/dpa)
- [Sub-Processor List](https://sitesync.com/subprocessors)
- [Security Whitepaper](https://sitesync.com/security)

---

**[← Back to Data Migration](../how-to/data-migration.md)** | **[Next: FAQ →](../faq.md)**


<!-- FILE: docs/explanation/why-sitesync.md -->

# Why SiteSync?

> The philosophy behind building-centric service management

## The Problem

### Buildings Lose Their Memory

When a building changes service contractors, history disappears:

- **10 years of service records** → Gone
- **Equipment quirks learned** → Forgotten
- **Patterns identified** → Lost
- **New contractor starts** → From zero

This happens every contract change. Knowledge evaporates.

### Contractors Own Your Data

Traditional model:

```
Building → hires → Contractor → uses → Their Software → stores → Your Data
```

When the relationship ends, so does your access.

### Information Silos

Different trades, different systems:

| Trade | Typical System |
|-------|----------------|
| Lifts | Spreadsheet or paper |
| HVAC | Different spreadsheet |
| Fire | Compliance folder |
| Electrical | Contractor's system |

No unified view. No cross-trade insights.

---

## The Solution

### Building-Centric Model

Flip the ownership:

```
Building → owns → SiteSync → manages → All Service Data
                      ↑
               Contractors access (temporarily)
```

**The building is permanent. Contractors are temporary workers.**

### One Platform, All Trades

Instead of six systems for six trades:

| Before | After |
|--------|-------|
| Lift spreadsheet | SiteSync |
| HVAC spreadsheet | SiteSync |
| Fire compliance folder | SiteSync |
| Electrical contractor system | SiteSync |
| Plumbing emails | SiteSync |
| Security vendor portal | SiteSync |

One dashboard. One history. One source of truth.

### AI That Learns Forever

Every service visit teaches the system:

- "This KONE throws false F505 errors on humid days"
- "Door operator adjusted 12 times → needs replacement"
- "Similar issue last year → check relay first"

Knowledge accumulates. AI gets smarter. Building gets better.

---

## Core Principles

### 1. Invisible AI

**Wrong:**
- "Our AI chatbot will help you!"
- "Powered by GPT-4" badge
- "AI is thinking..." spinner

**Right:**
- Form auto-fills before you type
- Diagnosis appears instantly
- Report writes itself

The best AI is the AI you don't notice.

### 2. Confirm, Don't Create

AI never takes action automatically. But confirmation is frictionless:

| AI Confidence | User Experience |
|---------------|-----------------|
| High (95%+) | "Likely sensor. Order it?" → One tap |
| Medium (70-95%) | "Could be A, B, or C" → Tap to choose |
| Low (<70%) | "What do you see?" → Photo/voice input |

Human always in control. AI removes friction.

### 3. Building Health Score

One number (0-100) that answers: "How's my building?"

**Calculated from:**
- Equipment age and condition
- Maintenance compliance
- Incident frequency
- First-time fix rate
- Predictive risk

**Comparable:**
- Your building vs. last year
- Your building vs. similar buildings
- Your building vs. portfolio average

### 4. Contractor Freedom

Because you own your data, you can:
- Switch contractors with zero data loss
- Get competitive bids with full history shared
- Compare contractor performance objectively
- Never be locked in

---

## Who Benefits

### Building Managers

| Pain Point | Solution |
|------------|----------|
| "What's the history on Lift 2?" | Complete timeline, all contractors |
| "When's the fire inspection due?" | Compliance dashboard |
| "How do we compare?" | Benchmark against similar buildings |
| "Prove we maintain properly" | Immutable audit trail |

### Technicians

| Pain Point | Solution |
|------------|----------|
| "What's wrong with this unit?" | AI diagnosis + equipment history |
| "Do I have that part?" | Van stock lookup |
| "Who's nearby with expertise?" | Find colleague |
| "Paperwork takes forever" | Auto-generated reports |

### Service Companies

| Pain Point | Solution |
|------------|----------|
| "Training new techs is slow" | AI guidance + knowledge base |
| "First-time fix rate is low" | Better diagnosis, right parts |
| "Scheduling is manual" | AI-optimized routing |
| "Invoicing is delayed" | Instant job completion → invoice |

---

## The Market Opportunity

### Why Now?

1. **AI is ready** — LLMs can now understand technical documents and diagnose faults
2. **Incumbents are stuck** — Legacy business models prevent innovation
3. **Mobile is everywhere** — Technicians have smartphones in their pockets
4. **Data is valuable** — Buildings realize their history has worth

### Counter-Positioning

| Incumbent (ServiceTitan) | SiteSync |
|--------------------------|----------|
| $299-899/month | $29/month |
| Weeks to set up | 5 minutes |
| Dedicated hardware | Any device |
| Per-seat pricing | Per-building pricing |
| 21 trades (shallow) | All trades (deep) |

We're not competing on features. We're competing on model.

---

## Development Roadmap

### Months 1-6 — Foundation
**Goal:** Core platform you can actually use

| Module | What it does |
|--------|--------------|
| Database | PostgreSQL + pgvector + Row-Level Security |
| Auth | JWT tokens, sessions, password reset |
| Organizations | Multi-tenant root, settings, billing |
| Users | Roles, permissions, invitations |
| Sites | Buildings/locations, addresses, contacts |
| Assets | Equipment registry, multi-trade, specs |

**Delivers:** Create org → add building → register equipment

---

### Months 7-12 — Work Management
**Goal:** Track jobs from report to resolution

| Module | What it does |
|--------|--------------|
| Work Orders | Full lifecycle, status workflow, priorities |
| Contractors | Workforce registry, skills, rates |
| Scheduling | Assignment, calendar, availability |
| Labor | Time tracking, costs |
| Web Dashboard | Manager view — sites, assets, jobs |
| Mobile App v1 | Technician view — my jobs, basic updates |

**Delivers:** Report problem → assign tech → complete job → record history

---

### Months 13-18 — Intelligence
**Goal:** AI that helps without getting in the way

| Module | What it does |
|--------|--------------|
| AI Diagnosis | Single-model analysis of faults |
| Fault Codes | Database of codes by manufacturer |
| Knowledge Base | Manuals, procedures, tribal knowledge |
| Suggested Parts | AI recommends what you'll need |
| Equipment Insights | "This unit has a humidity issue" |

**Delivers:** Create work order → AI suggests cause + parts + history

---

### Months 19-24 — Inventory & Compliance
**Goal:** Track parts, stay compliant

| Module | What it does |
|--------|--------------|
| Inventory | Parts catalog, costs, compatibility |
| Stock Locations | Warehouse, van stock, site stock |
| Parts Used | Link parts to jobs, auto-deduct |
| Compliance Schedules | Inspections, certifications, deadlines |
| Audit Trail | Immutable log, hash chain, tamper-proof |

**Delivers:** Know what parts you have → use on job → auto-reorder → never miss inspection

---

### Months 25-30 — Marketplace & API
**Goal:** Connect to the world

| Module | What it does |
|--------|--------------|
| Marketplace | List parts for sale, search, buy |
| Transactions | Payments, escrow, reviews |
| Public API | REST endpoints for everything |
| Webhooks | Push events to external systems |
| Integrations | Xero, MYOB, common BMS systems |

**Delivers:** Sell excess parts → buy what you need → sync with accounting

---

### Months 31-36 — Advanced AI
**Goal:** Predict, don't just diagnose

| Module | What it does |
|--------|--------------|
| Triforce | Multi-model consensus (Gemini + Claude + GPT) |
| Predictive Maintenance | "This will fail in 3 weeks" |
| Failure Probability | Risk scores per asset |
| Smart Scheduling | AI-optimized routes and timing |
| Cross-Trade Insights | "HVAC failure causing lift overheating" |

**Delivers:** Fix things before they break

---

### Months 37-42 — Mobile & Offline
**Goal:** Works everywhere, even underground

| Module | What it does |
|--------|--------------|
| Offline-First | Full functionality without signal |
| Background Sync | Queue changes, sync when online |
| Push Notifications | Real-time alerts |
| Voice Input | Speak notes, hands-free |
| Smart Caching | Pre-load today's jobs + assets |

**Delivers:** Walk into basement → keep working → sync when you surface

---

### Months 43-48 — Automation
**Goal:** System runs itself, humans confirm

| Module | What it does |
|--------|--------------|
| Auto Work Orders | Sensor triggers create jobs automatically |
| Compliance Auto-Schedule | Never miss a deadline |
| Smart Notifications | Right person, right time, right channel |
| Workflow Rules | "If X then Y" without code |
| Enterprise | SSO, advanced permissions, white-label |

**Delivers:** Problem detected → job created → tech dispatched → you just approve

---

### Months 49-54 — Network Intelligence
**Goal:** Every building makes every building smarter

| Module | What it does |
|--------|--------------|
| Anonymous Aggregation | Learn from all buildings (privacy-safe) |
| Benchmarking | "Your HVAC costs 20% more than similar buildings" |
| Pattern Detection | Industry-wide failure patterns |
| Shared Knowledge | Opt-in solutions database |

**Delivers:** Diagnose rare fault using data from 10,000 other buildings

---

### Months 55-60 — Platform
**Goal:** We give buildings a memory

| Module | What it does |
|--------|--------------|
| App Ecosystem | Third-party apps on SiteSync |
| Partner API | Deep integrations for vendors |
| Advanced Analytics | Custom reports, BI export |
| Building Memory | Complete, searchable, permanent history |

**Delivers:** Every building remembers everything. Forever.

---

## Further Reading

- [Multi-Trade Architecture](../reference/data-model.md) — How we handle all trades
- [Triforce AI](triforce-ai.md) — How the AI system works
- [Quick Start](../tutorials/quick-start.md) — Try it yourself

---

**[← Back to Docs](../README.md)**


<!-- FILE: docs/tutorials/quick-start.md -->

# SiteSync V3 - Getting Started

## Onboarding Guide

> This document provides step-by-step onboarding flows for all user types: Buildings, Technicians, and Service Companies.

---

```
╔══════════════════════════════════════════════════════════════════╗
║                                                                  ║
║         YOUR BUILDING. YOUR DATA. YOUR INTELLIGENCE.             ║
║                                                                  ║
║                  Contractors come and go.                        ║
║                  Your building remembers forever.                ║
║                                                                  ║
╚══════════════════════════════════════════════════════════════════╝
```

---

## Philosophy: Five Minutes to Value

```
╔══════════════════════════════════════════════════════════════════╗
║                                                                  ║
║   Traditional enterprise software: Weeks of setup, training,    ║
║   configuration before you see any value.                       ║
║                                                                  ║
║   SiteSync: 5 minutes to your first insight.                   ║
║                                                                  ║
║   We believe onboarding should feel like unlocking potential,   ║
║   not climbing a mountain.                                      ║
║                                                                  ║
╚══════════════════════════════════════════════════════════════════╝
```

### Onboarding Principles

| Principle | Implementation |
|-----------|----------------|
| **Immediate Value** | Show insights within first session |
| **Progressive Disclosure** | Reveal features as needed, not all at once |
| **Role-Based Paths** | Different journeys for different users |
| **Self-Service First** | Help available, but never required |
| **Milestone Celebration** | Acknowledge progress at key moments |

---

## Building Manager Onboarding

### Overview

```
BUILDING MANAGER JOURNEY
═══════════════════════════════════════════════════════════════════

Time to First Value: ~5 minutes
Time to Full Setup: ~30 minutes (optional)
Training Required: None

Step 1 ──► Step 2 ──► Step 3 ──► Step 4 ──► Step 5
Signup     Add Site   Add First  Invite     Explore
           Details    Equipment  Contractor Dashboard

           [2 min]    [2 min]    [1 min]    [Optional]

═══════════════════════════════════════════════════════════════════
```

### Step 1: Account Creation

**What You'll Need:**
- Email address
- Building name
- Your role (owner, manager, facilities coordinator)

**The Flow:**

```
┌─────────────────────────────────────────────────────────┐
│                                                         │
│   Welcome to SiteSync                                  │
│                                                         │
│   Your building is about to get smarter.                │
│                                                         │
│   ┌─────────────────────────────────────────────────┐   │
│   │  Email: [_______________________________]       │   │
│   └─────────────────────────────────────────────────┘   │
│                                                         │
│   ┌─────────────────────────────────────────────────┐   │
│   │  Password: [_____________________________]      │   │
│   └─────────────────────────────────────────────────┘   │
│                                                         │
│   ┌─────────────────────────────────────────────────┐   │
│   │  Building Name: [________________________]      │   │
│   └─────────────────────────────────────────────────┘   │
│                                                         │
│   [ Continue → ]                                        │
│                                                         │
└─────────────────────────────────────────────────────────┘
```

**Design Notes:**
- Single page, minimal fields
- No credit card required for free tier
- Magic link option for passwordless signup
- SSO available for enterprise

---

### Step 2: Site Setup

**Personalization Questions:**

```
┌─────────────────────────────────────────────────────────┐
│                                                         │
│   Tell us about your building                           │
│                                                         │
│   Building Type:                                        │
│   ○ Commercial Office                                   │
│   ○ Residential (Strata/HOA)                           │
│   ○ Mixed Use                                           │
│   ○ Industrial/Warehouse                                │
│   ○ Retail                                              │
│   ○ Other                                               │
│                                                         │
│   Address: [________________________________]           │
│                                                         │
│   Number of Floors: [___]                               │
│                                                         │
│   [ Continue → ]                                        │
│                                                         │
│   ┌───────────────────────────────────────────────┐     │
│   │ 💡 This helps us customize your experience    │     │
│   │    and connect you with relevant insights.    │     │
│   └───────────────────────────────────────────────┘     │
│                                                         │
└─────────────────────────────────────────────────────────┘
```

**Auto-Detection Features:**
- Address autocomplete with Google Places
- Building details from public records (where available)
- Suggested equipment based on building type

---

### Step 3: Add Your First Equipment

**Smart Equipment Entry:**

```
┌─────────────────────────────────────────────────────────┐
│                                                         │
│   Add Your First Elevator                               │
│                                                         │
│   ┌─────────────────────────────────────────────────┐   │
│   │  📷  Scan Nameplate                             │   │
│   │      Point camera at elevator nameplate         │   │
│   │      We'll extract the details automatically    │   │
│   └─────────────────────────────────────────────────┘   │
│                                                         │
│   ─── OR enter manually ───                             │
│                                                         │
│   Manufacturer: [KONE          ▼]                       │
│   Model: [_______________________]                      │
│   Installation Year: [____]                             │
│   Location/Name: [Lobby Elevator 1_____]                │
│                                                         │
│   [ Add Equipment → ]                                   │
│                                                         │
│   [ Skip for now, I'll add later ]                      │
│                                                         │
└─────────────────────────────────────────────────────────┘
```

**AI Vision Feature:**
- Mobile: Camera scan extracts nameplate data
- Desktop: Upload photo of nameplate
- OCR identifies manufacturer, model, serial number
- Auto-suggests equipment profile from database

**Skip Option:**
- Users can explore platform without equipment
- Gentle reminders to complete setup
- Demo data available for exploration

---

### Step 4: Connect Your Service Provider

**Contractor Invitation:**

```
┌─────────────────────────────────────────────────────────┐
│                                                         │
│   Invite Your Service Provider                          │
│                                                         │
│   When you add a contractor, they can:                  │
│   ✓ Log work on your equipment                          │
│   ✓ Access equipment history (with your permission)     │
│   ✓ Use AI diagnosis tools                              │
│                                                         │
│   Your building always owns the data.                   │
│                                                         │
│   ┌─────────────────────────────────────────────────┐   │
│   │  Contractor Email: [_______________________]    │   │
│   └─────────────────────────────────────────────────┘   │
│                                                         │
│   [ Send Invitation → ]                                 │
│                                                         │
│   [ Skip - I'll manage records myself ]                 │
│                                                         │
└─────────────────────────────────────────────────────────┘
```

**Invitation Flow:**
- Contractor receives branded email
- One-click acceptance
- Automatic site association
- Both parties notified

**Self-Management Option:**
- Buildings can log their own service records
- Upload existing documentation
- Import historical data (see Data Migration guide)

---

### Step 5: Welcome Dashboard

**First-Time Experience:**

```
┌─────────────────────────────────────────────────────────────────┐
│                                                                 │
│  🏢 Welcome to 123 Collins Street                               │
│                                                                 │
│  ┌─────────────────────────────────────────────────────────┐    │
│  │                                                         │    │
│  │   Your Building Health Score                            │    │
│  │                                                         │    │
│  │   [=============================] 78                    │    │
│  │                                                         │    │
│  │   Good! Your building is well-maintained.               │    │
│  │   Add more history to improve accuracy.                 │    │
│  │                                                         │    │
│  └─────────────────────────────────────────────────────────┘    │
│                                                                 │
│  ┌───────────────────────┐  ┌───────────────────────┐          │
│  │ Equipment             │  │ Quick Actions         │          │
│  │ ─────────────         │  │ ─────────────         │          │
│  │ ⬆️ Lobby Elevator 1   │  │ + Log Service Visit   │          │
│  │   KONE MonoSpace      │  │ + Report Issue        │          │
│  │   Status: Operational │  │ + Upload Document     │          │
│  │                       │  │ + Request Diagnosis   │          │
│  │ [ + Add Equipment ]   │  │                       │          │
│  └───────────────────────┘  └───────────────────────┘          │
│                                                                 │
│  ┌─────────────────────────────────────────────────────────┐    │
│  │ Getting Started Checklist                    2/5 Done   │    │
│  │ ─────────────────────────────────────────────────────   │    │
│  │ ✓ Create account                                        │    │
│  │ ✓ Add your building                                     │    │
│  │ ○ Add all equipment                                     │    │
│  │ ○ Invite your service provider                          │    │
│  │ ○ Import historical records                             │    │
│  └─────────────────────────────────────────────────────────┘    │
│                                                                 │
└─────────────────────────────────────────────────────────────────┘
```

**Progressive Checklist:**
- Visible but not blocking
- Rewards for completion (extended free tier, badges)
- Can be dismissed after 30 days

---

### Building Manager: Key First Actions

**Day 1: Essential Setup**

| Action | Time | Impact |
|--------|------|--------|
| Add all elevators | 10 min | Complete equipment profile |
| Upload last service report | 2 min | Initialize history |
| Invite contractor | 1 min | Enable collaboration |

**Week 1: Build Foundation**

| Action | Time | Impact |
|--------|------|--------|
| Import historical records | 15 min | Full history visibility |
| Add compliance certificates | 5 min | Compliance tracking |
| Set notification preferences | 2 min | Stay informed |

**Month 1: Full Value**

| Action | Impact |
|--------|--------|
| First AI diagnosis used | See intelligence in action |
| First contractor work logged | Building remembers |
| First report generated | Professional documentation |

---

## Technician Onboarding

### Overview

```
TECHNICIAN JOURNEY
═══════════════════════════════════════════════════════════════════

Time to First Value: ~3 minutes
Time to Full Profile: ~15 minutes (builds over time)
Training Required: None

Step 1 ──► Step 2 ──► Step 3 ──► Step 4
Signup     Profile    Link       Start
           Basics     Employer   Working

           [2 min]    [1 min]    [Immediate]

═══════════════════════════════════════════════════════════════════
```

### Step 1: Technician Signup

**Simple Entry Point:**

```
┌─────────────────────────────────────────────────────────┐
│                                                         │
│   Join the SiteSync Community                          │
│                                                         │
│   Build your professional profile.                      │
│   Access collective knowledge.                          │
│   Get recognized for your expertise.                    │
│                                                         │
│   Free forever for technicians.                         │
│                                                         │
│   ┌─────────────────────────────────────────────────┐   │
│   │  Email: [_______________________________]       │   │
│   └─────────────────────────────────────────────────┘   │
│                                                         │
│   ┌─────────────────────────────────────────────────┐   │
│   │  Full Name: [___________________________]       │   │
│   └─────────────────────────────────────────────────┘   │
│                                                         │
│   Primary Trade:                                        │
│   ○ Elevator & Escalator                                │
│   ○ HVAC                                                │
│   ○ Electrical                                          │
│   ○ Fire Systems                                        │
│   ○ Other                                               │
│                                                         │
│   [ Create My Profile → ]                               │
│                                                         │
└─────────────────────────────────────────────────────────┘
```

**Key Message:**
- Free forever (not a trial)
- Technician owns their profile
- Profile travels with them, not employer

---

### Step 2: Profile Foundation

**Expertise Setup:**

```
┌─────────────────────────────────────────────────────────┐
│                                                         │
│   What's Your Expertise?                                │
│                                                         │
│   Years of Experience: [____]                           │
│                                                         │
│   Equipment Brands (select all you work on):            │
│   ☑ KONE                    ☑ Otis                      │
│   ☐ Schindler               ☐ ThyssenKrupp              │
│   ☐ Mitsubishi              ☐ Fujitec                   │
│   ☐ Hitachi                 ☐ Other                     │
│                                                         │
│   Specializations:                                      │
│   ☑ Traction elevators      ☐ Hydraulic elevators       │
│   ☐ Escalators              ☐ Moving walkways           │
│   ☐ Modernization           ☐ New installations         │
│                                                         │
│   [ Continue → ]                                        │
│                                                         │
│   ┌───────────────────────────────────────────────┐     │
│   │ 💡 Your expertise grows automatically as you  │     │
│   │    complete jobs and share knowledge.         │     │
│   └───────────────────────────────────────────────┘     │
│                                                         │
└─────────────────────────────────────────────────────────┘
```

**Profile Evolution:**
- Initial setup creates foundation
- Profile enriches automatically:
  - Jobs completed → Verified experience
  - Knowledge shared → Expertise score
  - Peer endorsements → Credibility
  - Certifications → Verified credentials

---

### Step 3: Employer Connection

**Link to Company (Optional):**

```
┌─────────────────────────────────────────────────────────┐
│                                                         │
│   Connect to Your Employer                              │
│                                                         │
│   Linking lets you:                                     │
│   ✓ See assigned jobs                                   │
│   ✓ Access company resources                            │
│   ✓ Log work automatically                              │
│                                                         │
│   Your profile remains yours. Forever.                  │
│                                                         │
│   Company Name or Code: [_____________________]         │
│                                                         │
│   [ Search & Connect → ]                                │
│                                                         │
│   ─── OR ───                                            │
│                                                         │
│   [ I'm Independent ] [ Skip for Now ]                  │
│                                                         │
└─────────────────────────────────────────────────────────┘
```

**Independence Option:**
- Independent technicians use platform directly
- Can connect to multiple service companies
- Profile always belongs to technician

---

### Step 4: First Use Experience

**Welcome to the Field:**

```
┌─────────────────────────────────────────────────────────────────┐
│                                                                 │
│  👋 Welcome, Sarah Chen                                         │
│     Elevator Technician • KONE Specialist                       │
│                                                                 │
│  ┌─────────────────────────────────────────────────────────┐    │
│  │ Your Expertise Score                                    │    │
│  │                                                         │    │
│  │ [======                               ] 15              │    │
│  │                                                         │    │
│  │ Starting score based on 8 years experience.             │    │
│  │ Complete jobs and share knowledge to grow.              │    │
│  └─────────────────────────────────────────────────────────┘    │
│                                                                 │
│  ┌─────────────────────────┐  ┌─────────────────────────┐      │
│  │ Quick Actions           │  │ Knowledge Base          │      │
│  │ ─────────────           │  │ ─────────────           │      │
│  │ 🔍 Search Knowledge     │  │ Latest Solutions:       │      │
│  │ 🤖 AI Diagnosis         │  │ • F505 door zone fix    │      │
│  │ 📝 Log Work             │  │ • KONE encoder tips     │      │
│  │ 📤 Share a Tip          │  │ • Hydraulic bleed proc  │      │
│  └─────────────────────────┘  └─────────────────────────┘      │
│                                                                 │
│  ┌─────────────────────────────────────────────────────────┐    │
│  │ First Steps                                             │    │
│  │ ─────────────────────────────────────────────────────   │    │
│  │ ○ Try an AI diagnosis on your next fault code           │    │
│  │ ○ Share one tip from your experience                    │    │
│  │ ○ Add a certification to your profile                   │    │
│  └─────────────────────────────────────────────────────────┘    │
│                                                                 │
└─────────────────────────────────────────────────────────────────┘
```

---

### Technician: Value Demonstration

**First AI Diagnosis (Critical Moment):**

```
┌─────────────────────────────────────────────────────────────────┐
│                                                                 │
│  AI Diagnosis                                                   │
│                                                                 │
│  ┌─────────────────────────────────────────────────────────┐    │
│  │  Fault Code: [F505______]                               │    │
│  │  Equipment:  [KONE MonoSpace ▼]                         │    │
│  │  Symptoms:   [Door hesitating, slow close____________]  │    │
│  │                                                         │    │
│  │  [ Diagnose → ]                                         │    │
│  └─────────────────────────────────────────────────────────┘    │
│                                                                 │
│  ───────────────────────────────────────────────────────────    │
│                                                                 │
│  DIAGNOSIS RESULT                            Confidence: 87%    │
│  ───────────────────────────────────────────────────────────    │
│                                                                 │
│  Primary Cause: Door zone sensor misalignment                   │
│                                                                 │
│  Diagnostic Steps:                                              │
│  1. Check sensor alignment at door zone markers                 │
│  2. Verify sensor output (should be 4.2-4.8V active)           │
│  3. Inspect wiring harness for damage                           │
│  4. Test with known-good sensor if available                    │
│                                                                 │
│  Parts Likely Needed:                                           │
│  • KM-DZ-505 Door Zone Sensor ($85)                            │
│  • 3 in your van • 2 nearby (Mike Chen, 1.2km)                 │
│                                                                 │
│  Estimated Time: 45-90 minutes                                  │
│                                                                 │
│  Similar Cases: 847 resolved with this approach                 │
│                                                                 │
│  [ This Helped ✓ ]  [ Need More Info ]  [ Save to Job ]        │
│                                                                 │
└─────────────────────────────────────────────────────────────────┘
```

**The "Aha" Moment:**
- Technician sees real value immediately
- Confidence score builds trust
- Nearby parts creates network awareness
- "Similar Cases" demonstrates collective intelligence

---

## Service Company Onboarding

### Overview

```
SERVICE COMPANY JOURNEY
═══════════════════════════════════════════════════════════════════

Time to First Value: ~10 minutes
Time to Full Setup: ~1 hour
Training Required: Optional (recommended for dispatchers)

Step 1 ──► Step 2 ──► Step 3 ──► Step 4 ──► Step 5
Signup     Company    Add        Connect    Go Live
           Profile    Techs      Buildings

           [5 min]    [varies]   [varies]   [1 min]

═══════════════════════════════════════════════════════════════════
```

### Step 1: Company Registration

**Business Setup:**

```
┌─────────────────────────────────────────────────────────┐
│                                                         │
│   Register Your Company                                 │
│                                                         │
│   Company Name: [_________________________]             │
│   ABN/Business ID: [_____________________]              │
│                                                         │
│   Primary Trade:                                        │
│   ○ Elevator & Escalator                                │
│   ○ HVAC                                                │
│   ○ Electrical                                          │
│   ○ Multi-Trade                                         │
│                                                         │
│   Company Size:                                         │
│   ○ 1-5 technicians                                     │
│   ○ 6-20 technicians                                    │
│   ○ 21-50 technicians                                   │
│   ○ 50+ technicians                                     │
│                                                         │
│   [ Continue → ]                                        │
│                                                         │
└─────────────────────────────────────────────────────────┘
```

---

### Step 2: Admin User Setup

**First Administrator:**

```
┌─────────────────────────────────────────────────────────┐
│                                                         │
│   Create Admin Account                                  │
│                                                         │
│   You'll be the primary administrator.                  │
│   You can add more admins later.                        │
│                                                         │
│   Your Name: [_________________________]                │
│   Email: [_____________________________]                │
│   Role: [Operations Manager    ▼]                       │
│                                                         │
│   [ Create Account → ]                                  │
│                                                         │
└─────────────────────────────────────────────────────────┘
```

---

### Step 3: Invite Technicians

**Team Building:**

```
┌─────────────────────────────────────────────────────────────────┐
│                                                                 │
│   Add Your Team                                                 │
│                                                                 │
│   Invite technicians to connect their profiles.                 │
│   They keep their profile—you get operational tools.            │
│                                                                 │
│   ┌─────────────────────────────────────────────────────────┐   │
│   │  Invite by Email (one per line):                        │   │
│   │  ┌─────────────────────────────────────────────────┐    │   │
│   │  │ tech1@example.com                               │    │   │
│   │  │ tech2@example.com                               │    │   │
│   │  │ tech3@example.com                               │    │   │
│   │  └─────────────────────────────────────────────────┘    │   │
│   │                                                         │   │
│   │  [ Send Invitations ]                                   │   │
│   └─────────────────────────────────────────────────────────┘   │
│                                                                 │
│   ─── OR ───                                                    │
│                                                                 │
│   [ Upload CSV ]  [ Generate Join Link ]                        │
│                                                                 │
└─────────────────────────────────────────────────────────────────┘
```

**Join Link Feature:**
- Shareable link for team onboarding
- Can set expiration
- Requires approval or auto-join

---

### Step 4: Connect to Buildings

**Building Relationships:**

```
┌─────────────────────────────────────────────────────────────────┐
│                                                                 │
│   Connect to Buildings                                          │
│                                                                 │
│   Buildings invite contractors—building owns the relationship.  │
│   Once connected, you can log work and see equipment history.   │
│                                                                 │
│   Pending Invitations:                                          │
│   ┌─────────────────────────────────────────────────────────┐   │
│   │ 🏢 123 Collins Street                                   │   │
│   │    Melbourne CBD • 3 elevators                          │   │
│   │    [ Accept ] [ Decline ]                               │   │
│   ├─────────────────────────────────────────────────────────┤   │
│   │ 🏢 Tower Plaza                                          │   │
│   │    Southbank • 6 elevators                              │   │
│   │    [ Accept ] [ Decline ]                               │   │
│   └─────────────────────────────────────────────────────────┘   │
│                                                                 │
│   No invitations yet?                                           │
│   Share your company profile link with building managers:       │
│   [ https://sitesync.com/contractor/acme-elevators ]  [Copy]   │
│                                                                 │
└─────────────────────────────────────────────────────────────────┘
```

---

### Step 5: Operations Dashboard

**Ready to Work:**

```
┌─────────────────────────────────────────────────────────────────┐
│                                                                 │
│  ACME Elevator Services                                         │
│  Operations Dashboard                                           │
│                                                                 │
│  ┌──────────────────────────────────────────────────────────┐   │
│  │ Today's Overview                        Mon, 15 Jan 2025 │   │
│  │ ────────────────────────────────────────────────────────  │   │
│  │ Active Jobs: 12    │ Techs Working: 8  │ Emergencies: 0  │   │
│  └──────────────────────────────────────────────────────────┘   │
│                                                                 │
│  ┌────────────────────────┐  ┌────────────────────────────┐     │
│  │ Pending Jobs           │  │ Team Status                │     │
│  │ ──────────────         │  │ ──────────────             │     │
│  │ ! F505 - Collins St    │  │ 🟢 Sarah Chen - On job     │     │
│  │   Assigned: Sarah C    │  │ 🟢 Mike Wong - Traveling   │     │
│  │ ○ PM Visit - Tower     │  │ 🟡 James Lee - Available   │     │
│  │   Assigned: Unassigned │  │ 🔴 Amy Park - Off duty     │     │
│  └────────────────────────┘  └────────────────────────────┘     │
│                                                                 │
│  ┌──────────────────────────────────────────────────────────┐   │
│  │ Getting Started                              3/5 Done    │   │
│  │ ────────────────────────────────────────────────────────  │   │
│  │ ✓ Company registered                                     │   │
│  │ ✓ Admin account created                                  │   │
│  │ ✓ First technician added                                 │   │
│  │ ○ Connected to first building                            │   │
│  │ ○ Completed first work order                             │   │
│  └──────────────────────────────────────────────────────────┘   │
│                                                                 │
└─────────────────────────────────────────────────────────────────┘
```

---

## Onboarding Emails

### Welcome Sequence

**Email 1: Welcome (Immediate)**

```
Subject: Welcome to SiteSync - Your building just got smarter

─────────────────────────────────────────────────────────

Hi [Name],

Welcome to SiteSync!

Your building now has a memory that never forgets.

Here's what happens next:

1. Add your equipment (2 minutes)
2. Invite your service provider (1 minute)
3. Start building your history

[Get Started →]

Questions? Reply to this email—a real human will help.

─────────────────────────────────────────────────────────
```

**Email 2: First Milestone (Day 3)**

```
Subject: Your first equipment is set up

─────────────────────────────────────────────────────────

Hi [Name],

Great work! [Lobby Elevator 1] is now in your system.

Your building is starting to remember.

Next step: Import your existing service records.
Even a single PDF of your last service report helps.

[Import Records →]

─────────────────────────────────────────────────────────
```

**Email 3: Value Demonstration (Day 7)**

```
Subject: See what SiteSync knows about your building

─────────────────────────────────────────────────────────

Hi [Name],

After one week, here's what SiteSync has learned:

• Equipment health: All systems operational
• Upcoming: Annual inspection due in 45 days
• Insight: Your elevator is performing above average
  for buildings in your area

[View Your Dashboard →]

─────────────────────────────────────────────────────────
```

**Email 4: Engagement (Day 14)**

```
Subject: Have you tried AI diagnosis yet?

─────────────────────────────────────────────────────────

Hi [Name],

The most powerful feature you haven't tried:

AI Diagnosis turns a fault code into a solution in seconds.

Next time your contractor reports a code, try it.

[Try AI Diagnosis →]

─────────────────────────────────────────────────────────
```

---

## In-App Guidance

### Contextual Help

**Tooltips:**
- First-time features show brief explanation
- "Got it" dismisses permanently
- "Learn more" opens help article

**Interactive Walkthroughs:**
- Available on-demand from Help menu
- Feature-specific tutorials
- Progress saved between sessions

### Help Resources

**Self-Service:**
- Searchable help center
- Video tutorials (<3 min each)
- FAQ by user type
- Community forums

**Human Support:**
- In-app chat (business hours)
- Email support (24h response)
- Callback request
- Enterprise: Dedicated CSM

---

## Success Metrics

### Onboarding KPIs

| Metric | Target | Measurement |
|--------|--------|-------------|
| Time to First Value | <5 min | Time to first meaningful action |
| Setup Completion | >70% | Users completing all onboarding steps |
| Day 7 Retention | >60% | Users active 7 days after signup |
| Day 30 Retention | >40% | Users active 30 days after signup |
| Feature Discovery | >50% | Users trying AI diagnosis in first week |

### Activation Milestones

**Building:**
1. Account created
2. First equipment added
3. First contractor connected
4. First work order logged
5. First AI feature used

**Technician:**
1. Profile created
2. Employer connected
3. First job completed
4. First knowledge contribution
5. First endorsement received

**Service Company:**
1. Company registered
2. First technician added
3. First building connected
4. First work order completed
5. First invoice generated

---

## Troubleshooting Onboarding

### Common Issues

**"I can't find my building in the system"**
- Building must be added by owner/manager first
- Technicians access buildings via contractor relationship
- Check invitation from building manager

**"My contractor hasn't accepted my invitation"**
- Check spam folder
- Resend invitation
- Try phone/SMS alternative
- Consider self-managing records temporarily

**"I lost my verification email"**
- Check spam/junk folder
- Request resend from login page
- Contact support for manual verification

**"I'm a technician but my employer isn't on SiteSync"**
- Use platform independently
- Share company registration link with employer
- Work history still builds your profile

---

**[← Back to Quick Reference](../reference/quick-reference.md)** | **[Next: Data Migration →](../how-to/data-migration.md)**


<!-- FILE: docs/tutorials/add-assets.md -->

# Add Assets Tutorial

> Register your building equipment in SiteSync

## Overview

Assets are any equipment in your building that needs maintenance: lifts, HVAC units, electrical panels, fire systems, etc. This tutorial walks you through adding your first asset.

## Prerequisites

- Active SiteSync account
- Building/site already created
- Equipment information (manufacturer, model, location)

---

## Step 1: Navigate to Assets

From your dashboard:

1. Select your building
2. Click **Assets** in the sidebar
3. Click **+ Add Asset**

---

## Step 2: Select Trade Type

Choose the equipment category:

| Trade | Examples |
|-------|----------|
| Lifts & Escalators | Passenger lift, goods lift, escalator |
| HVAC | Chiller, AHU, split system |
| Electrical | Main switchboard, distribution board |
| Fire Systems | Alarm panel, sprinklers, extinguishers |
| Plumbing | Hot water system, pumps |
| Security | Access control, CCTV |

---

## Step 3: Enter Equipment Details

**Required fields:**

- **Asset Number** — Your identifier (e.g., "Lift 1", "AHU-01")
- **Manufacturer** — Equipment maker
- **Model** — Model name/number

**Optional but recommended:**

- Serial number
- Installation date
- Specifications (capacity, speed, etc.)

---

## Step 4: Smart Suggestions

SiteSync recognizes common equipment:

```
You entered: KONE MonoSpace
┌─────────────────────────────────────────────┐
│  ✓ Recognized: KONE MonoSpace 500 Series    │
│                                             │
│  Auto-filled:                               │
│  • Drive type: MRL                          │
│  • Typical capacity: 630-1000kg             │
│  • Controller: KCM/KDM                      │
│                                             │
│  [ Accept ]  [ Edit ]                       │
└─────────────────────────────────────────────┘
```

---

## Step 5: Confirm and Save

Review the asset details, then click **Save Asset**.

Your asset now appears in:
- Building dashboard health score
- Asset list
- Available for work orders

---

## Next Steps

- [Create Work Orders](work-orders.md) — Log jobs for this asset
- [Use AI Diagnosis](ai-diagnosis.md) — Get AI help with faults
- [Data Migration](../how-to/data-migration.md) — Bulk import assets

---

**[← Back to Tutorials](../README.md)**


<!-- FILE: docs/tutorials/work-orders.md -->

# Work Orders Tutorial

> Create and manage maintenance jobs in SiteSync

## Overview

Work orders track maintenance tasks from request to completion. This tutorial covers creating, assigning, and completing work orders.

## Prerequisites

- Active SiteSync account
- At least one asset registered
- Contractor invited (for assignment)

---

## Creating a Work Order

### Step 1: Start New Work Order

From any view:
- **Dashboard**: Click **+ New Work Order**
- **Asset detail**: Click **Report Issue**
- **Quick action**: Use keyboard shortcut `N`

### Step 2: Select Asset

Choose the equipment needing work:

```
┌─────────────────────────────────────────────┐
│  Select Asset                               │
│                                             │
│  🔍 Search...                               │
│                                             │
│  Recent:                                    │
│  ○ Lift 1 - KONE MonoSpace                  │
│  ○ Lift 2 - Otis Gen2                       │
│  ○ AHU-01 - Daikin                          │
│                                             │
│  [ Browse All Assets ]                      │
└─────────────────────────────────────────────┘
```

### Step 3: Describe the Issue

**Required:**
- **Title** — Short description (e.g., "Door not closing properly")
- **Type** — Breakdown, Preventive, Inspection, etc.
- **Priority** — Emergency, High, Medium, Low

**Optional:**
- Detailed description
- Fault code (if known)
- Photos

### Step 4: Get AI Diagnosis (Optional)

Click **Get AI Diagnosis** for intelligent suggestions:

```
┌─────────────────────────────────────────────┐
│  🤖 AI Diagnosis (92% confidence)           │
│                                             │
│  Likely cause: Door operator belt worn      │
│                                             │
│  Suggested parts:                           │
│  □ Door belt assembly                       │
│  □ Belt tensioner                           │
│                                             │
│  Est. repair time: 45-60 min                │
│                                             │
│  [ Accept ]  [ Dismiss ]                    │
└─────────────────────────────────────────────┘
```

### Step 5: Assign Contractor

Select who should do the work:

| Assignment Method | When to Use |
|-------------------|-------------|
| **Direct assign** | Known contractor |
| **Auto-assign** | Use routing rules |
| **Quote request** | Get competitive bids |

### Step 6: Create Work Order

Click **Create** to generate the work order.

---

## Work Order Lifecycle

```
draft → pending → scheduled → in_progress → completed → invoiced
```

| Status | Meaning |
|--------|---------|
| `draft` | Not yet submitted |
| `pending` | Awaiting assignment |
| `scheduled` | Assigned with date |
| `in_progress` | Technician on-site |
| `completed` | Work finished |
| `invoiced` | Payment processed |

---

## Completing a Work Order

When work is done:

1. **Resolution notes** — What was fixed
2. **Parts used** — Record inventory
3. **Labor time** — Auto-tracked or manual
4. **Photos** — Before/after evidence
5. Click **Complete Job**

---

## Priority Levels

| Priority | Expected Response |
|----------|-------------------|
| **Emergency** | Immediate dispatch |
| **High** | Same day |
| **Medium** | Within 48 hours |
| **Low** | Within 1 week |
| **Scheduled** | Planned date |

---

## Next Steps

- [AI Diagnosis](ai-diagnosis.md) — Deep dive on AI features
- [Compliance Tracking](../how-to/compliance-tracking.md) — Manage inspections
- [Switch Contractors](../how-to/switch-contractors.md) — Change providers

---

**[← Back to Tutorials](../README.md)**


<!-- FILE: docs/tutorials/ai-diagnosis.md -->

# AI Diagnosis Tutorial

> Use Triforce AI for intelligent fault diagnosis

## Overview

SiteSync's Triforce AI analyzes faults using multiple AI models to provide reliable diagnoses. This tutorial shows you how to use AI assistance effectively.

## How Triforce AI Works

```
Your fault report
      ↓
┌─────────────────────┐
│ 3 AI Models in      │
│ parallel (Jury)     │
│  • Gemini 2.0       │
│  • Claude Sonnet    │
│  • GPT-4            │
└─────────────────────┘
      ↓
Consensus voting
      ↓
Validation against knowledge base
      ↓
Final diagnosis with confidence score
```

**Why multiple models?** No single AI is always right. Consensus reduces errors.

---

## Using AI Diagnosis

### Step 1: Describe the Fault

When creating a work order, provide details:

**Good description:**
> "Lift making grinding noise during door operation on Level 3. Started yesterday. No error codes on panel."

**Better with specifics:**
> "KONE lift showing F505 fault code intermittently. Doors hesitate before closing. Humidity has been high this week."

### Step 2: Request Diagnosis

Click **Get AI Diagnosis** or enable auto-diagnosis in settings.

### Step 3: Review Results

```
┌─────────────────────────────────────────────────────────┐
│  🤖 AI Diagnosis                                        │
│                                                         │
│  Confidence: ████████░░ 88%                             │
│                                                         │
│  LIKELY CAUSE                                           │
│  Door zone sensor misalignment (F505 = door zone fault) │
│                                                         │
│  SUPPORTING EVIDENCE                                    │
│  • F505 commonly linked to door zone sensors            │
│  • Humidity can cause sensor drift                      │
│  • Similar issue resolved on this unit 8 months ago     │
│                                                         │
│  RECOMMENDED ACTIONS                                    │
│  1. Check door zone sensor alignment                    │
│  2. Clean sensor lenses                                 │
│  3. Verify wiring connections                           │
│                                                         │
│  SUGGESTED PARTS                                        │
│  □ Door zone sensor (if damaged)                        │
│                                                         │
│  Est. time: 30-45 minutes                               │
│                                                         │
│  [ Accept ]  [ Request Alternative ]  [ Dismiss ]       │
└─────────────────────────────────────────────────────────┘
```

---

## Confidence Levels

| Score | Meaning | UI Treatment |
|-------|---------|--------------|
| **95%+** | Very confident | Single suggestion |
| **80-95%** | Confident | Primary + alternatives |
| **60-80%** | Moderate | Multiple options, you choose |
| **<60%** | Uncertain | Request more information |

---

## Tips for Better Diagnoses

### Provide Context

- **Fault codes** — If displayed, include them
- **History** — "This has happened before" or "First time"
- **Conditions** — Weather, recent work, usage patterns
- **Observations** — Sounds, smells, visual clues

### Use Equipment History

AI learns from your building's history:

```
┌─────────────────────────────────────────────┐
│  📊 Equipment Quirks (Learned)              │
│                                             │
│  This lift tends to show F505 on humid      │
│  days. Previous resolution: sensor          │
│  cleaning resolved 3 of last 4 occurrences. │
└─────────────────────────────────────────────┘
```

### Feedback Loop

After completing a job:

1. Confirm if diagnosis was correct
2. AI confidence improves for similar issues
3. Building-specific knowledge accumulates

---

## Trade-Specific Knowledge

Triforce AI has specialized knowledge per trade:

### Lifts & Escalators
- Fault code databases (KONE, Otis, Schindler, ThyssenKrupp)
- Door system diagnostics
- Drive system analysis
- Safety circuit troubleshooting

### HVAC
- Refrigeration cycle analysis
- Airflow diagnostics
- Energy efficiency patterns

### Electrical
- Power distribution issues
- Protection coordination
- Emergency system faults

### Fire Systems
- Detection system analysis
- Compliance requirements (AS 1851)
- Suppression system checks

---

## When AI is Uncertain

If confidence is low, AI will ask clarifying questions:

```
┌─────────────────────────────────────────────┐
│  🤔 Need more information                   │
│                                             │
│  To improve diagnosis accuracy:             │
│                                             │
│  1. What floor does this occur on?          │
│     ○ All floors  ○ Specific floor: ____    │
│                                             │
│  2. Is there a fault code displayed?        │
│     ○ Yes: ____  ○ No  ○ Not sure           │
│                                             │
│  3. When did this start?                    │
│     ○ Today  ○ This week  ○ Gradual         │
│                                             │
│  [ Submit Answers ]                         │
└─────────────────────────────────────────────┘
```

---

## Further Reading

- [Triforce AI Architecture](../explanation/triforce-ai.md) — Technical deep-dive
- [Work Orders](work-orders.md) — Create jobs with diagnoses
- [Data Model](../reference/data-model.md) — AI-related fields

---

**[← Back to Tutorials](../README.md)**


<!-- FILE: docs/how-to/data-migration.md -->

# SiteSync V3 - Data Migration

## Importing Your Building History

> This document provides comprehensive guidance for migrating existing service records, equipment data, and historical documentation into SiteSync.

---

## Philosophy: Your History Matters

```
╔══════════════════════════════════════════════════════════════════╗
║                                                                  ║
║   Your building has a story.                                     ║
║                                                                  ║
║   Every service call, every part replaced, every technician      ║
║   who solved a problem—that's institutional knowledge.           ║
║                                                                  ║
║   SiteSync preserves that story and makes it searchable,        ║
║   intelligent, and permanent.                                    ║
║                                                                  ║
║   The more history you bring, the smarter your building gets.    ║
║                                                                  ║
╚══════════════════════════════════════════════════════════════════╝
```

### Migration Benefits

| What You Import | What You Gain |
|-----------------|---------------|
| Service records | AI learns your equipment patterns |
| Work orders | Historical trend analysis |
| Compliance docs | Automated certificate tracking |
| Equipment specs | Instant technician context |
| Contractor history | Performance benchmarking |

---

## Migration Overview

### Supported Import Sources

```
DATA SOURCES
═══════════════════════════════════════════════════════════════════

DIGITAL FORMATS
───────────────
PDF Documents          Service reports, inspection certificates
Excel/CSV              Spreadsheet records, asset lists
Word Documents         Reports, specifications
Images/Photos          Nameplates, handwritten logs
Email Archives         Service correspondence

SYSTEM EXPORTS
──────────────
ServiceTitan           Work order export
Fiix                   Asset/maintenance export
UpKeep                 CMMS data export
Limble                 Maintenance records
Manufacturer Portals   KONE, Otis, Schindler service logs

PHYSICAL RECORDS
────────────────
Paper Logs             Scanned or photographed
Logbooks               Digitized via OCR
Filing Cabinets        Bulk scanning service available

═══════════════════════════════════════════════════════════════════
```

---

## Migration Paths

### Path 1: Self-Service Upload

**Best for:** Small volumes, digital documents

```
SELF-SERVICE MIGRATION
═══════════════════════════════════════════════════════════════════

Step 1: Prepare Files
├── Gather digital documents
├── Organize by equipment or date
└── Ensure readable quality

Step 2: Upload to SiteSync
├── Navigate to Site → Import
├── Drag and drop files
└── AI processes automatically

Step 3: Review & Confirm
├── AI extracts data
├── You verify accuracy
└── Records added to history

Time: 15-30 minutes for typical building
Cost: Free (included)

═══════════════════════════════════════════════════════════════════
```

### Path 2: Assisted Migration

**Best for:** Large volumes, complex histories

```
ASSISTED MIGRATION
═══════════════════════════════════════════════════════════════════

Step 1: Request Assistance
├── Contact migration team
├── Describe data sources
└── Schedule kickoff call

Step 2: Data Collection
├── Provide access to records
├── Migration team extracts
└── AI processes in bulk

Step 3: Validation Workshop
├── Review extracted data
├── Correct any issues
└── Approve for import

Step 4: Go Live
├── Data imported
├── Training provided
└── Ongoing support

Time: 1-2 weeks depending on volume
Cost: Included for Enterprise, $299 one-time for Pro

═══════════════════════════════════════════════════════════════════
```

### Path 3: System Integration

**Best for:** Migrating from existing CMMS/FSM

```
SYSTEM INTEGRATION MIGRATION
═══════════════════════════════════════════════════════════════════

Supported Systems:
├── ServiceTitan
├── Fiix
├── UpKeep
├── Limble CMMS
├── Maintenance Connection
└── Custom systems via API

Process:
1. Export from existing system
2. Upload export files to SiteSync
3. Automated mapping and transformation
4. Validation and confirmation
5. Ongoing sync (optional)

═══════════════════════════════════════════════════════════════════
```

---

## Document Processing

### AI-Powered Extraction

**How It Works:**

```
┌─────────────────────────────────────────────────────────────────┐
│                                                                 │
│   DOCUMENT UPLOAD                                               │
│        │                                                        │
│        ▼                                                        │
│   ┌─────────────────────────────────────────────────────────┐   │
│   │ OCR Processing                                          │   │
│   │ • Text extraction from scans                            │   │
│   │ • Handwriting recognition                               │   │
│   │ • Table structure detection                             │   │
│   └─────────────────────────────────────────────────────────┘   │
│        │                                                        │
│        ▼                                                        │
│   ┌─────────────────────────────────────────────────────────┐   │
│   │ AI Classification                                       │   │
│   │ • Document type identification                          │   │
│   │ • Equipment matching                                    │   │
│   │ • Date/event extraction                                 │   │
│   └─────────────────────────────────────────────────────────┘   │
│        │                                                        │
│        ▼                                                        │
│   ┌─────────────────────────────────────────────────────────┐   │
│   │ Structured Output                                       │   │
│   │ • Work orders created                                   │   │
│   │ • Equipment records updated                             │   │
│   │ • Documents linked                                      │   │
│   └─────────────────────────────────────────────────────────┘   │
│        │                                                        │
│        ▼                                                        │
│   HUMAN REVIEW                                                  │
│   • Confidence scores shown                                     │
│   • Easy correction interface                                   │
│   • Learn from corrections                                      │
│                                                                 │
└─────────────────────────────────────────────────────────────────┘
```

### Extracted Data Types

**From Service Reports:**

| Field | Extraction | Confidence |
|-------|------------|------------|
| Service date | High (95%+) | Dates are reliable |
| Technician name | High (90%+) | Usually clear |
| Equipment serviced | Medium (80%+) | May need matching |
| Work performed | Medium (75%+) | Free text varies |
| Parts used | Medium (70%+) | Format varies |
| Fault codes | High (90%+) | Structured format |

**From Inspection Certificates:**

| Field | Extraction | Confidence |
|-------|------------|------------|
| Certificate number | High (95%+) | Structured |
| Issue date | High (95%+) | Standard format |
| Expiry date | High (95%+) | Standard format |
| Inspector | High (90%+) | Usually clear |
| Equipment details | High (85%+) | Structured |
| Pass/fail status | High (95%+) | Binary |

---

## Data Mapping

### Standard Field Mappings

**Equipment Data:**

```yaml
Source Field         → SiteSync Field
─────────────────────────────────────────────────
Asset ID            → equipment.external_reference
Name                → equipment.name
Location            → equipment.location
Manufacturer        → equipment.manufacturer
Model               → equipment.model_number
Serial Number       → equipment.serial_number
Install Date        → equipment.installation_date
Category            → equipment.type
Status              → equipment.status
```

**Work Order Data:**

```yaml
Source Field         → SiteSync Field
─────────────────────────────────────────────────
Work Order #        → work_order.external_reference
Created Date        → work_order.created_at
Description         → work_order.description
Priority            → work_order.priority
Type                → work_order.type
Assigned Tech       → work_order.assigned_to
Status              → work_order.status
Completed Date      → work_order.completed_at
Parts Used          → work_order_parts[]
Labor Hours         → work_order_labor[]
Notes               → work_order.notes
```

### Custom Field Handling

```
CUSTOM FIELDS
═══════════════════════════════════════════════════════════════════

If your existing system has custom fields:

1. During migration setup, identify custom fields
2. Map to SiteSync custom fields or notes
3. Preserve original data in metadata

Example:
  Source: "Risk Score: 7/10"
  Maps to: equipment.metadata.legacy_risk_score = 7

Nothing is lost. Everything is preserved.

═══════════════════════════════════════════════════════════════════
```

---

## Migration Templates

### Equipment Import Template

**CSV Format:**

```csv
equipment_name,manufacturer,model,serial_number,installation_date,location,type,status
"Lobby Elevator 1",KONE,MonoSpace 500,KM-12345-2019,2019-03-15,"Ground Floor",traction,operational
"Service Elevator",Otis,Gen2 MRL,OT-67890-2015,2015-08-22,"Basement",traction,operational
"Escalator 1",Schindler,9300AE,SC-11111-2020,2020-01-10,"Mall Entry",escalator,operational
```

**Download Templates:**
- [Equipment Import Template (CSV)](templates/equipment_import.csv)
- [Equipment Import Template (Excel)](templates/equipment_import.xlsx)

### Work Order Import Template

**CSV Format:**

```csv
date,equipment_name,work_type,description,technician,parts_used,labor_hours,status
2024-01-15,"Lobby Elevator 1",breakdown,"F505 fault - door zone sensor replaced","Sarah Chen","KM-DZ-505:1",2.5,completed
2024-02-01,"Lobby Elevator 1",preventive,"Monthly PM inspection","Mike Wong","",1.0,completed
2024-02-20,"Service Elevator",breakdown,"Door operator noise - adjusted","Sarah Chen","",0.5,completed
```

**Download Templates:**
- [Work Order Import Template (CSV)](templates/workorder_import.csv)
- [Work Order Import Template (Excel)](templates/workorder_import.xlsx)

### Compliance Certificate Template

**CSV Format:**

```csv
certificate_number,equipment_name,certificate_type,issue_date,expiry_date,issuing_authority,inspector,status
CERT-2024-001,"Lobby Elevator 1",annual_inspection,2024-01-15,2025-01-15,"WorkSafe Victoria","John Smith",valid
CERT-2024-002,"Service Elevator",annual_inspection,2024-01-15,2025-01-15,"WorkSafe Victoria","John Smith",valid
```

---

## Step-by-Step Migration

### Phase 1: Assessment

**Inventory Your Data:**

```
DATA INVENTORY CHECKLIST
═══════════════════════════════════════════════════════════════════

☐ Equipment Records
  ☐ How many pieces of equipment?
  ☐ What format? (spreadsheet, documents, system)
  ☐ How complete are specifications?

☐ Service History
  ☐ How many years of history?
  ☐ How are records stored?
  ☐ Digital or paper?

☐ Compliance Documents
  ☐ Current certificates on file?
  ☐ Historical inspections available?
  ☐ Expiry dates known?

☐ Contractor Records
  ☐ Which contractors have serviced building?
  ☐ Contact information available?
  ☐ Contract documents?

☐ Additional Documents
  ☐ Equipment manuals
  ☐ As-built drawings
  ☐ Warranty documents

═══════════════════════════════════════════════════════════════════
```

**Prioritization Matrix:**

| Data Type | Priority | Reason |
|-----------|----------|--------|
| Current equipment specs | High | Enables all features |
| Recent service history (2 years) | High | AI learning |
| Compliance certificates | High | Regulatory requirement |
| Complete service history | Medium | Better predictions |
| Equipment manuals | Medium | Reference value |
| Old contractor records | Low | Historical only |

---

### Phase 2: Preparation

**Data Cleanup Recommendations:**

```
DATA QUALITY CHECKLIST
═══════════════════════════════════════════════════════════════════

EQUIPMENT DATA
☐ Remove duplicate entries
☐ Standardize manufacturer names
  (e.g., "KONE" not "Kone" or "kone corp")
☐ Verify serial numbers are accurate
☐ Confirm installation dates

WORK ORDER DATA
☐ Remove test/cancelled orders
☐ Ensure dates are valid
☐ Check equipment references match

COMPLIANCE DATA
☐ Verify certificate numbers
☐ Confirm expiry dates are future
☐ Remove superseded certificates

═══════════════════════════════════════════════════════════════════
```

**File Organization:**

```
Recommended Folder Structure:
───────────────────────────────────────
/migration/
├── /equipment/
│   ├── equipment_list.xlsx
│   └── /specs/
│       ├── elevator_1_specs.pdf
│       └── elevator_2_specs.pdf
├── /service_history/
│   ├── 2023_service_reports/
│   ├── 2024_service_reports/
│   └── work_orders.xlsx
├── /compliance/
│   ├── current_certificates/
│   └── historical_inspections/
└── /manuals/
    ├── kone_monospace_manual.pdf
    └── otis_gen2_manual.pdf
───────────────────────────────────────
```

---

### Phase 3: Upload & Processing

**Self-Service Upload Interface:**

```
┌─────────────────────────────────────────────────────────────────┐
│                                                                 │
│   Import Building History                                       │
│                                                                 │
│   ┌─────────────────────────────────────────────────────────┐   │
│   │                                                         │   │
│   │              📁 Drag files here                         │   │
│   │                                                         │   │
│   │         or click to browse                              │   │
│   │                                                         │   │
│   │   Supported: PDF, Excel, CSV, Word, Images              │   │
│   │   Max 100 files or 500MB per upload                     │   │
│   │                                                         │   │
│   └─────────────────────────────────────────────────────────┘   │
│                                                                 │
│   ─── OR import from template ───                               │
│                                                                 │
│   [ Equipment Template ]  [ Work Orders ]  [ Certificates ]     │
│                                                                 │
└─────────────────────────────────────────────────────────────────┘
```

**Processing Status:**

```
┌─────────────────────────────────────────────────────────────────┐
│                                                                 │
│   Import Progress                                               │
│                                                                 │
│   ┌─────────────────────────────────────────────────────────┐   │
│   │ service_report_2024_jan.pdf      ✓ Processed            │   │
│   │   → 1 work order extracted                              │   │
│   │   → Equipment: Lobby Elevator 1 (matched)               │   │
│   │   → Confidence: 92%                                     │   │
│   ├─────────────────────────────────────────────────────────┤   │
│   │ service_report_2024_feb.pdf      ⟳ Processing...        │   │
│   │   [████████████░░░░░░░░░░] 65%                          │   │
│   ├─────────────────────────────────────────────────────────┤   │
│   │ inspection_cert_2024.pdf         ○ Queued               │   │
│   └─────────────────────────────────────────────────────────┘   │
│                                                                 │
│   Estimated time remaining: 2 minutes                           │
│                                                                 │
└─────────────────────────────────────────────────────────────────┘
```

---

### Phase 4: Validation

**Review Interface:**

```
┌─────────────────────────────────────────────────────────────────┐
│                                                                 │
│   Review Imported Data                                          │
│                                                                 │
│   Document: service_report_2024_jan.pdf     Confidence: 92%     │
│                                                                 │
│   ┌─────────────────────────────────────────────────────────┐   │
│   │ EXTRACTED DATA                   │ ORIGINAL DOCUMENT    │   │
│   │ ────────────────────────         │                      │   │
│   │                                  │  ┌────────────────┐  │   │
│   │ Date: 2024-01-15                 │  │                │  │   │
│   │ Equipment: Lobby Elevator 1 [✓]  │  │  [Preview of   │  │   │
│   │ Work Type: Breakdown             │  │   PDF page]    │  │   │
│   │ Technician: Sarah Chen           │  │                │  │   │
│   │ Description:                     │  │                │  │   │
│   │   F505 fault code. Door zone     │  │                │  │   │
│   │   sensor replaced. System test   │  │                │  │   │
│   │   passed.                        │  └────────────────┘  │   │
│   │                                  │                      │   │
│   │ Parts:                           │  [ View Full Doc ]   │   │
│   │   KM-DZ-505 x1 ($85)            │                      │   │
│   │                                  │                      │   │
│   │ Labor: 2.5 hours                 │                      │   │
│   │                                  │                      │   │
│   │ [ Edit ] [ Correct Equipment ]   │                      │   │
│   └─────────────────────────────────────────────────────────┘   │
│                                                                 │
│   [ ← Previous ]  [ Approve & Next → ]  [ Skip ]  [ Reject ]   │
│                                                                 │
└─────────────────────────────────────────────────────────────────┘
```

**Bulk Validation:**

```
┌─────────────────────────────────────────────────────────────────┐
│                                                                 │
│   Bulk Review                                                   │
│                                                                 │
│   High Confidence (>90%): 45 records                            │
│   [ Approve All High Confidence ]                               │
│                                                                 │
│   Medium Confidence (70-90%): 12 records                        │
│   [ Review Individually ]                                       │
│                                                                 │
│   Low Confidence (<70%): 3 records                              │
│   [ Review Individually ] ← Recommended                         │
│                                                                 │
│   Unprocessable: 2 files                                        │
│   [ View Issues ]                                               │
│                                                                 │
└─────────────────────────────────────────────────────────────────┘
```

---

### Phase 5: Completion

**Post-Migration Summary:**

```
┌─────────────────────────────────────────────────────────────────┐
│                                                                 │
│   Migration Complete                                            │
│                                                                 │
│   ┌─────────────────────────────────────────────────────────┐   │
│   │                                                         │   │
│   │   ✓ 62 documents processed                              │   │
│   │   ✓ 3 equipment records created                         │   │
│   │   ✓ 58 work orders imported                             │   │
│   │   ✓ 6 compliance certificates added                     │   │
│   │   ✓ 5 years of history now searchable                   │   │
│   │                                                         │   │
│   └─────────────────────────────────────────────────────────┘   │
│                                                                 │
│   Your building just got 5 years smarter.                       │
│                                                                 │
│   What's different now:                                         │
│   • AI diagnosis uses your equipment's actual history           │
│   • Health Score reflects real performance data                 │
│   • Technicians see complete context from day one               │
│   • Compliance tracking is automated                            │
│                                                                 │
│   [ Go to Dashboard ]  [ Import More ]  [ Download Report ]     │
│                                                                 │
└─────────────────────────────────────────────────────────────────┘
```

---

## Special Migration Scenarios

### Scenario: Multiple Contractors' Records

**Challenge:** Different contractors have different records for same equipment.

**Solution:**

```
MULTI-CONTRACTOR HISTORY MERGE
═══════════════════════════════════════════════════════════════════

Import Process:
1. Import all records (duplicates OK)
2. AI identifies potential overlaps
3. Timeline construction merges events
4. Human review for conflicts

Result:
├── 2019: ABC Elevators (previous contractor)
│   └── 12 service visits merged
├── 2020: ABC Elevators
│   └── 15 service visits merged
├── 2021-2023: XYZ Lift Services (changed contractor)
│   └── 36 service visits merged
└── 2024: Current contractor
    └── Ongoing live records

Your building remembers everything, regardless of who serviced it.

═══════════════════════════════════════════════════════════════════
```

---

### Scenario: Paper Records Only

**Challenge:** All historical records are paper-based.

**Options:**

```
PAPER RECORD DIGITIZATION
═══════════════════════════════════════════════════════════════════

Option 1: Self-Scan
──────────────────
• Use smartphone to photograph pages
• Upload images to SiteSync
• AI OCR processes automatically
• Best for: <50 pages

Option 2: Bulk Scanning Service
───────────────────────────────
• Ship or pickup documents
• Professional scanning (300 DPI)
• Return originals + digital copies
• Best for: 50-500 pages
• Cost: $0.10-0.25 per page

Option 3: Migration Team Assistance
───────────────────────────────────
• We collect and process
• Quality assurance included
• Structured data extraction
• Best for: 500+ pages or complex records
• Cost: Custom quote

═══════════════════════════════════════════════════════════════════
```

---

### Scenario: Existing CMMS Migration

**From ServiceTitan:**

```python
# ServiceTitan Export Guide
# 1. Go to Settings → Data Management → Export
# 2. Select "Work Orders" and date range
# 3. Export as CSV
# 4. Upload to SiteSync

# Automatic field mapping:
servicetitan_field    → sitesync_field
───────────────────────────────────────
"Job Number"         → external_reference
"Job Type"           → type
"Customer"           → site (by match)
"Description"        → description
"Assigned Tech"      → assigned_to
"Status"             → status
"Completed Date"     → completed_at
"Invoice Total"      → metadata.original_invoice
```

**From Fiix:**

```python
# Fiix Export Guide
# 1. Navigate to Reports → Work Orders
# 2. Configure date range and fields
# 3. Export to Excel
# 4. Upload to SiteSync

# Automatic field mapping:
fiix_field           → sitesync_field
───────────────────────────────────────
"Work Order ID"      → external_reference
"Asset"              → equipment (by match)
"Maintenance Type"   → type
"Description"        → description
"Assigned To"        → assigned_to
"Status"             → status
"Completion Date"    → completed_at
"Labor Hours"        → labor_entries
"Parts"              → parts_used
```

**From Spreadsheets:**

```python
# Generic Spreadsheet Import
# Supported: Excel (.xlsx), CSV, Google Sheets

# Required columns (minimum):
- Date (service date)
- Equipment (name or ID)
- Description (work performed)

# Optional columns (recommended):
- Technician
- Work Type (breakdown, preventive, inspection)
- Parts Used
- Labor Hours
- Status
- Notes

# Tips:
# - Use consistent date format (YYYY-MM-DD preferred)
# - Equipment names must match your SiteSync equipment
# - Include as many columns as available
```

---

## Data Governance

### Ownership & Rights

```
DATA OWNERSHIP PRINCIPLES
═══════════════════════════════════════════════════════════════════

BUILDING DATA
─────────────
• Building owns all data about their property
• Ownership transfers with property sale (optional)
• Export available at any time
• Deletion upon request (with audit retention)

CONTRACTOR DATA
───────────────
• Contractors own their business data
• Work records shared with building
• Company-specific data remains private
• Historical records persist for building

TECHNICIAN DATA
───────────────
• Technicians own their professional profile
• Work history tied to both building AND technician
• Profile portable between employers
• Anonymous contribution option

═══════════════════════════════════════════════════════════════════
```

### Data Retention

| Data Type | Retention Period | Reason |
|-----------|------------------|--------|
| Equipment records | Permanent | Asset lifecycle |
| Work orders | 10 years | Warranty, legal |
| Compliance docs | 7 years past expiry | Regulatory |
| Audit events | Permanent | Integrity |
| Deleted records | 90 days | Recovery |

---

## Validation & Quality

### Post-Migration Checks

**Automated Validation:**

```
AUTOMATED CHECKS
═══════════════════════════════════════════════════════════════════

✓ Equipment Count Match
  Expected: 3 | Imported: 3 | Status: PASS

✓ Work Order Date Range
  Earliest: 2019-03-15 | Latest: 2024-06-01 | Status: PASS

✓ Compliance Currency
  Valid Certs: 3 | Expired: 0 | Status: PASS

⚠ Duplicate Detection
  Potential duplicates: 2 records | Status: REVIEW NEEDED

✓ Equipment Linkage
  Work orders linked: 58/58 (100%) | Status: PASS

═══════════════════════════════════════════════════════════════════
```

**Manual Spot Checks:**

```
RECOMMENDED SPOT CHECKS
═══════════════════════════════════════════════════════════════════

1. Random Sample Review
   □ Select 5% of imported records randomly
   □ Compare to source documents
   □ Verify key fields accurate

2. Timeline Consistency
   □ Review equipment timeline
   □ Verify chronological order
   □ Check for gaps or overlaps

3. Compliance Verification
   □ Compare certificate dates to originals
   □ Verify inspector names
   □ Confirm certificate numbers

4. Part/Cost Accuracy
   □ Verify part numbers match
   □ Check quantities
   □ Confirm cost figures

═══════════════════════════════════════════════════════════════════
```

---

## Troubleshooting

### Common Issues

**"Equipment not matching"**

```
Problem: Imported work orders don't link to equipment

Solutions:
1. Check equipment names match exactly
   - "Elevator 1" ≠ "elevator 1" ≠ "Lift 1"
   - Standardize before import

2. Use equipment ID/serial number
   - More reliable than names
   - Add to import template

3. Manual linking after import
   - Edit work order
   - Select correct equipment
```

**"Dates not parsing correctly"**

```
Problem: Dates showing incorrectly or not importing

Solutions:
1. Use ISO format: YYYY-MM-DD
   - "2024-01-15" (correct)
   - "01/15/2024" (may fail)
   - "15 Jan 2024" (may fail)

2. Specify date format during upload
   - Select your format from dropdown
   - Preview before confirming

3. Check regional settings
   - Australian: DD/MM/YYYY
   - US: MM/DD/YYYY
   - Be explicit
```

**"Low confidence extractions"**

```
Problem: AI extraction confidence is low

Solutions:
1. Improve scan quality
   - 300 DPI minimum
   - Good contrast
   - Straight alignment

2. Use structured templates
   - Standard formats extract better
   - Consider reformatting

3. Manual entry for critical data
   - Some handwritten records need human
   - Flag for manual processing
```

**"Missing historical records"**

```
Problem: Can't find old service records

Solutions:
1. Contact previous contractors
   - Request service history
   - They may have records

2. Check building files
   - Previous manager records
   - Filing cabinets
   - Email archives

3. Request from equipment manufacturer
   - Service portal access
   - Historical reports

4. Start fresh
   - Begin tracking from today
   - History builds over time
```

---

## Migration Support

### Self-Service Resources

- [Video: How to Import Equipment](tutorials/import-equipment.mp4)
- [Video: How to Import Work Orders](tutorials/import-workorders.mp4)
- [Video: How to Import Compliance Docs](tutorials/import-compliance.mp4)
- [Template Downloads](templates/)
- [FAQ: Migration Questions](../faq.md#migration)

### Assisted Support

**Pro Tier:**
- Email support for migration questions
- One-time migration assistance ($299 optional)
- Template customization

**Enterprise Tier:**
- Dedicated migration specialist
- Custom integration development
- On-site assistance available
- Included in contract

### Contact

```
Migration Support
─────────────────────────────────────────
Email: migration@sitesync.com
Schedule Call: sitesync.com/migration-help
Response Time: Within 24 hours
```

---

**[← Back to Quick Start](../tutorials/quick-start.md)** | **[Next: Security & Compliance →](../explanation/security-compliance.md)**


<!-- FILE: docs/how-to/switch-contractors.md -->

# How to Switch Contractors

> Change service providers without losing history

## Overview

One of SiteSync's core benefits: **your data stays with your building**, not with contractors. This guide walks you through changing service providers seamlessly.

## The SiteSync Advantage

**Traditional scenario:**
```
Old contractor leaves → History lost → Start from scratch
```

**With SiteSync:**
```
Old contractor leaves → Full history preserved → New contractor sees everything
```

---

## Step 1: Review Current Access

Before making changes, see who has access:

1. Go to **Settings** → **Contractors**
2. View all connected contractors
3. Note their current access levels

| Access Level | Permissions |
|--------------|-------------|
| **Full** | View, edit, complete work orders |
| **Limited** | View and complete assigned work only |
| **View-only** | See history, no editing |

---

## Step 2: Invite New Contractor

### Method A: Send Invitation

1. Click **+ Invite Contractor**
2. Enter contractor details:
   - Company name
   - Contact email
   - Trade type(s)
3. Set access level
4. Click **Send Invitation**

Contractor receives email:
```
┌─────────────────────────────────────────────────────────┐
│  [Your Building Name] has invited you to SiteSync       │
│                                                         │
│  You've been invited to manage:                         │
│  • Lifts & Escalators (3 assets)                        │
│                                                         │
│  [ Accept Invitation ]                                  │
│                                                         │
│  SiteSync is free for contractors.                      │
└─────────────────────────────────────────────────────────┘
```

### Method B: Contractor Self-Registration

Share your building's connection code:

1. Go to **Settings** → **Building Code**
2. Share the code with new contractor
3. They enter it when joining SiteSync

---

## Step 3: Transfer Access

### Grant Access to New Contractor

1. Select new contractor
2. Choose assets they'll service
3. Set permissions
4. Optionally share historical context

### Share History (Recommended)

Grant new contractor access to see:
- Past work orders (read-only)
- Equipment quirks and notes
- Known issues and resolutions

```
┌─────────────────────────────────────────────┐
│  Share history with ABC Lifts?              │
│                                             │
│  ☑ Past work orders (last 2 years)         │
│  ☑ Equipment notes and quirks              │
│  ☐ Cost/pricing history                    │
│                                             │
│  [ Share Selected ]  [ Skip ]               │
└─────────────────────────────────────────────┘
```

---

## Step 4: Revoke Old Contractor Access

Once new contractor is set up:

1. Go to **Settings** → **Contractors**
2. Select old contractor
3. Click **Revoke Access**
4. Confirm

**Important:** Revoking access does NOT delete their work history. All records remain with your building.

```
┌─────────────────────────────────────────────┐
│  Revoke access for XYZ Services?            │
│                                             │
│  • They will no longer access your building │
│  • All their work history is preserved      │
│  • Open work orders will need reassignment  │
│                                             │
│  [ Revoke Access ]  [ Cancel ]              │
└─────────────────────────────────────────────┘
```

---

## Step 5: Reassign Open Work Orders

If there are pending jobs:

1. Go to **Work Orders** → filter by old contractor
2. Select open work orders
3. Click **Reassign**
4. Choose new contractor

---

## What New Contractors See

When they accept your invitation:

| Information | Visibility |
|-------------|------------|
| Asset list | Full |
| Equipment specs | Full |
| Active work orders | Assigned only |
| Historical work orders | Based on your sharing settings |
| Other contractors' work | Only summaries |
| Pricing/costs | Never (unless you share) |

---

## If Your Contractor Doesn't Use SiteSync

You can still track work:

1. **Log work yourself** — Enter job details after service
2. **Share read-only access** — Contractor views, you enter
3. **Use it as a differentiator** — Ask new contractors if they support SiteSync

Many contractors appreciate that SiteSync is free for them.

---

## Timeline Example

| Day | Action |
|-----|--------|
| Day 1 | Invite new contractor |
| Day 2 | New contractor accepts, reviews history |
| Day 3 | New contractor completes first job |
| Day 7 | Confident in new setup |
| Day 8 | Revoke old contractor access |

---

## FAQ

### Does the old contractor keep any data?

No. Your building's data stays with you. The contractor only retains their own internal records (if any).

### Can I have multiple contractors at once?

Yes. Many buildings have different contractors for different trades, or backup contractors.

### What if I want to switch back?

Simply re-invite them. History is preserved.

---

## Related

- [FAQ](../faq.md) — More questions about contractor relationships
- [For Buildings](../explanation/for-buildings.md) — Building-centric philosophy
- [Security & Compliance](../explanation/security-compliance.md) — Data protection

---

**[← Back to How-To Guides](../README.md)**


<!-- FILE: docs/how-to/compliance-tracking.md -->

# How to Track Compliance

> Manage inspections, certifications, and regulatory requirements

## Overview

SiteSync tracks compliance requirements for all your building equipment, ensuring you never miss an inspection or certification deadline.

## Compliance Dashboard

Access your compliance overview:

1. Go to **Dashboard**
2. Click **Compliance** tab (or sidebar item)

```
┌─────────────────────────────────────────────────────────┐
│  COMPLIANCE OVERVIEW                                    │
│                                                         │
│  ⚠️  2 inspections due this month                       │
│  ✓  15 items compliant                                  │
│  ❌  1 overdue item                                      │
│                                                         │
│  UPCOMING                                               │
│  • Lift 1 annual inspection — Dec 15                    │
│  • Fire panel test — Dec 20                             │
│                                                         │
│  OVERDUE                                                │
│  • Lift 2 safety cert — expired Nov 30 (5 days)        │
│                                                         │
└─────────────────────────────────────────────────────────┘
```

---

## Setting Up Compliance Tracking

### Step 1: Define Requirements

For each asset, set compliance requirements:

1. Go to asset detail
2. Click **Compliance** tab
3. Click **+ Add Requirement**

| Field | Example |
|-------|---------|
| **Requirement type** | Annual inspection |
| **Regulation** | AS 1735 (Lifts) |
| **Frequency** | Every 12 months |
| **Lead time** | 30 days notice |
| **Certification required** | Yes |

### Step 2: Record Current Status

Enter last compliance date:

```
┌─────────────────────────────────────────────┐
│  Lift 1 - Annual Inspection (AS 1735)       │
│                                             │
│  Last completed: Jan 15, 2024               │
│  Certificate #: CERT-2024-001               │
│  Inspector: SafetyFirst Pty Ltd             │
│                                             │
│  Next due: Jan 15, 2025                     │
│  Status: ✓ Compliant (42 days remaining)    │
└─────────────────────────────────────────────┘
```

### Step 3: Set Notifications

Configure alerts:

- **Email alerts** — 30, 14, 7 days before due
- **Dashboard alerts** — Show in compliance widget
- **Auto-create work order** — Generate inspection WO automatically

---

## Common Compliance Types

### Lifts & Escalators

| Requirement | Frequency | Regulation |
|-------------|-----------|------------|
| Annual safety inspection | 12 months | AS 1735 |
| 5-year major inspection | 5 years | AS 1735 |
| Registration renewal | Varies by state | State regulations |

### Fire Systems

| Requirement | Frequency | Regulation |
|-------------|-----------|------------|
| Monthly inspection | Monthly | AS 1851 |
| 6-month service | 6 months | AS 1851 |
| Annual certification | 12 months | AS 1851 |

### HVAC

| Requirement | Frequency | Regulation |
|-------------|-----------|------------|
| Filter replacement | 3-6 months | Manufacturer |
| Refrigerant check | 12 months | ARCTick |
| Energy audit | 24 months | NABERS |

### Electrical

| Requirement | Frequency | Regulation |
|-------------|-----------|------------|
| RCD testing | 6 months | AS/NZS 3760 |
| Thermographic scan | 12 months | Best practice |
| Switchboard inspection | 12 months | AS/NZS 3000 |

---

## Managing Inspections

### Schedule an Inspection

1. From compliance dashboard, click **Schedule** on upcoming item
2. This creates a work order of type `inspection`
3. Assign to qualified inspector/contractor
4. Set scheduled date

### Complete an Inspection

When inspection is done:

1. Complete the work order
2. Upload certificate/report
3. Enter next due date
4. Compliance status auto-updates

```
┌─────────────────────────────────────────────┐
│  Complete Inspection                        │
│                                             │
│  Result: ○ Pass  ○ Fail  ○ Conditional      │
│                                             │
│  Certificate #: _____________               │
│                                             │
│  Upload: [ Choose File ]                    │
│                                             │
│  Notes: ______________________________      │
│                                             │
│  Next due: [ Auto-calculated: Jan 2025 ]    │
│                                             │
│  [ Complete ]                               │
└─────────────────────────────────────────────┘
```

### Handle Failed Inspections

If inspection fails:

1. Record failure with details
2. System creates follow-up work order
3. Track remediation work
4. Schedule re-inspection
5. Asset shows `non-compliant` until resolved

---

## Compliance Reports

Generate reports for:

- **Building managers** — Overview of all compliance items
- **Auditors** — Full compliance history with certificates
- **Insurance** — Proof of maintenance

### Export Options

- PDF summary report
- CSV data export
- Certificate bundle (all docs in ZIP)

---

## Automation Features

### Auto-Generated Work Orders

Enable automatic inspection WO creation:

```
Settings → Compliance → Auto-create work orders

☑ Create inspection WOs automatically
   Lead time: [ 30 ] days before due
   Assign to: [ Preferred contractor ▼ ]
   Priority: [ Medium ▼ ]
```

### Recurring Inspections

Set up perpetual schedule:

```
After completion → auto-schedule next
Based on: ○ Fixed interval  ○ Completion date
```

---

## Compliance Calendar

View all requirements in calendar format:

- **Red** — Overdue
- **Yellow** — Due within 30 days
- **Green** — Compliant
- **Gray** — Scheduled (not yet due)

---

## Related

- [Work Orders](../tutorials/work-orders.md) — Create inspection jobs
- [Data Model](../reference/data-model.md) — Compliance fields
- [Security & Compliance](../explanation/security-compliance.md) — Platform compliance

---

**[← Back to How-To Guides](../README.md)**


<!-- FILE: docs/faq.md -->

# SiteSync V3 - Frequently Asked Questions

## Comprehensive FAQ

> This document answers common questions from all user types: Buildings, Technicians, and Service Companies.

---

```
         YOUR BUILDING. YOUR DATA. YOUR INTELLIGENCE.

                  Contractors come and go.
                  Your building remembers forever.
```

---

## Quick Navigation

- [General Questions](#general-questions)
- [For Building Managers](#for-building-managers)
- [For Technicians](#for-technicians)
- [For Service Companies](#for-service-companies)
- [Pricing & Billing](#pricing--billing)
- [Technical Questions](#technical-questions)
- [Data & Privacy](#data--privacy)
- [Migration](#migration)
- [Troubleshooting](#troubleshooting)

---

## General Questions

### What is SiteSync?

SiteSync is an AI-powered building services platform that gives buildings permanent ownership of their service history. Unlike traditional contractor software, SiteSync's data belongs to the building—it stays with the property regardless of which contractors perform the work.

**Core value:** Your building remembers forever. Contractors come and go.

---

### Who is SiteSync for?

**Building Managers & Owners:**
- Own complete service history
- Track equipment health
- Manage compliance
- Hold contractors accountable

**Technicians:**
- AI-powered diagnosis
- Professional profile building
- Access collective knowledge
- Career development

**Service Companies:**
- Operational tools
- Connect with building customers
- Recruit talent
- Access marketplace

---

### What trades does SiteSync support?

**Currently Available:**
- Elevators & Escalators (full AI support)

**Coming Soon:**
- HVAC
- Electrical
- Fire Systems
- Plumbing

**Future:**
- All building trades

---

### Is SiteSync available in my country?

**Currently:**
- Australia (full availability)
- New Zealand (full availability)

**Coming Soon:**
- United States
- United Kingdom
- Europe

---

## For Building Managers

### What makes SiteSync different from other maintenance software?

Traditional CMMS/FSM software sells to contractors and helps them run their business. When you change contractors, your history often disappears with them.

**SiteSync is different:**
- You (the building) own all data
- History stays with the building forever
- Contractors access your data, not the other way around
- You maintain control and visibility

---

### How does data ownership work?

When you use SiteSync:
1. **You create the building profile** - you own it
2. **Contractors you invite can log work** - on YOUR record
3. **If you change contractors** - nothing changes for you
4. **The new contractor sees full history** - with your permission

Your building's institutional memory never disappears.

---

### What can I see that I couldn't before?

**Without SiteSync:**
- Service records scattered across contractors
- History lost when contractors change
- No visibility into equipment patterns
- Compliance tracking in spreadsheets

**With SiteSync:**
- Complete unified timeline
- All contractors' work in one place
- AI insights from your equipment's history
- Automated compliance tracking
- Building Health Score

---

### Do I need my contractor's permission?

No. You own the building and the data. You can:
- Start using SiteSync without contractor involvement
- Log service records yourself
- Import historical records
- Invite contractors when ready

When you invite a contractor, they can log work directly—but YOU always own the record.

---

### What if my contractor doesn't want to use SiteSync?

That's their choice, but it doesn't affect you:
- Log records yourself after service visits
- Upload their service reports (AI extracts data)
- Import their invoices and documentation
- Consider it when choosing future contractors

Many contractors appreciate that SiteSync is free for them to use and makes their work easier.

---

### What is Building Health Score?

A single number (0-100) representing your building's overall equipment condition:

| Component | Weight |
|-----------|--------|
| Equipment Condition | 25% |
| Maintenance Compliance | 25% |
| Incident Frequency | 20% |
| First-Time Fix Rate | 15% |
| Predictive Risk | 15% |

The score improves as you add more history and maintain equipment properly.

---

### Can I export my data?

Yes, always. You can export:
- Complete equipment records
- All work order history
- Compliance documents
- Audit trail
- Custom reports

Formats: PDF, Excel, CSV, JSON

Your data is never locked in.

---

## For Technicians

### Is SiteSync really free for technicians?

Yes, completely free:
- Create professional profile
- Access AI diagnosis
- Search knowledge base
- Log work
- Build reputation

No hidden fees. No trial. Free forever.

---

### Why is it free for technicians?

SiteSync's business model charges buildings, not technicians. We believe:
- Technicians shouldn't pay to do their jobs better
- Free access builds the community
- The more technicians contribute, the more valuable the platform

You're the experts. We want you here.

---

### How does the professional profile work?

Your profile includes:
- Verified job history (from completed work)
- Expertise score (grows with experience)
- Specializations (equipment brands, types)
- Certifications (upload and verify)
- Knowledge contributions
- Peer endorsements
- Badges and achievements

**Portable:** Your profile travels with you. Change employers? Your reputation stays.

---

### Can I use SiteSync on my resume?

Absolutely. Many technicians include:
- Profile link on resume/CV
- QR code on business cards
- Reference for job applications

Employers can see your verified work history and expertise (with your permission).

---

### What is the Knowledge Base?

A collective repository of solutions, tips, and procedures shared by technicians worldwide:
- Fault code solutions
- Equipment quirks
- Quick fixes
- Procedures
- Safety notes

**How it works:**
1. You solve a problem
2. Document the solution
3. Community accesses it
4. You get credit (expertise score)

---

### Can I contribute anonymously?

Yes. You can:
- Share knowledge without employer attribution
- Protect sensitive information
- Still earn private reputation credit
- Build the commons safely

Use the anonymous option when sharing.

---

### How does AI Diagnosis work?

1. Enter fault code or describe symptoms
2. AI analyzes against thousands of similar cases
3. Get probable cause, diagnostic steps, parts needed
4. Confidence score shows reliability

The AI learns from every resolved case, getting smarter over time.

---

### What about proprietary information?

SiteSync empowers technicians with knowledge that should be accessible:
- General troubleshooting approaches
- Common fault solutions
- Safety procedures

We do NOT encourage sharing:
- Trade secrets
- Proprietary schematics
- Confidential business information

Use good judgment. When in doubt, use anonymous mode or don't share.

---

## For Service Companies

### Why should my company use SiteSync?

**Operational benefits:**
- AI diagnosis for faster resolution
- Technician scheduling and dispatch
- Van stock management
- Parts marketplace access

**Business benefits:**
- Connect with building customers
- Showcase team expertise
- Recruit talented technicians
- Professional reputation

**It's free to start.** Pro features available for growing companies.

---

### Our technicians already have their own profiles. How does that work?

When a technician joins your company on SiteSync:
- Their profile remains theirs
- They link to your company
- Their work logs under both (company AND personal)
- If they leave, their profile goes with them

This is by design. Technicians own their careers. You get operational tools.

---

### Can we see our competitors' data?

No. You only see:
- Your company's data
- Buildings you're invited to service
- Public knowledge base (everyone sees this)

You cannot see other companies' customers, pricing, or operations.

---

### How do building relationships work?

Buildings invite contractors:
1. Building creates SiteSync account
2. Building invites your company
3. You accept invitation
4. You can now log work on their equipment
5. Building controls what you see

The building owns the relationship. This protects both parties.

---

### What if a building we service isn't on SiteSync?

Options:
- Suggest they sign up (free for basic use)
- Use SiteSync for your internal records
- Import their data if they sign up later

Your technicians can still use AI diagnosis and knowledge base regardless.

---

## Pricing & Billing

### How much does SiteSync cost?

**For Buildings:**

| Tier | Price | Features |
|------|-------|----------|
| Free | $0/month | 10 lookups/month, basic features |
| Pro | $29/month | Unlimited, all core features |
| Enterprise | Custom | Multi-site, dedicated support, custom integrations |

**For Technicians:**
- Free forever

**For Service Companies:**

| Tier | Price | Features |
|------|-------|----------|
| Starter | $0/month | Basic access, up to 5 technicians |
| Pro | $49/month | Full suite, unlimited technicians |
| Enterprise | Custom | Multi-location, API access |

---

### Are there volume discounts for buildings?

Yes:

| Buildings | Price per Building |
|-----------|--------------------|
| 1-10 | $29/month |
| 11-50 | $24/month |
| 51+ | $19/month |

Contact sales for portfolio pricing.

---

### What payment methods do you accept?

- Credit/debit cards (Visa, Mastercard, Amex)
- Direct debit (Australia)
- Invoice (Enterprise, annual)

---

### Can I cancel anytime?

Yes. No lock-in contracts for monthly plans:
- Cancel anytime
- Export all your data first
- Access continues until period ends
- Data retained 90 days after cancellation

---

### What happens to my data if I cancel?

1. Export everything before cancellation
2. Account access ends at period end
3. Data retained 90 days (recovery possible)
4. After 90 days, permanently deleted
5. Audit logs retained for compliance

---

## Technical Questions

### Does SiteSync work offline?

Yes, with limitations:
- View assigned jobs offline
- Access cached equipment history
- Log work (syncs when online)
- Access downloaded manuals

AI features require internet connection.

---

### Is there a mobile app?

SiteSync is a Progressive Web App (PWA):
- Works on any modern browser
- Install to home screen
- Offline capability
- Push notifications

Native apps planned for future.

---

### What browsers are supported?

- Chrome (recommended)
- Safari
- Firefox
- Edge

Mobile: iOS Safari, Android Chrome

---

### Is there an API?

Yes, full REST API available:
- All functionality accessible via API
- OAuth 2.0 authentication
- Rate limiting applies
- OpenAPI 3.1 specification
- Available on Pro and Enterprise plans

---

### What integrations are available?

**Current:**
- Google Workspace
- Microsoft 365
- Xero
- MYOB
- QuickBooks

**Coming:**
- ServiceTitan (data import)
- Fiix (data import)
- BMS systems
- Manufacturer portals

---

### How reliable is SiteSync?

**Uptime target:** 99.9%
**Infrastructure:** Google Cloud Platform
**Backups:** Daily, point-in-time recovery
**Disaster recovery:** Multi-region capability

Status page: status.sitesync.com

---

## Data & Privacy

### Who owns my data?

**Buildings:** You own all data about your property
**Technicians:** You own your professional profile
**Service Companies:** You own your company data

SiteSync processes data on your behalf. We don't own it, sell it, or share it without your consent.

---

### Is my data shared with other users?

Your specific data is NEVER shared. However:
- Anonymized patterns improve AI
- Aggregated benchmarks are available
- Knowledge base contributions are shared (by choice)

You can opt out of AI training.

---

### Can SiteSync staff see my data?

Only with your explicit consent (for support), and:
- All access is logged
- Access is time-limited
- You can revoke at any time

We practice minimal access principles.

---

### What security certifications does SiteSync have?

- SOC 2 Type II (certified)
- GDPR compliant
- Australian Privacy Act compliant
- ISO 27001 (in progress)

See [Security & Compliance](explanation/security-compliance.md) for details.

---

### How long is data retained?

| Data Type | Retention |
|-----------|-----------|
| Active account data | Indefinitely |
| Deleted account data | 90 days |
| Audit logs | 7 years |
| Backups | 30 days |

---

### Can I request data deletion?

Yes:
1. Export your data
2. Submit deletion request
3. Account closed
4. Data deleted within 30 days
5. Confirmation provided

Audit logs retained for compliance.

---

## Migration

### Can I import my existing records?

Yes. SiteSync supports importing from:
- PDF documents (AI extraction)
- Excel/CSV spreadsheets
- Existing CMMS (ServiceTitan, Fiix, etc.)
- Paper records (scan and upload)

See [Data Migration](how-to/data-migration.md) for details.

---

### How long does migration take?

**Self-service:** 15-30 minutes for typical building
**Assisted:** 1-2 weeks for large portfolios
**System integration:** Varies by complexity

---

### Is migration assistance available?

**Pro tier:** $299 one-time fee
**Enterprise:** Included with contract

---

### What if my data is messy?

SiteSync AI helps:
- Extracts data from unstructured documents
- Identifies duplicates
- Suggests corrections
- Human review for low-confidence items

We work with what you have.

---

## Troubleshooting

### I can't log in

1. **Check email address** - typos happen
2. **Reset password** - use "Forgot password" link
3. **Check spam folder** - for verification emails
4. **Clear browser cache** - try incognito mode
5. **Contact support** - if still stuck

---

### AI Diagnosis isn't working

1. **Check internet connection** - required for AI
2. **Enter valid fault code** - format matters
3. **Select equipment type** - improves results
4. **Try describing symptoms** - if code unknown
5. **Report if persistent** - we'll investigate

---

### I can't see my building/equipment

**For technicians:**
- Confirm you're linked to the right company
- Check company is invited to that building
- Ask dispatcher to assign you

**For building managers:**
- Confirm equipment was added
- Check filters (might be hidden)
- Try refreshing the page

---

### My contractor can't access our building

1. **Check invitation sent** - resend if needed
2. **Check spam folder** - on contractor's end
3. **Verify email address** - typos happen
4. **Try different email** - or phone invitation
5. **Contact support** - if still stuck

---

### Data import failed

1. **Check file format** - PDF, Excel, CSV supported
2. **Verify file size** - max 500MB per upload
3. **Review error message** - specific guidance provided
4. **Try smaller batches** - split large files
5. **Contact support** - for complex imports

---

### My Health Score seems wrong

Health Score improves with:
- More historical data
- Consistent maintenance records
- Resolved compliance items
- Time (patterns take time to emerge)

If significantly wrong:
- Review imported data for errors
- Check equipment is correctly categorized
- Contact support for review

---

### Mobile/offline isn't working

1. **Update browser** - latest version recommended
2. **Clear cache** - remove old data
3. **Reinstall PWA** - remove and re-add
4. **Check storage** - need space for offline data
5. **Try different device** - isolate issue

---

## Getting Help

### How do I contact support?

**In-app chat:** Business hours (9am-5pm AEST)
**Email:** support@sitesync.com (24h response)
**Help center:** help.sitesync.com
**Enterprise:** Dedicated support manager

---

### Where can I learn more?

- **Help Center:** help.sitesync.com
- **Video Tutorials:** sitesync.com/learn
- **Community Forum:** community.sitesync.com
- **This Documentation:** Complete reference

---

### How do I report a bug?

1. **In-app:** Use "Report Issue" in Help menu
2. **Email:** bugs@sitesync.com
3. **Include:** What happened, what you expected, screenshots

We appreciate bug reports. They make SiteSync better.

---

### How do I suggest a feature?

1. **In-app:** Use "Feature Request" in Help menu
2. **Community Forum:** Discuss with other users
3. **Email:** feedback@sitesync.com

We read every suggestion. Many features come from user requests.

---

### Is there a community?

Yes:
- **Forum:** community.sitesync.com
- **User groups:** Regional meetups
- **Events:** Webinars, conferences

Join technicians and building managers sharing knowledge.

---

## Still Have Questions?

**Can't find your answer?**

- Search the Help Center: help.sitesync.com
- Ask in Community Forum: community.sitesync.com
- Email us: support@sitesync.com
- Chat with us: In-app during business hours

We're here to help.

---

**[← Back to Security & Compliance](explanation/security-compliance.md)** | **[Back to Documentation Hub →](README.md)**


<!-- FILE: docs/strategy/market-strategy.md -->

# SiteSync V3 - Market Strategy

## Go-to-Market Approach

> This document outlines the market strategy, pricing, competitive positioning, and growth plan for SiteSync V3.

---

## Strategic Positioning

### The Core Insight

```
╔══════════════════════════════════════════════════════════════════╗
║                                                                  ║
║   Traditional vertical SaaS (ServiceTitan, Fiix) sells to        ║
║   contractors and helps them manage their businesses.            ║
║                                                                  ║
║   SiteSync sells to BUILDINGS and helps them own their data.    ║
║                                                                  ║
║   This is a fundamentally different business model that          ║
║   incumbents cannot copy without destroying their customer base. ║
║                                                                  ║
╚══════════════════════════════════════════════════════════════════╝
```

### Counter-Positioning

| Incumbent Approach | SiteSync Approach |
|-------------------|-------------------|
| Sell to contractors | **Sell to buildings** |
| Data belongs to contractor | **Data belongs to building** |
| $299-899/month | **$29/month** |
| Weeks to setup | **5 minutes** |
| Dedicated training | **No training needed** |
| Features for contractor operations | **Features for building intelligence** |

**Why incumbents can't respond:**
- Their customers (contractors) benefit from data ownership
- Pivoting to buildings would alienate existing base
- Their pricing model depends on contractor value capture
- They're strategically paralyzed

---

## Target Market

### Primary: Building Owners & Managers

**Segments:**
| Segment | Size (Australia) | Characteristics |
|---------|------------------|-----------------|
| Commercial offices | 25,000 buildings | Professional FM, compliance-focused |
| Residential strata | 80,000 buildings | Cost-conscious, volunteer committees |
| Industrial/warehouse | 15,000 buildings | Function-focused, minimal staff |
| Mixed-use | 10,000 buildings | Complex needs, multiple stakeholders |
| Retail/shopping | 5,000 buildings | High traffic, critical uptime |

**Total Addressable Market (Australia):**
- ~135,000 buildings with elevator/HVAC needs
- At $29/month = $47M annual potential
- Multi-trade expansion: 3-5x multiplier

### Secondary: Technicians

**Profile:**
- Elevator technicians: ~5,000 in Australia
- HVAC technicians: ~25,000 in Australia
- All building trades: ~200,000 in Australia

**Value proposition:**
- Free access to platform
- Professional profile building
- Career advancement
- Collective knowledge access

### Tertiary: Service Companies

**Profile:**
- Small independents (1-5 techs): Majority
- Mid-size (6-50 techs): Growth segment
- Large contractors (50+ techs): Enterprise

**Value proposition:**
- Access to building customers
- Operational tools
- Talent recruitment

---

## Pricing Strategy

### Disruptive Pricing

**Philosophy:** 10x undercut to enable mass adoption

```
PRICING TIERS
══════════════════════════════════════════════════════════════════

BUILDINGS
─────────
Free        $0/month     10 lookups/month, basic features
Pro         $29/month    Unlimited, all core features
Enterprise  $500+/month  Custom, multi-site, dedicated support

TECHNICIANS
───────────
Basic       $0/month     Profile, reputation, knowledge access
Premium     $9/month     Enhanced visibility, analytics

SERVICE COMPANIES
─────────────────
Starter     $0/month     Access platform, basic tools
Pro         $49/month    Full operational suite
Enterprise  Custom       Multi-location, API access

══════════════════════════════════════════════════════════════════
```

### Volume Pricing (Buildings)

| Buildings | Price per Building |
|-----------|-------------------|
| 1-10 | $29/month |
| 11-50 | $24/month (17% discount) |
| 51+ | $19/month (34% discount) |

### Transaction Revenue

| Source | Fee |
|--------|-----|
| Parts marketplace (P2P) | 5% |
| Parts marketplace (supplier) | 3% |
| Premium listings | Flat fee |
| API transactions | Usage-based |

---

## Growth Phases

### Phase 1: Foundation (Months 1-12)

**Focus:**
- Australia/New Zealand
- Elevators only (deep expertise)
- 1,000 buildings target
- 500 active technicians

**Milestones:**
- Product-market fit validation
- First 100 paying buildings
- Knowledge base: 10,000 solutions
- Marketplace: First transactions

**ARR Target:** $0 → $350K

### Phase 2: Validation (Months 13-36)

**Focus:**
- North America expansion
- Add HVAC, electrical trades
- Parts marketplace growth
- 10,000 buildings target

**Milestones:**
- US market entry
- Multi-trade platform
- 5,000 active technicians
- Marketplace GMV: $1M/month

**ARR Target:** $350K → $3.5M

### Phase 3: Scale (Years 4-7)

**Focus:**
- Global expansion
- All building trades
- Enterprise segment
- IPO preparation

**Milestones:**
- Europe, Asia markets
- 100,000 buildings
- 50,000 technicians
- Industry standard status

**ARR Target:** $3.5M → $35M

### Phase 4: Dominance (Years 8-10)

**Focus:**
- Market leadership
- Platform ecosystem
- Adjacent markets
- 1M+ users

**ARR Target:** $35M → $100M+

---

## Distribution Channels

### 1. Trade Associations

**Target organizations:**
- EEAA (Elevator & Escalator Association of Australia)
- NAEC (National Association of Elevator Contractors - US)
- LEIA (Lift and Escalator Industry Association - UK)
- AIRAH (HVAC association)

**Strategy:**
- Partnership programs
- Conference presence
- Member benefits
- Co-marketing

### 2. Manufacturer Partnerships

**Targets:**
- KONE, Otis, Schindler, ThyssenKrupp
- Daikin, Carrier, Trane (HVAC)

**Model:**
- White-label deployment
- 20% revenue share
- Access to their customer base
- Equipment data integration

### 3. Property Management Companies

**Targets:**
- CBRE, JLL, Cushman & Wakefield
- Regional players
- Strata management companies

**Strategy:**
- Enterprise deals
- Portfolio pricing
- Integration with their systems

### 4. Digital Marketing

**SEO:**
- Own every "elevator fault code" search
- Technical content marketing
- Knowledge base as SEO asset

**Content:**
- Technical guides
- Case studies
- Industry reports

### 5. Trade Schools

**Strategy:**
- Free for students
- Curriculum integration
- Lifetime loyalty building
- Future technician pipeline

### 6. Viral/Referral

**Mechanics:**
- Invite 3 colleagues → 50 extra lookups
- Building invites contractor → both benefit
- Technician referral rewards

---

## Competitive Landscape

### Direct Competitors

| Competitor | Focus | Pricing | Weakness |
|------------|-------|---------|----------|
| ServiceTitan | Contractors | $299+/mo | Sells to contractors, not buildings |
| Fiix | Asset maintenance | $200+/mo | General purpose, no trade expertise |
| UpKeep | Maintenance | $150+/mo | Not building-focused |
| Limble | CMMS | $100+/mo | No AI, no marketplace |

### Indirect Competitors

| Competitor | Description | Our Advantage |
|------------|-------------|---------------|
| Spreadsheets | Manual tracking | Automation, intelligence |
| Paper records | Traditional approach | Digital, searchable, permanent |
| Manufacturer systems | Proprietary tools | Multi-vendor, building-owned |

### Competitive Response Scenarios

**If ServiceTitan pivots to buildings:**
- Would alienate existing contractor customers
- Can't match our price without destroying margins
- Lacks building-centric DNA
- We'll have 2-3 year head start

**If manufacturer offers free tools:**
- Lock-in to single vendor
- Building managers want independence
- Can't match multi-vendor intelligence

---

## Moat Construction

### 1. Data Moat

- 100K+ fault diagnoses → Impossible to replicate
- Temporal patterns unique to each building
- Collective knowledge compounds daily

### 2. Network Effects

- More buildings → contractors must join
- More contractors → better parts marketplace
- More techs → better collective knowledge
- More data → smarter AI

### 3. Switching Costs

- Years of building history
- Trained AI on specific equipment
- Compliance records
- Integration with workflows

### 4. Counter-Positioning

- Incumbents can't copy without destroying business
- First mover in building-centric model
- Occupying strategic position

### 5. Brand Moat

- "SiteSync" synonymous with building intelligence
- Trust earned through technician community
- Industry standard aspiration

---

## Unit Economics

### Building Customer

```
UNIT ECONOMICS - BUILDING
══════════════════════════════════════════════════════════════════

Revenue:
  Monthly:           $29
  Annual:            $348
  5-year LTV:        $1,740 (assuming 5-year average tenure)

Costs:
  CAC:               $100 (target)
  Hosting/infra:     $2/month
  Support:           $1/month

Metrics:
  Gross margin:      ~90%
  LTV:CAC ratio:     17:1
  Payback period:    3.4 months

══════════════════════════════════════════════════════════════════
```

### Marketplace Transaction

```
UNIT ECONOMICS - MARKETPLACE
══════════════════════════════════════════════════════════════════

Average transaction:     $150
Take rate:              5%
Revenue per transaction: $7.50

At scale (10K transactions/month):
Monthly revenue:        $75,000
Annual revenue:         $900,000

Marginal cost:          ~$0.50 per transaction
Contribution margin:    ~93%

══════════════════════════════════════════════════════════════════
```

---

## Key Metrics

### North Star Metric

**Active Buildings with History > 6 months**

This measures:
- Acquisition success
- Retention quality
- Data value accumulation
- Platform stickiness

### Supporting Metrics

| Category | Metric | Target |
|----------|--------|--------|
| Acquisition | Buildings onboarded/month | 100+ |
| Activation | Buildings with 5+ work orders | 60%+ |
| Retention | Annual building retention | 90%+ |
| Engagement | Work orders logged/building/month | 2+ |
| Revenue | ARR | Per phase |
| Marketplace | GMV/month | $100K+ |
| Community | Active technicians | 1,000+ |
| Knowledge | Solutions in database | 50K+ |

---

## Risk Mitigation

### Risk: Slow Building Adoption

**Mitigation:**
- Free tier to reduce friction
- Focus on pain point (data loss on contractor change)
- Success stories and case studies
- Property management partnerships

### Risk: Technician Community Doesn't Engage

**Mitigation:**
- Make contribution valuable (career advancement)
- Keep barrier to entry low
- Gamification and recognition
- Anonymous option for sensitive contributions

### Risk: Incumbents Respond Aggressively

**Mitigation:**
- Counter-positioning makes copying hard
- Build moats quickly
- Focus on building customers (not their segment)
- Network effects create winner-take-most

### Risk: Manufacturer Lock-In

**Mitigation:**
- Position as multi-vendor solution
- Building independence as key value prop
- Regulatory trends favor right-to-repair

---

## Success Metrics

| Metric | Target |
|--------|--------|
| Task completion time | -85% |
| First-time fix rate | 90%+ |
| Technician productivity | +30% jobs/day |
| NPS | >70 |
| Annual churn | <5% |
| Carbon reduction | 20% per building |

---

**[← Back to Implementation](../reference/implementation.md)** | **[Next: Quick Reference →](../reference/quick-reference.md)**


<!-- FILE: docs/enterprise/facilities-management.md -->

# SiteSync V3 - Enterprise Facilities Management

## Portfolio-Scale Building Intelligence

> This document details how SiteSync serves large Facilities Management companies managing hundreds or thousands of buildings across regions, countries, and continents.

---

```
         YOUR BUILDING. YOUR DATA. YOUR INTELLIGENCE.

                  Contractors come and go.
                  Your building remembers forever.

         At portfolio scale: Every building remembers.
```

---

## The Enterprise FM Opportunity

```
╔══════════════════════════════════════════════════════════════════╗
║                                                                  ║
║   Large FM companies face a unique challenge:                    ║
║                                                                  ║
║   They manage buildings they don't own, using contractors they   ║
║   don't employ, with data scattered across dozens of systems.    ║
║                                                                  ║
║   SiteSync gives them unified intelligence across their         ║
║   entire portfolio—while ensuring building owners retain         ║
║   permanent ownership of their data.                             ║
║                                                                  ║
║   Everyone wins.                                                 ║
║                                                                  ║
╚══════════════════════════════════════════════════════════════════╝
```

---

## Who This Is For

### Target Organizations

| Type | Examples | Portfolio Size |
|------|----------|----------------|
| **Global FM Giants** | CBRE, JLL, Cushman & Wakefield | 10,000+ buildings |
| **Regional Leaders** | Colliers, Knight Frank, Savills | 1,000-10,000 buildings |
| **National Players** | Local FM leaders per country | 100-1,000 buildings |
| **Specialist FM** | Healthcare, education, government | 50-500 buildings |
| **Property Funds** | REITs, pension funds, sovereign wealth | 50-500 buildings |

### The FM Company Pain Points

```
CURRENT STATE: FRAGMENTED CHAOS
═══════════════════════════════════════════════════════════════════

Portfolio: 500 Buildings Across 3 Regions

Region A (200 buildings)
├── CMMS System: Fiix
├── Contractors: 12 different companies
├── Data Format: Their own
└── History: Partial, scattered

Region B (180 buildings)
├── CMMS System: UpKeep
├── Contractors: 8 different companies
├── Data Format: Different
└── History: Incomplete

Region C (120 buildings)
├── CMMS System: Spreadsheets
├── Contractors: 15 different companies
├── Data Format: Chaos
└── History: What history?

RESULT:
• No portfolio-wide visibility
• Can't benchmark buildings against each other
• Compliance tracking is manual nightmare
• Every new building starts from zero
• Losing buildings means losing data

═══════════════════════════════════════════════════════════════════
```

---

## The SiteSync Solution

### Unified Portfolio Intelligence

```
WITH SITESYNC: UNIFIED CLARITY
═══════════════════════════════════════════════════════════════════

Portfolio: 500 Buildings - Single Platform

┌─────────────────────────────────────────────────────────────────┐
│                    PORTFOLIO DASHBOARD                          │
│                                                                 │
│  Overall Health Score: 76                                       │
│  [████████████████████████████░░░░░░░░░░]                      │
│                                                                 │
│  Buildings: 500  │  Equipment: 3,247  │  Open Jobs: 127        │
│                                                                 │
├─────────────────────────────────────────────────────────────────┤
│                                                                 │
│  REGION BREAKDOWN                                               │
│  ─────────────────────────────────────────────────────────────  │
│  Region A (200)    [████████████████████] 82  ▲ +3             │
│  Region B (180)    [█████████████████░░░] 74  ─ 0              │
│  Region C (120)    [██████████████░░░░░░] 68  ▼ -2             │
│                                                                 │
├─────────────────────────────────────────────────────────────────┤
│                                                                 │
│  ATTENTION REQUIRED                                             │
│  ─────────────────────────────────────────────────────────────  │
│  ! 3 buildings with health score < 50                          │
│  ! 12 compliance certificates expiring in 30 days              │
│  ! 2 contractors with declining performance                    │
│                                                                 │
└─────────────────────────────────────────────────────────────────┘

RESULT:
• Portfolio-wide visibility in real-time
• Benchmark any building against any other
• Automated compliance tracking
• New buildings come with full history
• Building owners keep their data when contracts end

═══════════════════════════════════════════════════════════════════
```

---

## Organizational Hierarchy

### Multi-Level Structure

```
ENTERPRISE HIERARCHY
═══════════════════════════════════════════════════════════════════

FM COMPANY (Tenant)
│
├── PORTFOLIO (optional grouping)
│   │
│   ├── REGION / DISTRICT
│   │   │
│   │   ├── BUILDING (Site)
│   │   │   │
│   │   │   ├── TRADE (Elevators, HVAC, etc.)
│   │   │   │   │
│   │   │   │   └── EQUIPMENT (Individual assets)
│   │   │   │
│   │   │   └── TRADE
│   │   │       └── EQUIPMENT
│   │   │
│   │   └── BUILDING
│   │       └── ...
│   │
│   └── REGION
│       └── ...
│
└── PORTFOLIO
    └── ...

═══════════════════════════════════════════════════════════════════
```

### Hierarchy Configuration

```python
# Example: Large FM Company Structure

fm_company = Organization(
    name="CBRE Australia",
    type="facilities_management",
    tier="enterprise"
)

portfolios = [
    Portfolio(
        name="NSW Commercial",
        regions=[
            Region(
                name="Sydney CBD",
                buildings=[
                    Building(name="123 Pitt Street", ...),
                    Building(name="200 George Street", ...),
                    # ... 50 more buildings
                ]
            ),
            Region(
                name="North Sydney",
                buildings=[...]
            ),
        ]
    ),
    Portfolio(
        name="VIC Commercial",
        regions=[...]
    ),
    Portfolio(
        name="Government Contracts",
        regions=[...]
    ),
]
```

---

## Data Ownership Model

### The Key Question: Who Owns What?

```
DATA OWNERSHIP IN FM RELATIONSHIPS
═══════════════════════════════════════════════════════════════════

BUILDING OWNER (e.g., Property Fund)
│
│   Owns: The building and all data about it
│   │
│   └── Contracts FM Company to manage
│
FM COMPANY (e.g., CBRE)
│
│   Manages: Operations on behalf of owner
│   Accesses: Building data (with owner permission)
│   Owns: Their operational insights, processes, analytics
│   │
│   └── Contracts Service Providers
│
SERVICE PROVIDER (e.g., Elevator Contractor)
│
│   Performs: Actual service work
│   Logs: Work to building record
│   Owns: Their company data, technician data

═══════════════════════════════════════════════════════════════════
```

### Ownership Scenarios

**Scenario 1: FM Company Wins New Building Contract**

```
BEFORE: Building managed by different FM
────────────────────────────────────────────────────────────────

Building: 123 Collins Street
Previous FM: JLL (5 years of history)
History Status: ✓ Complete in SiteSync

TRANSITION:
────────────────────────────────────────────────────────────────

1. Building owner grants access to new FM (CBRE)
2. New FM immediately sees 5 years of complete history
3. No data migration needed
4. No "starting from zero"
5. Full context from day one

AFTER: Building managed by CBRE
────────────────────────────────────────────────────────────────

Building: 123 Collins Street
Current FM: CBRE
History Status: ✓ Complete (5 years + ongoing)

THE VALUE:
• CBRE wins because they have full context immediately
• Building owner wins because no disruption
• Data integrity maintained through transition
```

**Scenario 2: FM Company Loses Building Contract**

```
SITUATION: CBRE loses 123 Collins Street contract
────────────────────────────────────────────────────────────────

WHAT CBRE KEEPS:
✓ Their operational analytics
✓ Contractor performance data (aggregate)
✓ Process documentation they created
✓ Benchmarking data (anonymized)
✓ Knowledge they contributed

WHAT STAYS WITH BUILDING:
✓ All service history
✓ Equipment records
✓ Compliance documents
✓ AI insights about the building
✓ Technician notes and photos

WHAT NEW FM (SAVILLS) GETS:
✓ Complete building history
✓ Full equipment context
✓ All compliance records
✓ Immediate operational readiness

EVERYONE WINS:
• Building owner: Uninterrupted data continuity
• CBRE: Keeps their business intelligence
• Savills: Full context from day one
• No data held hostage
```

**Scenario 3: Building Owner Changes**

```
SITUATION: Property fund sells 123 Collins Street
────────────────────────────────────────────────────────────────

DATA TRANSFER:

Option A: New owner takes over SiteSync account
• Ownership transfers with property
• Complete history maintained
• FM relationship continues or changes

Option B: New owner exports data
• Full export provided
• History archived
• New owner can import to their system

Option C: New owner not using SiteSync
• History preserved in archive
• Available if they sign up later
• Building never loses its memory
```

---

## Portfolio-Level Features

### 1. Portfolio Dashboard

```
┌─────────────────────────────────────────────────────────────────┐
│  PORTFOLIO OVERVIEW                            December 2025    │
├─────────────────────────────────────────────────────────────────┤
│                                                                 │
│  KEY METRICS                                                    │
│  ───────────────────────────────────────────────────────────    │
│                                                                 │
│  ┌─────────────┐  ┌─────────────┐  ┌─────────────┐             │
│  │ Buildings   │  │ Equipment   │  │ Open Jobs   │             │
│  │    500      │  │   3,247     │  │    127      │             │
│  │  ▲ +12 MTD  │  │  ▲ +89 MTD  │  │  ▼ -23 WoW  │             │
│  └─────────────┘  └─────────────┘  └─────────────┘             │
│                                                                 │
│  ┌─────────────┐  ┌─────────────┐  ┌─────────────┐             │
│  │ Health Avg  │  │ Compliance  │  │ Response    │             │
│  │    76/100   │  │   94.2%     │  │   2.3 hrs   │             │
│  │  ▲ +2 MoM   │  │  ▲ +1.2%    │  │  ▼ -18 min  │             │
│  └─────────────┘  └─────────────┘  └─────────────┘             │
│                                                                 │
├─────────────────────────────────────────────────────────────────┤
│                                                                 │
│  HEALTH DISTRIBUTION                                            │
│  ───────────────────────────────────────────────────────────    │
│                                                                 │
│  Excellent (90-100)  ████████████ 89 buildings (18%)           │
│  Good (70-89)        ████████████████████████████ 298 (60%)    │
│  Fair (50-69)        ████████████ 94 buildings (19%)           │
│  Poor (<50)          ██ 19 buildings (4%)                       │
│                                                                 │
├─────────────────────────────────────────────────────────────────┤
│                                                                 │
│  ALERTS                                                         │
│  ───────────────────────────────────────────────────────────    │
│                                                                 │
│  🔴 CRITICAL (3)                                                │
│     • 200 George St - Elevator trapped passenger (15 min ago)  │
│     • Tower Plaza - Fire panel fault                           │
│     • 55 Market St - Health score dropped to 42                │
│                                                                 │
│  🟡 WARNING (12)                                                │
│     • 8 compliance certificates expiring in 14 days            │
│     • 4 buildings trending downward                            │
│                                                                 │
└─────────────────────────────────────────────────────────────────┘
```

### 2. Cross-Portfolio Benchmarking

```
BENCHMARKING CAPABILITIES
═══════════════════════════════════════════════════════════════════

BUILDING VS BUILDING
────────────────────
Compare any building to any other:
• Health scores
• Maintenance costs per sqm
• Incident frequency
• First-time fix rates
• Contractor performance

REGION VS REGION
────────────────
Compare regions/districts:
• Aggregate health
• Cost efficiency
• Compliance rates
• Response times

PORTFOLIO VS INDUSTRY
─────────────────────
Compare to anonymized benchmarks:
• How do your buildings compare to similar buildings?
• Industry average metrics
• Best-in-class targets

EXAMPLE INSIGHT:
───────────────
"Your Melbourne CBD portfolio has 23% higher maintenance
costs than Sydney CBD, but 15% fewer breakdowns. The
investment in preventive maintenance is paying off."
```

### 3. Compliance Command Center

```
┌─────────────────────────────────────────────────────────────────┐
│  COMPLIANCE CENTER                              Portfolio: All   │
├─────────────────────────────────────────────────────────────────┤
│                                                                 │
│  OVERALL COMPLIANCE                                             │
│  ───────────────────────────────────────────────────────────    │
│                                                                 │
│  [████████████████████████████████████░░░] 94.2% Compliant     │
│                                                                 │
│  ┌─────────────────────────────────────────────────────────┐    │
│  │ Status          │ Buildings │ Equipment │ Action        │    │
│  ├─────────────────┼───────────┼───────────┼───────────────┤    │
│  │ ✓ Compliant     │ 471       │ 3,058     │ None          │    │
│  │ ⚠ Expiring Soon │ 23        │ 156       │ Schedule Now  │    │
│  │ ✗ Overdue       │ 6         │ 33        │ URGENT        │    │
│  └─────────────────────────────────────────────────────────┘    │
│                                                                 │
│  EXPIRING IN NEXT 30 DAYS                                       │
│  ───────────────────────────────────────────────────────────    │
│                                                                 │
│  Building              Equipment           Expires    Status    │
│  ─────────────────────────────────────────────────────────────  │
│  123 Pitt Street       Elevator 1          Dec 15    Scheduled │
│  200 George Street     Elevator 2          Dec 18    Scheduled │
│  Tower Plaza           Escalator 1         Dec 20    UNSCHEDULED│
│  ...                                                            │
│                                                                 │
│  [ Export Report ]  [ Schedule All ]  [ Notify Contractors ]   │
│                                                                 │
└─────────────────────────────────────────────────────────────────┘
```

### 4. Contractor Performance Tracking

```
CONTRACTOR PERFORMANCE ACROSS PORTFOLIO
═══════════════════════════════════════════════════════════════════

ELEVATOR CONTRACTORS (Ranked by Performance Score)
──────────────────────────────────────────────────────────────────

Rank  Contractor           Buildings  FTF Rate  Response  Score
────  ─────────────────    ─────────  ────────  ────────  ─────
1     KONE Direct          89         94%       1.8 hrs   92
2     Schindler Service    67         91%       2.1 hrs   88
3     Otis Signature       45         89%       2.4 hrs   85
4     ThyssenKrupp        38         87%       2.2 hrs   83
5     ABC Elevators        34         85%       1.9 hrs   82
6     Local Lift Co        28         82%       3.1 hrs   74
...

INSIGHTS:
─────────
• KONE Direct outperforming on FTF rate (+9% vs average)
• Local Lift Co struggling with response times
• Consider consolidating to top performers

ACTIONS:
────────
[ Generate Performance Report ]
[ Schedule Contractor Review ]
[ Adjust Preferred Contractor List ]

═══════════════════════════════════════════════════════════════════
```

### 5. Cost Analytics

```
PORTFOLIO COST ANALYSIS
═══════════════════════════════════════════════════════════════════

ANNUAL SPEND OVERVIEW
─────────────────────
Total Maintenance Spend:     $4,234,000
Per Building Average:        $8,468
Per Square Meter:            $12.34

BREAKDOWN BY TRADE
──────────────────
Elevators        $1,856,000  (44%)  ████████████████████████
HVAC             $1,269,000  (30%)  ██████████████
Electrical       $423,000    (10%)  █████
Fire Systems     $338,000    (8%)   ████
Other            $348,000    (8%)   ████

BREAKDOWN BY TYPE
─────────────────
Preventive       $2,117,000  (50%)  ██████████████████████
Breakdown        $1,270,000  (30%)  ██████████████
Compliance       $635,000    (15%)  ███████
Emergency        $212,000    (5%)   ███

COST TRENDS
───────────
This Year vs Last Year:
• Total spend: ▼ -8% ($368,000 saved)
• Breakdown costs: ▼ -15% (preventive investment paying off)
• Emergency costs: ▼ -22% (better response times)

OPTIMIZATION OPPORTUNITIES
──────────────────────────
• 12 buildings have above-average costs - review needed
• Consolidating HVAC contractors could save ~$120,000/year
• Predictive maintenance could reduce breakdowns by 20%

═══════════════════════════════════════════════════════════════════
```

---

## User Management at Scale

### Role Hierarchy

```
ENTERPRISE USER ROLES
═══════════════════════════════════════════════════════════════════

EXECUTIVE LEVEL
───────────────
Portfolio Director
├── View: All portfolios, all buildings
├── Access: Strategic dashboards, executive reports
├── Actions: High-level configuration, approvals
└── Typical: 2-5 per organization

REGIONAL LEVEL
──────────────
Regional Manager
├── View: Assigned regions/portfolios
├── Access: Regional dashboards, performance reports
├── Actions: Contractor management, escalations
└── Typical: 5-20 per organization

BUILDING LEVEL
──────────────
Facility Manager
├── View: Assigned buildings only
├── Access: Building dashboards, work orders
├── Actions: Day-to-day operations, contractor coordination
└── Typical: 50-500 per organization

SPECIALIST ROLES
────────────────
Compliance Manager
├── View: Compliance data across portfolio
├── Access: Compliance center, certificate management
├── Actions: Schedule inspections, manage certificates
└── Typical: 2-10 per organization

Finance Analyst
├── View: Cost data across portfolio
├── Access: Cost analytics, invoicing
├── Actions: Budget tracking, cost analysis
└── Typical: 2-10 per organization

Contractor Coordinator
├── View: Contractor performance data
├── Access: Contractor management, assignment
├── Actions: Onboard contractors, manage relationships
└── Typical: 5-20 per organization

═══════════════════════════════════════════════════════════════════
```

### Permission Templates

```python
# Pre-configured role templates for rapid deployment

role_templates = {
    "portfolio_director": {
        "scope": "all_portfolios",
        "buildings": "read",
        "work_orders": "read",
        "compliance": "read",
        "costs": "read",
        "contractors": "read",
        "users": "manage",
        "reports": "all",
        "settings": "manage"
    },

    "regional_manager": {
        "scope": "assigned_regions",
        "buildings": "read_write",
        "work_orders": "read_write",
        "compliance": "read_write",
        "costs": "read",
        "contractors": "manage",
        "users": "manage_region",
        "reports": "region",
        "settings": "region"
    },

    "facility_manager": {
        "scope": "assigned_buildings",
        "buildings": "read",
        "work_orders": "read_write",
        "compliance": "read",
        "costs": "view_building",
        "contractors": "coordinate",
        "users": "none",
        "reports": "building",
        "settings": "none"
    },

    "compliance_manager": {
        "scope": "all_buildings",
        "buildings": "read",
        "work_orders": "read",
        "compliance": "manage_all",
        "costs": "none",
        "contractors": "read",
        "users": "none",
        "reports": "compliance",
        "settings": "compliance"
    }
}
```

### SSO Integration

```
ENTERPRISE SSO SUPPORT
═══════════════════════════════════════════════════════════════════

SUPPORTED PROVIDERS
───────────────────
• Azure Active Directory
• Okta
• Google Workspace
• OneLogin
• Ping Identity
• Custom SAML 2.0
• Custom OIDC

FEATURES
────────
• Just-in-time user provisioning
• Group-based role assignment
• Automatic deprovisioning
• MFA enforcement via IdP
• Session management

EXAMPLE: AZURE AD MAPPING
─────────────────────────
Azure AD Group                → SiteSync Role
────────────────────────────────────────────────
FM-Portfolio-Directors        → portfolio_director
FM-Regional-Managers-NSW      → regional_manager (NSW)
FM-Regional-Managers-VIC      → regional_manager (VIC)
FM-Facility-Managers          → facility_manager
FM-Compliance-Team            → compliance_manager

═══════════════════════════════════════════════════════════════════
```

---

## Enterprise Integrations

### ERP Integration

```
ERP INTEGRATION ARCHITECTURE
═══════════════════════════════════════════════════════════════════

SUPPORTED SYSTEMS
─────────────────
• SAP (S/4HANA, ECC)
• Oracle (Cloud, E-Business Suite)
• Microsoft Dynamics 365
• Workday
• NetSuite

DATA FLOWS
──────────

SiteSync → ERP
───────────────
• Work order costs → Cost center allocation
• Contractor invoices → Accounts payable
• Asset data → Fixed asset register
• Compliance status → Risk management

ERP → SiteSync
───────────────
• Cost center structure → Portfolio hierarchy
• Vendor master → Contractor records
• Budget allocations → Spending limits
• Employee data → User provisioning

INTEGRATION METHODS
───────────────────
• REST API (real-time)
• Batch file exchange (daily/weekly)
• Middleware (MuleSoft, Dell Boomi, etc.)
• Direct database connectors

═══════════════════════════════════════════════════════════════════
```

### BMS/BAS Integration

```
BUILDING MANAGEMENT SYSTEM INTEGRATION
═══════════════════════════════════════════════════════════════════

SUPPORTED PROTOCOLS
───────────────────
• BACnet (IP, MS/TP)
• Modbus (TCP, RTU)
• OPC-UA
• REST APIs (vendor-specific)

USE CASES
─────────
1. Automatic Fault Detection
   BMS detects HVAC fault → Creates SiteSync work order

2. Performance Monitoring
   BMS sends runtime data → SiteSync tracks equipment health

3. Energy Correlation
   BMS energy data + SiteSync maintenance data → Insights

4. Predictive Maintenance
   BMS sensor trends + SiteSync history → Failure prediction

EXAMPLE FLOW
────────────
┌─────────────┐     ┌─────────────┐     ┌─────────────┐
│     BMS     │ ──► │  SiteSync  │ ──► │   Action    │
│  Fault Alert│     │ Work Order  │     │  Dispatch   │
└─────────────┘     └─────────────┘     └─────────────┘

═══════════════════════════════════════════════════════════════════
```

### Reporting Integration

```
BUSINESS INTELLIGENCE INTEGRATION
═══════════════════════════════════════════════════════════════════

SUPPORTED PLATFORMS
───────────────────
• Power BI
• Tableau
• Looker
• Qlik
• Custom BI solutions

DATA EXPORT OPTIONS
───────────────────
• Scheduled data exports (CSV, JSON)
• Direct database connection (read replica)
• REST API for real-time queries
• Pre-built data models

SAMPLE POWER BI DASHBOARD
─────────────────────────
┌─────────────────────────────────────────────────────────────────┐
│  FM COMPANY - EXECUTIVE DASHBOARD                               │
├─────────────────────────────────────────────────────────────────┤
│                                                                 │
│  ┌───────────────────┐  ┌───────────────────┐                  │
│  │ Portfolio Health  │  │ Spend vs Budget   │                  │
│  │     [GAUGE]       │  │    [BAR CHART]    │                  │
│  │       76          │  │                   │                  │
│  └───────────────────┘  └───────────────────┘                  │
│                                                                 │
│  ┌───────────────────────────────────────────────────────────┐  │
│  │ Health Trend by Region (12 months)                        │  │
│  │                              [LINE CHART]                 │  │
│  └───────────────────────────────────────────────────────────┘  │
│                                                                 │
│  ┌───────────────────────────────────────────────────────────┐  │
│  │ Contractor Performance Matrix                             │  │
│  │                            [SCATTER PLOT]                 │  │
│  └───────────────────────────────────────────────────────────┘  │
│                                                                 │
└─────────────────────────────────────────────────────────────────┘

═══════════════════════════════════════════════════════════════════
```

---

## Client Reporting

### White-Label Reports

```
CLIENT-FACING REPORTS
═══════════════════════════════════════════════════════════════════

FM companies can generate branded reports for building owners:

REPORT TYPES
────────────
• Monthly Performance Summary
• Quarterly Business Review
• Annual Compliance Report
• Ad-hoc Incident Reports
• Budget vs Actual Analysis

BRANDING OPTIONS
────────────────
• FM company logo
• Custom color scheme
• Custom cover page
• Co-branded (FM + Building Owner)
• White-label (no SiteSync branding)

DELIVERY OPTIONS
────────────────
• Scheduled email delivery
• Client portal access
• API for client systems
• PDF download

SAMPLE REPORT STRUCTURE
───────────────────────
┌─────────────────────────────────────────────────────────────────┐
│  [FM COMPANY LOGO]                                              │
│                                                                 │
│  MONTHLY PROPERTY REPORT                                        │
│  123 Collins Street | November 2025                            │
│                                                                 │
├─────────────────────────────────────────────────────────────────┤
│                                                                 │
│  EXECUTIVE SUMMARY                                              │
│  Your building health score improved to 82 this month,         │
│  up from 78 last month. All compliance requirements are        │
│  current. Two preventive maintenance visits were completed.    │
│                                                                 │
├─────────────────────────────────────────────────────────────────┤
│                                                                 │
│  KEY METRICS                                                    │
│  • Health Score: 82 (▲ +4)                                     │
│  • Work Orders: 5 completed                                    │
│  • Response Time: 1.8 hours average                            │
│  • Compliance: 100% current                                    │
│                                                                 │
├─────────────────────────────────────────────────────────────────┤
│                                                                 │
│  SERVICE ACTIVITY                                               │
│  [Detailed work order summary]                                  │
│                                                                 │
├─────────────────────────────────────────────────────────────────┤
│                                                                 │
│  COST SUMMARY                                                   │
│  [Month spend, YTD, vs budget]                                 │
│                                                                 │
└─────────────────────────────────────────────────────────────────┘

═══════════════════════════════════════════════════════════════════
```

---

## Enterprise Pricing

### Volume Pricing Structure

```
ENTERPRISE PRICING MODEL
═══════════════════════════════════════════════════════════════════

BUILDING VOLUME PRICING
───────────────────────
Buildings         Per Building/Month      Annual Commitment
──────────        ─────────────────       ─────────────────
1-50              $29                     Optional
51-100            $24 (17% discount)      Required
101-250           $19 (34% discount)      Required
251-500           $15 (48% discount)      Required
501-1000          $12 (59% discount)      Required
1000+             Custom                  Required

ENTERPRISE ADD-ONS
──────────────────
Feature                          Price
───────────────────────────      ─────────────────
SSO Integration                  Included (100+ buildings)
Custom Integrations              $5,000-25,000 setup
Dedicated Support Manager        Included (250+ buildings)
Custom Reporting                 $2,000/month
White-Label Reports              $500/month
API Premium (higher limits)      $1,000/month
Data Residency (specific region) $2,000/month

EXAMPLE: 500 BUILDING PORTFOLIO
───────────────────────────────
Base: 500 × $15 = $7,500/month ($90,000/year)
Add-ons:
  + SSO: Included
  + Custom BI Integration: $15,000 one-time
  + White-Label Reports: $500/month ($6,000/year)
  + Dedicated CSM: Included

Total Year 1: $111,000
Total Year 2+: $96,000/year

COMPARED TO ALTERNATIVES:
• 500 buildings × $200/month (typical CMMS) = $1.2M/year
• SiteSync saves ~$1.1M/year with better functionality

═══════════════════════════════════════════════════════════════════
```

---

## Implementation Process

### Enterprise Onboarding

```
ENTERPRISE IMPLEMENTATION TIMELINE
═══════════════════════════════════════════════════════════════════

PHASE 1: DISCOVERY (Week 1-2)
─────────────────────────────
□ Stakeholder alignment workshop
□ Current state assessment
□ Data inventory and mapping
□ Integration requirements
□ Success criteria definition

PHASE 2: SETUP (Week 3-4)
─────────────────────────
□ Organization structure configuration
□ User role definition
□ SSO integration
□ Initial data migration
□ Integration development (if needed)

PHASE 3: PILOT (Week 5-8)
─────────────────────────
□ Select pilot region (50-100 buildings)
□ User training (train-the-trainer)
□ Pilot launch
□ Feedback collection
□ Iteration and refinement

PHASE 4: ROLLOUT (Week 9-16)
────────────────────────────
□ Phased regional rollout
□ Ongoing training
□ Data migration completion
□ Full integration activation
□ Go-live support

PHASE 5: OPTIMIZATION (Ongoing)
───────────────────────────────
□ Quarterly business reviews
□ Performance optimization
□ Feature enhancement requests
□ Continuous improvement

═══════════════════════════════════════════════════════════════════
```

### Dedicated Support

```
ENTERPRISE SUPPORT MODEL
═══════════════════════════════════════════════════════════════════

DEDICATED CUSTOMER SUCCESS MANAGER
──────────────────────────────────
• Named CSM for your account
• Quarterly business reviews
• Escalation path
• Feature request advocacy
• Best practice guidance

SUPPORT CHANNELS
────────────────
• Priority support queue (4-hour response)
• Direct Slack channel (optional)
• Phone support for critical issues
• On-site support (as needed)

TRAINING RESOURCES
──────────────────
• Custom training programs
• Train-the-trainer sessions
• Role-based training materials
• Video library access
• Certification program

SERVICE LEVEL AGREEMENT
───────────────────────
• 99.9% uptime guarantee
• Scheduled maintenance windows
• Incident communication SLA
• Data backup guarantees
• Disaster recovery commitments

═══════════════════════════════════════════════════════════════════
```

---

## Success Stories (Templates)

### Large FM Company

```
CASE STUDY: [FM COMPANY NAME]
═══════════════════════════════════════════════════════════════════

PROFILE
───────
• 800 buildings under management
• 3 regions (NSW, VIC, QLD)
• 45 facility managers
• 120+ contractors

CHALLENGE
─────────
• Fragmented data across 5 different systems
• No portfolio-wide visibility
• Compliance tracking was manual
• New contracts started from zero

SOLUTION
────────
• Deployed SiteSync across entire portfolio
• Integrated with existing ERP (SAP)
• Centralized compliance management
• Standardized contractor onboarding

RESULTS (12 months)
───────────────────
• Portfolio health visibility: 0% → 100%
• Compliance tracking time: -85%
• New contract onboarding: 2 weeks → 2 days
• Contractor performance: +15% improvement
• Annual savings: $800,000+

QUOTE
─────
"For the first time, we can see our entire portfolio on one screen.
When we win new buildings, we have full history from day one.
This is transformational for how we manage properties."

— Regional Director, [FM Company]

═══════════════════════════════════════════════════════════════════
```

---

## Why FM Companies Choose SiteSync

### The Value Proposition

```
FOR FM COMPANIES
═══════════════════════════════════════════════════════════════════

1. WIN MORE CONTRACTS
   • Demonstrate data-driven management
   • Show building owners what you'll deliver
   • Differentiate from competitors

2. ONBOARD FASTER
   • New buildings come with full history
   • No starting from zero
   • Immediate operational readiness

3. OPERATE BETTER
   • Portfolio-wide visibility
   • Benchmark buildings against each other
   • Identify and fix underperformers

4. REDUCE COSTS
   • Prevent breakdowns with AI insights
   • Optimize contractor selection
   • Reduce compliance overhead

5. RETAIN CLIENTS
   • Transparent reporting
   • Demonstrable value
   • Data-backed recommendations

6. SCALE EFFICIENTLY
   • Add buildings without adding systems
   • Standardized processes
   • Centralized management

THE BOTTOM LINE:
────────────────
FM companies that use SiteSync manage more buildings,
more efficiently, with better outcomes—and they can prove it.

═══════════════════════════════════════════════════════════════════
```

---

## Getting Started

### Contact Enterprise Sales

```
ENTERPRISE INQUIRIES
═══════════════════════════════════════════════════════════════════

Ready to transform your portfolio management?

Email: enterprise@sitesync.com
Phone: 1800-XXX-XXX (Australia)
Web: sitesync.com/enterprise

REQUEST INCLUDES:
─────────────────
□ Portfolio size (number of buildings)
□ Geographic regions
□ Current systems in use
□ Key pain points
□ Timeline

WE'LL PROVIDE:
──────────────
□ Custom demo for your use case
□ ROI analysis
□ Implementation proposal
□ Reference customers
□ Pricing proposal

═══════════════════════════════════════════════════════════════════
```

---

**[← Back to FAQ](../faq.md)** | **[Back to Documentation Hub →](../README.md)**


<!-- END OF DOCUMENTATION -->
